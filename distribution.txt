nohup: ignoring input
Iteration 1/30
Processing Categories:   0%|          | 0/55 [00:00<?, ?category/s]
Processing Models in pillow:   0%|          | 0/96 [00:00<?, ?model/s][A/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tyro/_fields.py:1066: UserWarning: Mutable type <class 'config.EnvConfig'> is used as a default value for `env`. This is dangerous! Consider using `dataclasses.field(default_factory=...)` or marking <class 'config.EnvConfig'> as frozen.
  warnings.warn(
pillow:/attached/data/remote-home2/zzq/data/shapenet/ShapeNetCore.v2/03938244/55a09adb1315764f8a766d8de50bb39d


CUDA
Generating data for init
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/boxx/ylcompat.py:69: BoxxWarning: warning from boxx
    os.environ["DISPLAY"] is not found
    plt.show() are redirect to plt.savefig(tmp)
    function: show, loga, crun, heatmap, plot will be affected
  def __setDisplayEnv():
saving data to data/shapenet/init/transforms.json
[10:46:26] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Found 64 GT images, loading directly from /remote-home/zzq/data/ShapeNet/gt_shapenet/pillow/55a09adb1315764f8a766d8de50bb39d
Loaded 64 GT images successfully!


viewpoint:   0%|          | 0/64 [00:00<?, ?it/s][A[Adealing with 31
[10:46:45] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:70: FutureWarning: Importing `spectral_angle_mapper` from `torchmetrics.functional` was deprecated and will be removed in 2.0. Import `spectral_angle_mapper` from `torchmetrics.image` instead.
  _future_warning(


viewpoint:  50%|█████     | 32/64 [12:01<12:01, 22.53s/it][A[ASelf.trainer.train duration: 585.8945 seconds
显存占用: 778.82 MB, 已预留显存: 1250.00 MB
dealing with 32
[10:58:46] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  52%|█████▏    | 33/64 [23:49<26:47, 51.85s/it][A[ASelf.trainer.train duration: 568.8586 seconds
显存占用: 1118.88 MB, 已预留显存: 1682.00 MB
dealing with 33
[11:10:34] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  53%|█████▎    | 34/64 [35:44<45:00, 90.01s/it][A[ASelf.trainer.train duration: 604.3914 seconds
显存占用: 1461.36 MB, 已预留显存: 1956.00 MB
dealing with 34
[11:22:30] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  55%|█████▍    | 35/64 [49:02<1:09:29, 143.79s/it][A[ASelf.trainer.train duration: 676.6171 seconds
显存占用: 1804.85 MB, 已预留显存: 2360.00 MB
dealing with 35
[11:35:48] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  56%|█████▋    | 36/64 [1:01:46<1:35:26, 204.51s/it][A[ASelf.trainer.train duration: 642.9700 seconds
显存占用: 2145.97 MB, 已预留显存: 2580.00 MB
dealing with 36
[11:48:32] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  58%|█████▊    | 37/64 [1:15:21<2:05:44, 279.41s/it][A[ASelf.trainer.train duration: 670.0346 seconds
显存占用: 2487.47 MB, 已预留显存: 3040.00 MB
dealing with 37
[12:02:07] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  59%|█████▉    | 38/64 [1:27:40<2:30:45, 347.92s/it][A[ASelf.trainer.train duration: 622.7690 seconds
显存占用: 2828.43 MB, 已预留显存: 3274.00 MB
dealing with 38
[12:14:26] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  61%|██████    | 39/64 [1:41:38<3:00:49, 433.99s/it][A[ASelf.trainer.train duration: 702.8932 seconds
显存占用: 3172.83 MB, 已预留显存: 3748.00 MB
dealing with 39
[12:28:24] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  62%|██████▎   | 40/64 [1:54:17<3:19:38, 499.10s/it][A[ASelf.trainer.train duration: 614.7903 seconds
显存占用: 3511.69 MB, 已预留显存: 4016.00 MB
dealing with 40
[12:41:02] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  64%|██████▍   | 41/64 [2:06:48<3:32:47, 555.13s/it][A[ASelf.trainer.train duration: 607.7372 seconds
显存占用: 3853.34 MB, 已预留显存: 4442.00 MB
dealing with 41
[12:53:33] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  66%|██████▌   | 42/64 [2:18:18<3:35:28, 587.67s/it][A[ASelf.trainer.train duration: 546.5319 seconds
显存占用: 4194.51 MB, 已预留显存: 4728.00 MB
dealing with 42
[13:05:03] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  67%|██████▋   | 43/64 [2:30:03<3:36:16, 617.93s/it][A[ASelf.trainer.train duration: 584.7087 seconds
显存占用: 4535.85 MB, 已预留显存: 5182.00 MB
dealing with 43
[13:16:49] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  69%|██████▉   | 44/64 [2:41:17<3:30:59, 632.98s/it][A[ASelf.trainer.train duration: 531.0776 seconds
显存占用: 4876.04 MB, 已预留显存: 5322.00 MB
dealing with 44
[13:28:03] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  70%|███████   | 45/64 [2:52:14<3:22:32, 639.62s/it][A[ASelf.trainer.train duration: 529.2152 seconds
显存占用: 5218.18 MB, 已预留显存: 5800.00 MB
dealing with 45
[13:39:00] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
System is out of GPU memory

Refer to the Cycles GPU rendering documentation for possible solutions:
https://docs.blender.org/manual/en/latest/render/cycles/gpu_rendering.html

System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
viewpoint:  70%|███████   | 45/64 [2:52:18<1:12:45, 229.75s/it]

                                                                      [AProcessing Categories:   0%|          | 0/55 [2:53:02<?, ?category/s]
Traceback (most recent call last):
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 240, in <module>
    distribution_dataset_construction(model_path, num_azimuth, num_elevation, radius, start_viewpoint_index, viewpoint_index_interval)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 160, in distribution_dataset_construction
    env.reset()
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_env.py", line 117, in reset
    np_images, transforms = self.get_images(mode='init')
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_env.py", line 129, in get_images
    return self.gen_data(mode, return_quat=return_quat)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_env.py", line 150, in gen_data
    image = self.scene.render_pose(pose)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_scene.py", line 215, in render_pose
    result = self.render() #
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_scene.py", line 566, in render
    return super().render()
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_scene.py", line 422, in render
    result = bpycv.render_data()
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/bpycv/render_utils.py", line 115, in render_data
    render_result["image"] = _render_image()
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/bpycv/render_utils.py", line 94, in render_image
    bpy.ops.render.render(write_still=True)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/bpy/3.6/scripts/modules/bpy/ops.py", line 113, in __call__
    ret = _op_call(self.idname_py(), None, kw)
RuntimeError: Error: System is out of GPU memory
Error: System is out of GPU memory

Iteration 1 completed

Iteration 2/30
Processing Categories:   0%|          | 0/55 [00:00<?, ?category/s]
Processing Models in pillow:   0%|          | 0/96 [00:00<?, ?model/s][A/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tyro/_fields.py:1066: UserWarning: Mutable type <class 'config.EnvConfig'> is used as a default value for `env`. This is dangerous! Consider using `dataclasses.field(default_factory=...)` or marking <class 'config.EnvConfig'> as frozen.
  warnings.warn(
pillow:/attached/data/remote-home2/zzq/data/shapenet/ShapeNetCore.v2/03938244/55a09adb1315764f8a766d8de50bb39d


CUDA
Generating data for init
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/boxx/ylcompat.py:69: BoxxWarning: warning from boxx
    os.environ["DISPLAY"] is not found
    plt.show() are redirect to plt.savefig(tmp)
    function: show, loga, crun, heatmap, plot will be affected
  def __setDisplayEnv():
saving data to data/shapenet/init/transforms.json
[13:40:44] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Found 64 GT images, loading directly from /remote-home/zzq/data/ShapeNet/gt_shapenet/pillow/55a09adb1315764f8a766d8de50bb39d
Loaded 64 GT images successfully!


viewpoint:   0%|          | 0/64 [00:00<?, ?it/s][A[Adealing with 45
[13:40:51] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:70: FutureWarning: Importing `spectral_angle_mapper` from `torchmetrics.functional` was deprecated and will be removed in 2.0. Import `spectral_angle_mapper` from `torchmetrics.image` instead.
  _future_warning(


viewpoint:  72%|███████▏  | 46/64 [11:30<04:30, 15.00s/it][A[ASelf.trainer.train duration: 566.7290 seconds
显存占用: 776.52 MB, 已预留显存: 1114.00 MB
dealing with 46
[13:52:21] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  73%|███████▎  | 47/64 [23:05<10:03, 35.50s/it][A[ASelf.trainer.train duration: 570.8489 seconds
显存占用: 1118.66 MB, 已预留显存: 1516.00 MB
dealing with 47
[14:03:57] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  75%|███████▌  | 48/64 [35:36<17:20, 65.00s/it][A[ASelf.trainer.train duration: 607.7883 seconds
显存占用: 1461.87 MB, 已预留显存: 1942.00 MB
dealing with 48
[14:16:27] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  77%|███████▋  | 49/64 [46:46<24:40, 98.69s/it][A[ASelf.trainer.train duration: 546.7355 seconds
显存占用: 1802.29 MB, 已预留显存: 2260.00 MB
dealing with 49
[14:27:37] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  78%|███████▊  | 50/64 [57:31<32:25, 138.95s/it][A[ASelf.trainer.train duration: 522.9589 seconds
显存占用: 2144.63 MB, 已预留显存: 2634.00 MB
dealing with 50
[14:38:23] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  80%|███████▉  | 51/64 [1:08:40<41:02, 189.41s/it][A[ASelf.trainer.train duration: 525.2591 seconds
显存占用: 2485.95 MB, 已预留显存: 2928.00 MB
dealing with 51
[14:49:32] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  81%|████████▏ | 52/64 [1:19:37<49:03, 245.31s/it][A[ASelf.trainer.train duration: 528.7934 seconds
显存占用: 2828.79 MB, 已预留显存: 3374.00 MB
dealing with 52
[15:00:28] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  83%|████████▎ | 53/64 [1:30:03<55:11, 301.01s/it][A[ASelf.trainer.train duration: 522.2069 seconds
显存占用: 3169.20 MB, 已预留显存: 3722.00 MB
dealing with 53
[15:10:55] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  84%|████████▍ | 54/64 [1:41:37<1:01:27, 368.80s/it][A[ASelf.trainer.train duration: 551.2704 seconds
显存占用: 3511.50 MB, 已预留显存: 4014.00 MB
dealing with 54
[15:22:29] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  86%|████████▌ | 55/64 [1:53:46<1:06:00, 440.03s/it][A[ASelf.trainer.train duration: 592.2231 seconds
显存占用: 3852.33 MB, 已预留显存: 4384.00 MB
dealing with 55
[15:34:38] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  88%|████████▊ | 56/64 [2:04:36<1:04:49, 486.24s/it][A[ASelf.trainer.train duration: 519.0959 seconds
显存占用: 4192.86 MB, 已预留显存: 4750.00 MB
dealing with 56
[15:45:27] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  89%|████████▉ | 57/64 [2:15:59<1:02:13, 533.36s/it][A[ASelf.trainer.train duration: 538.5165 seconds
显存占用: 4535.20 MB, 已预留显存: 5074.00 MB
dealing with 57
[15:56:50] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  91%|█████████ | 58/64 [2:27:27<57:16, 572.69s/it]  [A[ASelf.trainer.train duration: 568.1419 seconds
显存占用: 4876.69 MB, 已预留显存: 5548.00 MB
dealing with 58
[16:08:18] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  92%|█████████▏| 59/64 [2:38:01<49:06, 589.25s/it][A[ASelf.trainer.train duration: 512.9611 seconds
显存占用: 5216.78 MB, 已预留显存: 5812.00 MB
dealing with 59
[16:18:53] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  94%|█████████▍| 60/64 [2:48:39<40:10, 602.73s/it][A[ASelf.trainer.train duration: 516.8336 seconds
显存占用: 5558.76 MB, 已预留显存: 6154.00 MB
dealing with 60
[16:29:31] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  95%|█████████▌| 61/64 [2:59:22<30:41, 613.96s/it][A[ASelf.trainer.train duration: 519.7756 seconds
显存占用: 5900.71 MB, 已预留显存: 6470.00 MB
dealing with 61
[16:40:13] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  97%|█████████▋| 62/64 [3:10:27<20:57, 628.58s/it][A[ASelf.trainer.train duration: 536.5240 seconds
显存占用: 6239.96 MB, 已预留显存: 6844.00 MB
dealing with 62
[16:51:18] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  98%|█████████▊| 63/64 [3:21:00<10:30, 630.11s/it][A[ASelf.trainer.train duration: 491.7423 seconds
显存占用: 6584.85 MB, 已预留显存: 7208.00 MB
dealing with 63
[17:01:52] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint: 100%|██████████| 64/64 [3:31:59<00:00, 638.45s/it][A[Aviewpoint: 100%|██████████| 64/64 [3:31:59<00:00, 198.74s/it]

Processing Models in pillow:   1%|          | 1/96 [3:32:25<336:19:53, 12745.19s/model][A/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tyro/_fields.py:1066: UserWarning: Mutable type <class 'config.EnvConfig'> is used as a default value for `env`. This is dangerous! Consider using `dataclasses.field(default_factory=...)` or marking <class 'config.EnvConfig'> as frozen.
  warnings.warn(
Self.trainer.train duration: 533.4384 seconds
显存占用: 6924.73 MB, 已预留显存: 7590.00 MB
pillow:/attached/data/remote-home2/zzq/data/shapenet/ShapeNetCore.v2/03938244/2fe82cff107cbeaeb357233991a61d01


CUDA
Generating data for init
saving data to data/shapenet/init/transforms.json
[17:13:36] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Found 64 GT images, loading directly from /remote-home/zzq/data/ShapeNet/gt_shapenet/pillow/2fe82cff107cbeaeb357233991a61d01
Loaded 64 GT images successfully!


viewpoint:   0%|          | 0/64 [00:00<?, ?it/s][A[Adealing with 0
[17:13:41] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:   2%|▏         | 1/64 [12:09<12:45:52, 729.41s/it][A[ASelf.trainer.train duration: 573.5811 seconds
显存占用: 7487.68 MB, 已预留显存: 8368.00 MB
dealing with 1
[17:25:51] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
System is out of GPU memory

Refer to the Cycles GPU rendering documentation for possible solutions:
https://docs.blender.org/manual/en/latest/render/cycles/gpu_rendering.html

System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
viewpoint:   2%|▏         | 1/64 [12:13<12:50:15, 733.57s/it]

                                                                                       [AProcessing Categories:   0%|          | 0/55 [3:45:29<?, ?category/s]
Traceback (most recent call last):
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 240, in <module>
    distribution_dataset_construction(model_path, num_azimuth, num_elevation, radius, start_viewpoint_index, viewpoint_index_interval)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 160, in distribution_dataset_construction
    env.reset()
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_env.py", line 117, in reset
    np_images, transforms = self.get_images(mode='init')
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_env.py", line 129, in get_images
    return self.gen_data(mode, return_quat=return_quat)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_env.py", line 150, in gen_data
    image = self.scene.render_pose(pose)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_scene.py", line 215, in render_pose
    result = self.render() #
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_scene.py", line 566, in render
    return super().render()
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_scene.py", line 422, in render
    result = bpycv.render_data()
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/bpycv/render_utils.py", line 115, in render_data
    render_result["image"] = _render_image()
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/bpycv/render_utils.py", line 94, in render_image
    bpy.ops.render.render(write_still=True)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/bpy/3.6/scripts/modules/bpy/ops.py", line 113, in __call__
    ret = _op_call(self.idname_py(), None, kw)
RuntimeError: Error: System is out of GPU memory
Error: System is out of GPU memory

Iteration 2 completed

Iteration 3/30
Processing Categories:   0%|          | 0/55 [00:00<?, ?category/s]
Processing Models in pillow:   0%|          | 0/96 [00:00<?, ?model/s][A/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tyro/_fields.py:1066: UserWarning: Mutable type <class 'config.EnvConfig'> is used as a default value for `env`. This is dangerous! Consider using `dataclasses.field(default_factory=...)` or marking <class 'config.EnvConfig'> as frozen.
  warnings.warn(
pillow:/attached/data/remote-home2/zzq/data/shapenet/ShapeNetCore.v2/03938244/2fe82cff107cbeaeb357233991a61d01


CUDA
Generating data for init
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/boxx/ylcompat.py:69: BoxxWarning: warning from boxx
    os.environ["DISPLAY"] is not found
    plt.show() are redirect to plt.savefig(tmp)
    function: show, loga, crun, heatmap, plot will be affected
  def __setDisplayEnv():
saving data to data/shapenet/init/transforms.json
[17:27:59] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Found 64 GT images, loading directly from /remote-home/zzq/data/ShapeNet/gt_shapenet/pillow/2fe82cff107cbeaeb357233991a61d01
Loaded 64 GT images successfully!


viewpoint:   0%|          | 0/64 [00:00<?, ?it/s][A[Adealing with 1
[17:28:07] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:70: FutureWarning: Importing `spectral_angle_mapper` from `torchmetrics.functional` was deprecated and will be removed in 2.0. Import `spectral_angle_mapper` from `torchmetrics.image` instead.
  _future_warning(


viewpoint:   3%|▎         | 2/64 [11:43<6:03:35, 351.86s/it][A[ASelf.trainer.train duration: 524.5178 seconds
显存占用: 778.18 MB, 已预留显存: 1242.00 MB
dealing with 2
[17:39:50] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:   5%|▍         | 3/64 [23:46<8:34:47, 506.34s/it][A[ASelf.trainer.train duration: 582.6302 seconds
显存占用: 1118.08 MB, 已预留显存: 1704.00 MB
dealing with 3
[17:51:53] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:   6%|▋         | 4/64 [35:18<9:35:33, 575.55s/it][A[ASelf.trainer.train duration: 545.7826 seconds
显存占用: 1459.12 MB, 已预留显存: 1918.00 MB
dealing with 4
[18:03:25] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:   8%|▊         | 5/64 [47:22<10:16:47, 627.25s/it][A[ASelf.trainer.train duration: 565.6190 seconds
显存占用: 1802.68 MB, 已预留显存: 2426.00 MB
dealing with 5
[18:15:29] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:   9%|▉         | 6/64 [59:11<10:32:40, 654.50s/it][A[ASelf.trainer.train duration: 552.7838 seconds
显存占用: 2144.67 MB, 已预留显存: 2730.00 MB
dealing with 6
[18:27:18] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  11%|█         | 7/64 [1:11:01<10:38:36, 672.22s/it][A[ASelf.trainer.train duration: 560.1423 seconds
显存占用: 2486.33 MB, 已预留显存: 3106.00 MB
dealing with 7
[18:39:08] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  12%|█▎        | 8/64 [1:23:27<10:49:05, 695.46s/it][A[ASelf.trainer.train duration: 562.6331 seconds
显存占用: 2827.57 MB, 已预留显存: 3522.00 MB
dealing with 8
[18:51:34] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  14%|█▍        | 9/64 [1:35:05<10:38:20, 696.37s/it][A[ASelf.trainer.train duration: 540.5969 seconds
显存占用: 3168.84 MB, 已预留显存: 3704.00 MB
dealing with 9
[19:03:13] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  16%|█▌        | 10/64 [1:47:19<10:36:58, 707.76s/it][A[ASelf.trainer.train duration: 580.9777 seconds
显存占用: 3511.22 MB, 已预留显存: 4316.00 MB
dealing with 10
[19:15:26] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  17%|█▋        | 11/64 [1:59:08<10:25:27, 708.06s/it][A[ASelf.trainer.train duration: 533.7734 seconds
显存占用: 3852.83 MB, 已预留显存: 4472.00 MB
dealing with 11
[19:27:15] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  19%|█▉        | 12/64 [2:10:16<10:03:14, 696.06s/it][A[ASelf.trainer.train duration: 517.3102 seconds
显存占用: 4195.45 MB, 已预留显存: 4756.00 MB
dealing with 12
[19:38:23] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  20%|██        | 13/64 [2:21:58<9:53:07, 697.79s/it] [A[ASelf.trainer.train duration: 543.0569 seconds
显存占用: 4535.73 MB, 已预留显存: 5176.00 MB
dealing with 13
[19:50:05] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  22%|██▏       | 14/64 [2:33:21<9:37:54, 693.48s/it][A[ASelf.trainer.train duration: 534.9761 seconds
显存占用: 4877.73 MB, 已预留显存: 5536.00 MB
dealing with 14
[20:01:28] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  23%|██▎       | 15/64 [2:45:22<9:32:57, 701.58s/it][A[ASelf.trainer.train duration: 565.7569 seconds
显存占用: 5220.80 MB, 已预留显存: 6048.00 MB
dealing with 15
[20:13:29] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  25%|██▌       | 16/64 [2:57:25<9:26:31, 708.16s/it][A[ASelf.trainer.train duration: 572.2783 seconds
显存占用: 5560.55 MB, 已预留显存: 6388.00 MB
dealing with 16
[20:25:32] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  27%|██▋       | 17/64 [3:09:47<9:22:44, 718.40s/it][A[ASelf.trainer.train duration: 601.3152 seconds
显存占用: 5902.32 MB, 已预留显存: 6668.00 MB
dealing with 17
[20:37:55] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  28%|██▊       | 18/64 [3:21:46<9:10:55, 718.60s/it][A[ASelf.trainer.train duration: 572.2989 seconds
显存占用: 6242.85 MB, 已预留显存: 6896.00 MB
dealing with 18
[20:49:54] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
System is out of GPU memory

Refer to the Cycles GPU rendering documentation for possible solutions:
https://docs.blender.org/manual/en/latest/render/cycles/gpu_rendering.html

viewpoint:  28%|██▊       | 18/64 [3:21:51<8:35:50, 672.84s/it]

                                                                      [AProcessing Categories:   0%|          | 0/55 [3:22:30<?, ?category/s]
Traceback (most recent call last):
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 240, in <module>
    distribution_dataset_construction(model_path, num_azimuth, num_elevation, radius, start_viewpoint_index, viewpoint_index_interval)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 160, in distribution_dataset_construction
    env.reset()
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_env.py", line 117, in reset
    np_images, transforms = self.get_images(mode='init')
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_env.py", line 129, in get_images
    return self.gen_data(mode, return_quat=return_quat)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_env.py", line 150, in gen_data
    image = self.scene.render_pose(pose)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_scene.py", line 215, in render_pose
    result = self.render() #
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_scene.py", line 566, in render
    return super().render()
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_scene.py", line 422, in render
    result = bpycv.render_data()
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/bpycv/render_utils.py", line 115, in render_data
    render_result["image"] = _render_image()
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/bpycv/render_utils.py", line 94, in render_image
    bpy.ops.render.render(write_still=True)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/bpy/3.6/scripts/modules/bpy/ops.py", line 113, in __call__
    ret = _op_call(self.idname_py(), None, kw)
RuntimeError: Error: System is out of GPU memory
Error: System is out of GPU memory

Iteration 3 completed

Iteration 4/30
Processing Categories:   0%|          | 0/55 [00:00<?, ?category/s]
Processing Models in pillow:   0%|          | 0/96 [00:00<?, ?model/s][A/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tyro/_fields.py:1066: UserWarning: Mutable type <class 'config.EnvConfig'> is used as a default value for `env`. This is dangerous! Consider using `dataclasses.field(default_factory=...)` or marking <class 'config.EnvConfig'> as frozen.
  warnings.warn(
pillow:/attached/data/remote-home2/zzq/data/shapenet/ShapeNetCore.v2/03938244/2fe82cff107cbeaeb357233991a61d01


CUDA
Generating data for init
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/boxx/ylcompat.py:69: BoxxWarning: warning from boxx
    os.environ["DISPLAY"] is not found
    plt.show() are redirect to plt.savefig(tmp)
    function: show, loga, crun, heatmap, plot will be affected
  def __setDisplayEnv():
saving data to data/shapenet/init/transforms.json
[20:52:07] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Found 64 GT images, loading directly from /remote-home/zzq/data/ShapeNet/gt_shapenet/pillow/2fe82cff107cbeaeb357233991a61d01
Loaded 64 GT images successfully!


viewpoint:   0%|          | 0/64 [00:00<?, ?it/s][A[Adealing with 18
[20:52:14] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:70: FutureWarning: Importing `spectral_angle_mapper` from `torchmetrics.functional` was deprecated and will be removed in 2.0. Import `spectral_angle_mapper` from `torchmetrics.image` instead.
  _future_warning(


viewpoint:  30%|██▉       | 19/64 [12:18<29:09, 38.88s/it][A[ASelf.trainer.train duration: 596.8439 seconds
显存占用: 779.08 MB, 已预留显存: 1214.00 MB
dealing with 19
[21:04:33] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  31%|███▏      | 20/64 [24:13<1:03:11, 86.18s/it][A[ASelf.trainer.train duration: 558.5390 seconds
显存占用: 1119.73 MB, 已预留显存: 1506.00 MB
dealing with 20
[21:16:28] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  33%|███▎      | 21/64 [37:14<1:46:57, 149.24s/it][A[ASelf.trainer.train duration: 623.8094 seconds
显存占用: 1463.70 MB, 已预留显存: 2210.00 MB
dealing with 21
[21:29:29] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  34%|███▍      | 22/64 [49:16<2:30:33, 215.08s/it][A[ASelf.trainer.train duration: 601.3184 seconds
显存占用: 1806.83 MB, 已预留显存: 2498.00 MB
dealing with 22
[21:41:31] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  36%|███▌      | 23/64 [1:02:05<3:20:17, 293.10s/it][A[ASelf.trainer.train duration: 633.3025 seconds
显存占用: 2147.93 MB, 已预留显存: 2778.00 MB
dealing with 23
[21:54:20] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  38%|███▊      | 24/64 [1:14:44<4:07:29, 371.23s/it][A[ASelf.trainer.train duration: 608.9385 seconds
显存占用: 2488.45 MB, 已预留显存: 3026.00 MB
dealing with 24
[22:06:59] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  39%|███▉      | 25/64 [1:28:06<4:55:19, 454.35s/it][A[ASelf.trainer.train duration: 672.7172 seconds
显存占用: 2831.26 MB, 已预留显存: 3418.00 MB
dealing with 25
[22:20:21] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  41%|████      | 26/64 [1:41:42<5:37:19, 532.62s/it][A[ASelf.trainer.train duration: 683.5142 seconds
显存占用: 3174.08 MB, 已预留显存: 3730.00 MB
dealing with 26
[22:33:57] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json
viewpoint:  41%|████      | 26/64 [1:43:17<2:30:57, 238.36s/it]

                                                                      [AProcessing Categories:   0%|          | 0/55 [1:43:55<?, ?category/s]
Traceback (most recent call last):
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 240, in <module>
    distribution_dataset_construction(model_path, num_azimuth, num_elevation, radius, start_viewpoint_index, viewpoint_index_interval)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 164, in distribution_dataset_construction
    NeRF_pipeline.add_image(images=obs,poses=input_pose,model_option=None)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nvf/active_mapping/active_mapping.py", line 233, in add_image
    self.trainer.train()
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nvf/nerfstudio_interface/nbv_trainer.py", line 213, in train
    loss, loss_dict, metrics_dict = self.train_iteration(step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/utils/profiler.py", line 127, in inner
    out = func(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/engine/trainer.py", line 740, in train_iteration
    _, loss_dict, metrics_dict = self.pipeline.get_train_loss_dict(step=step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/pipelines/dynamic_batch.py", line 91, in get_train_loss_dict
    model_outputs, loss_dict, metrics_dict = super().get_train_loss_dict(step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/utils/profiler.py", line 127, in inner
    out = func(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/pipelines/base_pipeline.py", line 284, in get_train_loss_dict
    model_outputs = self._model(ray_bundle)  # train distributed data parallel model if world_size > 1
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/models/base_model.py", line 142, in forward
    return self.get_outputs(ray_bundle)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/models/instant_ngp.py", line 302, in get_outputs
    ray_samples, ray_indices = self.sampler(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/model_components/ray_samplers.py", line 482, in forward
    ray_indices, starts, ends = self.occupancy_grid.sampling(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/nerfacc/estimators/occ_grid.py", line 192, in sampling
    sigmas = sigma_fn(t_starts, t_ends, ray_indices)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/model_components/ray_samplers.py", line 428, in sigma_fn
    return density_fn(positions).squeeze(-1)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/fields/base_field.py", line 67, in density_fn
    density, _ = self.get_density(ray_samples)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/fields/nerfacto_field.py", line 252, in get_density
    h = self.mlp_base(positions_flat).view(*ray_samples.frustums.shape, -1)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/field_components/mlp.py", line 177, in forward
    return self.tcnn_encoding(in_tensor)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tinycudann/modules.py", line 190, in forward
    output = _module_function.apply(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/autograd/function.py", line 506, in apply
    return super().apply(*args, **kwargs)  # type: ignore[misc]
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tinycudann/modules.py", line 102, in forward
    native_ctx, output = native_tcnn_module.fwd(input, params)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 266.00 MiB (GPU 0; 23.68 GiB total capacity; 6.36 GiB already allocated; 193.75 MiB free; 6.63 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
Iteration 4 completed

Iteration 5/30
Processing Categories:   0%|          | 0/55 [00:00<?, ?category/s]
Processing Models in pillow:   0%|          | 0/96 [00:00<?, ?model/s][A/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tyro/_fields.py:1066: UserWarning: Mutable type <class 'config.EnvConfig'> is used as a default value for `env`. This is dangerous! Consider using `dataclasses.field(default_factory=...)` or marking <class 'config.EnvConfig'> as frozen.
  warnings.warn(
pillow:/attached/data/remote-home2/zzq/data/shapenet/ShapeNetCore.v2/03938244/2fe82cff107cbeaeb357233991a61d01


CUDA
Generating data for init
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/boxx/ylcompat.py:69: BoxxWarning: warning from boxx
    os.environ["DISPLAY"] is not found
    plt.show() are redirect to plt.savefig(tmp)
    function: show, loga, crun, heatmap, plot will be affected
  def __setDisplayEnv():
saving data to data/shapenet/init/transforms.json
[22:38:02] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Found 64 GT images, loading directly from /remote-home/zzq/data/ShapeNet/gt_shapenet/pillow/2fe82cff107cbeaeb357233991a61d01
Loaded 64 GT images successfully!


viewpoint:   0%|          | 0/64 [00:00<?, ?it/s][A[Adealing with 26
[22:38:09] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:70: FutureWarning: Importing `spectral_angle_mapper` from `torchmetrics.functional` was deprecated and will be removed in 2.0. Import `spectral_angle_mapper` from `torchmetrics.image` instead.
  _future_warning(


viewpoint:  42%|████▏     | 27/64 [13:37<18:39, 30.26s/it][A[ASelf.trainer.train duration: 688.3288 seconds
显存占用: 779.86 MB, 已预留显存: 1342.00 MB
dealing with 27
[22:51:46] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  44%|████▍     | 28/64 [28:24<44:00, 73.35s/it][A[ASelf.trainer.train duration: 721.2803 seconds
显存占用: 1121.51 MB, 已预留显存: 1742.00 MB
dealing with 28
[23:06:34] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  45%|████▌     | 29/64 [43:26<1:15:09, 128.83s/it][A[ASelf.trainer.train duration: 774.6418 seconds
显存占用: 1464.47 MB, 已预留显存: 2430.00 MB
dealing with 29
[23:21:35] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  47%|████▋     | 30/64 [56:15<1:44:39, 184.70s/it][A[ASelf.trainer.train duration: 626.5569 seconds
显存占用: 1803.92 MB, 已预留显存: 2536.00 MB
dealing with 30
[23:34:24] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  48%|████▊     | 31/64 [1:10:50<2:23:43, 261.33s/it][A[ASelf.trainer.train duration: 741.1541 seconds
显存占用: 2145.86 MB, 已预留显存: 2726.00 MB
dealing with 31
[23:49:00] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  50%|█████     | 32/64 [1:25:35<3:04:51, 346.61s/it][A[ASelf.trainer.train duration: 748.1154 seconds
显存占用: 2486.67 MB, 已预留显存: 3216.00 MB
dealing with 32
[00:03:44] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json
viewpoint:  50%|█████     | 32/64 [1:27:46<1:27:46, 164.58s/it]

                                                                      [AProcessing Categories:   0%|          | 0/55 [1:28:47<?, ?category/s]
Traceback (most recent call last):
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 240, in <module>
    distribution_dataset_construction(model_path, num_azimuth, num_elevation, radius, start_viewpoint_index, viewpoint_index_interval)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 164, in distribution_dataset_construction
    NeRF_pipeline.add_image(images=obs,poses=input_pose,model_option=None)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nvf/active_mapping/active_mapping.py", line 233, in add_image
    self.trainer.train()
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nvf/nerfstudio_interface/nbv_trainer.py", line 213, in train
    loss, loss_dict, metrics_dict = self.train_iteration(step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/utils/profiler.py", line 127, in inner
    out = func(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/engine/trainer.py", line 740, in train_iteration
    _, loss_dict, metrics_dict = self.pipeline.get_train_loss_dict(step=step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/pipelines/dynamic_batch.py", line 91, in get_train_loss_dict
    model_outputs, loss_dict, metrics_dict = super().get_train_loss_dict(step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/utils/profiler.py", line 127, in inner
    out = func(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/pipelines/base_pipeline.py", line 284, in get_train_loss_dict
    model_outputs = self._model(ray_bundle)  # train distributed data parallel model if world_size > 1
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/models/base_model.py", line 142, in forward
    return self.get_outputs(ray_bundle)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/models/instant_ngp.py", line 302, in get_outputs
    ray_samples, ray_indices = self.sampler(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/model_components/ray_samplers.py", line 482, in forward
    ray_indices, starts, ends = self.occupancy_grid.sampling(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/nerfacc/estimators/occ_grid.py", line 192, in sampling
    sigmas = sigma_fn(t_starts, t_ends, ray_indices)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/model_components/ray_samplers.py", line 428, in sigma_fn
    return density_fn(positions).squeeze(-1)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/fields/base_field.py", line 67, in density_fn
    density, _ = self.get_density(ray_samples)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/fields/nerfacto_field.py", line 252, in get_density
    h = self.mlp_base(positions_flat).view(*ray_samples.frustums.shape, -1)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/field_components/mlp.py", line 177, in forward
    return self.tcnn_encoding(in_tensor)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tinycudann/modules.py", line 190, in forward
    output = _module_function.apply(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/autograd/function.py", line 506, in apply
    return super().apply(*args, **kwargs)  # type: ignore[misc]
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tinycudann/modules.py", line 102, in forward
    native_ctx, output = native_tcnn_module.fwd(input, params)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 318.00 MiB (GPU 0; 23.68 GiB total capacity; 6.27 GiB already allocated; 271.75 MiB free; 6.40 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
Iteration 5 completed

Iteration 6/30
Processing Categories:   0%|          | 0/55 [00:00<?, ?category/s]
Processing Models in pillow:   0%|          | 0/96 [00:00<?, ?model/s][A/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tyro/_fields.py:1066: UserWarning: Mutable type <class 'config.EnvConfig'> is used as a default value for `env`. This is dangerous! Consider using `dataclasses.field(default_factory=...)` or marking <class 'config.EnvConfig'> as frozen.
  warnings.warn(
pillow:/attached/data/remote-home2/zzq/data/shapenet/ShapeNetCore.v2/03938244/2fe82cff107cbeaeb357233991a61d01


CUDA
Generating data for init
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/boxx/ylcompat.py:69: BoxxWarning: warning from boxx
    os.environ["DISPLAY"] is not found
    plt.show() are redirect to plt.savefig(tmp)
    function: show, loga, crun, heatmap, plot will be affected
  def __setDisplayEnv():
saving data to data/shapenet/init/transforms.json
[00:08:14] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Found 64 GT images, loading directly from /remote-home/zzq/data/ShapeNet/gt_shapenet/pillow/2fe82cff107cbeaeb357233991a61d01
Loaded 64 GT images successfully!


viewpoint:   0%|          | 0/64 [00:00<?, ?it/s][A[Adealing with 32
[00:08:22] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:70: FutureWarning: Importing `spectral_angle_mapper` from `torchmetrics.functional` was deprecated and will be removed in 2.0. Import `spectral_angle_mapper` from `torchmetrics.image` instead.
  _future_warning(


viewpoint:  52%|█████▏    | 33/64 [14:05<13:14, 25.62s/it][A[ASelf.trainer.train duration: 703.1280 seconds
显存占用: 781.29 MB, 已预留显存: 1426.00 MB
dealing with 33
[00:22:27] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  53%|█████▎    | 34/64 [27:05<28:27, 56.93s/it][A[ASelf.trainer.train duration: 641.6403 seconds
显存占用: 1119.11 MB, 已预留显存: 1612.00 MB
dealing with 34
[00:35:27] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  55%|█████▍    | 35/64 [39:04<45:25, 93.97s/it][A[ASelf.trainer.train duration: 570.7716 seconds
显存占用: 1460.43 MB, 已预留显存: 1834.00 MB
dealing with 35
[00:47:26] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  56%|█████▋    | 36/64 [51:35<1:06:33, 142.63s/it][A[ASelf.trainer.train duration: 607.2164 seconds
显存占用: 1802.42 MB, 已预留显存: 2312.00 MB
dealing with 36
[00:59:58] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  58%|█████▊    | 37/64 [1:04:32<1:31:28, 203.29s/it][A[ASelf.trainer.train duration: 637.3391 seconds
显存占用: 2145.17 MB, 已预留显存: 2618.00 MB
dealing with 37
[01:12:54] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json
viewpoint:  58%|█████▊    | 37/64 [1:06:10<48:17, 107.31s/it]  

                                                                      [AProcessing Categories:   0%|          | 0/55 [1:07:02<?, ?category/s]
Traceback (most recent call last):
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 240, in <module>
    distribution_dataset_construction(model_path, num_azimuth, num_elevation, radius, start_viewpoint_index, viewpoint_index_interval)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 164, in distribution_dataset_construction
    NeRF_pipeline.add_image(images=obs,poses=input_pose,model_option=None)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nvf/active_mapping/active_mapping.py", line 233, in add_image
    self.trainer.train()
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nvf/nerfstudio_interface/nbv_trainer.py", line 213, in train
    loss, loss_dict, metrics_dict = self.train_iteration(step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/utils/profiler.py", line 127, in inner
    out = func(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/engine/trainer.py", line 740, in train_iteration
    _, loss_dict, metrics_dict = self.pipeline.get_train_loss_dict(step=step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/pipelines/dynamic_batch.py", line 91, in get_train_loss_dict
    model_outputs, loss_dict, metrics_dict = super().get_train_loss_dict(step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/utils/profiler.py", line 127, in inner
    out = func(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/pipelines/base_pipeline.py", line 284, in get_train_loss_dict
    model_outputs = self._model(ray_bundle)  # train distributed data parallel model if world_size > 1
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/models/base_model.py", line 142, in forward
    return self.get_outputs(ray_bundle)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/models/instant_ngp.py", line 302, in get_outputs
    ray_samples, ray_indices = self.sampler(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/model_components/ray_samplers.py", line 482, in forward
    ray_indices, starts, ends = self.occupancy_grid.sampling(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/nerfacc/estimators/occ_grid.py", line 192, in sampling
    sigmas = sigma_fn(t_starts, t_ends, ray_indices)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/model_components/ray_samplers.py", line 428, in sigma_fn
    return density_fn(positions).squeeze(-1)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/fields/base_field.py", line 67, in density_fn
    density, _ = self.get_density(ray_samples)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/fields/nerfacto_field.py", line 252, in get_density
    h = self.mlp_base(positions_flat).view(*ray_samples.frustums.shape, -1)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/field_components/mlp.py", line 177, in forward
    return self.tcnn_encoding(in_tensor)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tinycudann/modules.py", line 190, in forward
    output = _module_function.apply(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/autograd/function.py", line 506, in apply
    return super().apply(*args, **kwargs)  # type: ignore[misc]
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tinycudann/modules.py", line 102, in forward
    native_ctx, output = native_tcnn_module.fwd(input, params)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 274.00 MiB (GPU 0; 23.68 GiB total capacity; 5.44 GiB already allocated; 241.75 MiB free; 5.66 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
Iteration 6 completed

Iteration 7/30
Processing Categories:   0%|          | 0/55 [00:00<?, ?category/s]
Processing Models in pillow:   0%|          | 0/96 [00:00<?, ?model/s][A/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tyro/_fields.py:1066: UserWarning: Mutable type <class 'config.EnvConfig'> is used as a default value for `env`. This is dangerous! Consider using `dataclasses.field(default_factory=...)` or marking <class 'config.EnvConfig'> as frozen.
  warnings.warn(
pillow:/attached/data/remote-home2/zzq/data/shapenet/ShapeNetCore.v2/03938244/2fe82cff107cbeaeb357233991a61d01


CUDA
Generating data for init
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/boxx/ylcompat.py:69: BoxxWarning: warning from boxx
    os.environ["DISPLAY"] is not found
    plt.show() are redirect to plt.savefig(tmp)
    function: show, loga, crun, heatmap, plot will be affected
  def __setDisplayEnv():
saving data to data/shapenet/init/transforms.json
[01:16:36] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Found 64 GT images, loading directly from /remote-home/zzq/data/ShapeNet/gt_shapenet/pillow/2fe82cff107cbeaeb357233991a61d01
Loaded 64 GT images successfully!


viewpoint:   0%|          | 0/64 [00:00<?, ?it/s][A[Adealing with 37
[01:16:44] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:70: FutureWarning: Importing `spectral_angle_mapper` from `torchmetrics.functional` was deprecated and will be removed in 2.0. Import `spectral_angle_mapper` from `torchmetrics.image` instead.
  _future_warning(


viewpoint:  59%|█████▉    | 38/64 [12:55<08:50, 20.41s/it][A[ASelf.trainer.train duration: 648.0288 seconds
显存占用: 779.59 MB, 已预留显存: 1212.00 MB
dealing with 38
[01:29:39] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json
viewpoint:  59%|█████▉    | 38/64 [14:17<09:46, 22.56s/it]

                                                                      [AProcessing Categories:   0%|          | 0/55 [14:58<?, ?category/s]
Traceback (most recent call last):
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 240, in <module>
    distribution_dataset_construction(model_path, num_azimuth, num_elevation, radius, start_viewpoint_index, viewpoint_index_interval)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 164, in distribution_dataset_construction
    NeRF_pipeline.add_image(images=obs,poses=input_pose,model_option=None)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nvf/active_mapping/active_mapping.py", line 233, in add_image
    self.trainer.train()
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nvf/nerfstudio_interface/nbv_trainer.py", line 213, in train
    loss, loss_dict, metrics_dict = self.train_iteration(step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/utils/profiler.py", line 127, in inner
    out = func(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/engine/trainer.py", line 740, in train_iteration
    _, loss_dict, metrics_dict = self.pipeline.get_train_loss_dict(step=step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/pipelines/dynamic_batch.py", line 91, in get_train_loss_dict
    model_outputs, loss_dict, metrics_dict = super().get_train_loss_dict(step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/utils/profiler.py", line 127, in inner
    out = func(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/pipelines/base_pipeline.py", line 284, in get_train_loss_dict
    model_outputs = self._model(ray_bundle)  # train distributed data parallel model if world_size > 1
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/models/base_model.py", line 142, in forward
    return self.get_outputs(ray_bundle)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/models/instant_ngp.py", line 302, in get_outputs
    ray_samples, ray_indices = self.sampler(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/model_components/ray_samplers.py", line 482, in forward
    ray_indices, starts, ends = self.occupancy_grid.sampling(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/nerfacc/estimators/occ_grid.py", line 192, in sampling
    sigmas = sigma_fn(t_starts, t_ends, ray_indices)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/model_components/ray_samplers.py", line 428, in sigma_fn
    return density_fn(positions).squeeze(-1)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/fields/base_field.py", line 67, in density_fn
    density, _ = self.get_density(ray_samples)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/fields/nerfacto_field.py", line 252, in get_density
    h = self.mlp_base(positions_flat).view(*ray_samples.frustums.shape, -1)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/field_components/mlp.py", line 177, in forward
    return self.tcnn_encoding(in_tensor)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tinycudann/modules.py", line 192, in forward
    x_padded.to(torch.float).contiguous(),
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 1.62 GiB (GPU 0; 23.68 GiB total capacity; 3.26 GiB already allocated; 1.24 GiB free; 3.47 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
Iteration 7 completed

Iteration 8/30
Processing Categories:   0%|          | 0/55 [00:00<?, ?category/s]
Processing Models in pillow:   0%|          | 0/96 [00:00<?, ?model/s][A/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tyro/_fields.py:1066: UserWarning: Mutable type <class 'config.EnvConfig'> is used as a default value for `env`. This is dangerous! Consider using `dataclasses.field(default_factory=...)` or marking <class 'config.EnvConfig'> as frozen.
  warnings.warn(
pillow:/attached/data/remote-home2/zzq/data/shapenet/ShapeNetCore.v2/03938244/2fe82cff107cbeaeb357233991a61d01


CUDA
Generating data for init
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/boxx/ylcompat.py:69: BoxxWarning: warning from boxx
    os.environ["DISPLAY"] is not found
    plt.show() are redirect to plt.savefig(tmp)
    function: show, loga, crun, heatmap, plot will be affected
  def __setDisplayEnv():
saving data to data/shapenet/init/transforms.json
[01:33:28] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Found 64 GT images, loading directly from /remote-home/zzq/data/ShapeNet/gt_shapenet/pillow/2fe82cff107cbeaeb357233991a61d01
Loaded 64 GT images successfully!


viewpoint:   0%|          | 0/64 [00:00<?, ?it/s][A[Adealing with 38
[01:33:34] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:70: FutureWarning: Importing `spectral_angle_mapper` from `torchmetrics.functional` was deprecated and will be removed in 2.0. Import `spectral_angle_mapper` from `torchmetrics.image` instead.
  _future_warning(


viewpoint:  61%|██████    | 39/64 [13:29<08:39, 20.77s/it][A[ASelf.trainer.train duration: 659.8797 seconds
显存占用: 780.93 MB, 已预留显存: 1400.00 MB
dealing with 39
[01:47:04] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  62%|██████▎   | 40/64 [28:37<20:50, 52.12s/it][A[ASelf.trainer.train duration: 753.1987 seconds
显存占用: 1121.45 MB, 已预留显存: 1642.00 MB
dealing with 40
[02:02:12] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  64%|██████▍   | 41/64 [40:42<32:21, 84.43s/it][A[ASelf.trainer.train duration: 567.1065 seconds
显存占用: 1460.44 MB, 已预留显存: 1872.00 MB
dealing with 41
[02:14:16] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  66%|██████▌   | 42/64 [52:38<45:49, 124.98s/it][A[ASelf.trainer.train duration: 561.5341 seconds
显存占用: 1802.85 MB, 已预留显存: 2334.00 MB
dealing with 42
[02:26:12] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  67%|██████▋   | 43/64 [1:04:46<1:01:29, 175.70s/it][A[ASelf.trainer.train duration: 578.5607 seconds
显存占用: 2144.18 MB, 已预留显存: 2636.00 MB
dealing with 43
[02:38:20] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  69%|██████▉   | 44/64 [1:16:57<1:18:24, 235.21s/it][A[ASelf.trainer.train duration: 576.0568 seconds
显存占用: 2484.23 MB, 已预留显存: 2944.00 MB
dealing with 44
[02:50:31] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  70%|███████   | 45/64 [1:28:50<1:34:36, 298.74s/it][A[ASelf.trainer.train duration: 543.3822 seconds
显存占用: 2827.75 MB, 已预留显存: 3246.00 MB
dealing with 45
[03:02:25] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  72%|███████▏  | 46/64 [1:42:00<1:53:06, 377.02s/it][A[ASelf.trainer.train duration: 623.5117 seconds
显存占用: 3168.83 MB, 已预留显存: 3764.00 MB
dealing with 46
[03:15:34] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  73%|███████▎  | 47/64 [1:54:00<2:04:49, 440.58s/it][A[ASelf.trainer.train duration: 560.9952 seconds
显存占用: 3510.99 MB, 已预留显存: 4052.00 MB
dealing with 47
[03:27:34] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  75%|███████▌  | 48/64 [2:05:33<2:11:35, 493.46s/it][A[ASelf.trainer.train duration: 552.9672 seconds
显存占用: 3852.47 MB, 已预留显存: 4424.00 MB
dealing with 48
[03:39:07] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  77%|███████▋  | 49/64 [2:16:47<2:13:47, 535.19s/it][A[ASelf.trainer.train duration: 542.6005 seconds
显存占用: 4192.88 MB, 已预留显存: 4688.00 MB
dealing with 49
[03:50:22] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  78%|███████▊  | 50/64 [2:27:56<2:12:36, 568.36s/it][A[ASelf.trainer.train duration: 547.4021 seconds
显存占用: 4535.38 MB, 已预留显存: 5156.00 MB
dealing with 50
[04:01:31] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  80%|███████▉  | 51/64 [2:39:00<2:08:32, 593.30s/it][A[ASelf.trainer.train duration: 539.4887 seconds
显存占用: 4876.17 MB, 已预留显存: 5410.00 MB
dealing with 51
[04:12:34] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  81%|████████▏ | 52/64 [2:50:02<2:02:23, 611.99s/it][A[ASelf.trainer.train duration: 540.6567 seconds
显存占用: 5216.78 MB, 已预留显存: 5866.00 MB
dealing with 52
[04:23:37] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  83%|████████▎ | 53/64 [3:01:11<1:55:07, 627.99s/it][A[ASelf.trainer.train duration: 523.0053 seconds
显存占用: 5558.04 MB, 已预留显存: 6182.00 MB
dealing with 53
[04:34:46] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
System is out of GPU memory

Refer to the Cycles GPU rendering documentation for possible solutions:
https://docs.blender.org/manual/en/latest/render/cycles/gpu_rendering.html

System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
viewpoint:  83%|████████▎ | 53/64 [3:01:15<37:37, 205.20s/it]  

                                                                      [AProcessing Categories:   0%|          | 0/55 [3:02:24<?, ?category/s]
Traceback (most recent call last):
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 240, in <module>
    distribution_dataset_construction(model_path, num_azimuth, num_elevation, radius, start_viewpoint_index, viewpoint_index_interval)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 160, in distribution_dataset_construction
    env.reset()
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_env.py", line 117, in reset
    np_images, transforms = self.get_images(mode='init')
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_env.py", line 129, in get_images
    return self.gen_data(mode, return_quat=return_quat)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_env.py", line 150, in gen_data
    image = self.scene.render_pose(pose)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_scene.py", line 215, in render_pose
    result = self.render() #
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_scene.py", line 566, in render
    return super().render()
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_scene.py", line 422, in render
    result = bpycv.render_data()
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/bpycv/render_utils.py", line 115, in render_data
    render_result["image"] = _render_image()
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/bpycv/render_utils.py", line 94, in render_image
    bpy.ops.render.render(write_still=True)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/bpy/3.6/scripts/modules/bpy/ops.py", line 113, in __call__
    ret = _op_call(self.idname_py(), None, kw)
RuntimeError: Error: System is out of GPU memory
Error: System is out of GPU memory

Iteration 8 completed

Iteration 9/30
Processing Categories:   0%|          | 0/55 [00:00<?, ?category/s]
Processing Models in pillow:   0%|          | 0/96 [00:00<?, ?model/s][A/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tyro/_fields.py:1066: UserWarning: Mutable type <class 'config.EnvConfig'> is used as a default value for `env`. This is dangerous! Consider using `dataclasses.field(default_factory=...)` or marking <class 'config.EnvConfig'> as frozen.
  warnings.warn(
pillow:/attached/data/remote-home2/zzq/data/shapenet/ShapeNetCore.v2/03938244/2fe82cff107cbeaeb357233991a61d01


CUDA
Generating data for init
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/boxx/ylcompat.py:69: BoxxWarning: warning from boxx
    os.environ["DISPLAY"] is not found
    plt.show() are redirect to plt.savefig(tmp)
    function: show, loga, crun, heatmap, plot will be affected
  def __setDisplayEnv():
saving data to data/shapenet/init/transforms.json
[04:36:58] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Found 64 GT images, loading directly from /remote-home/zzq/data/ShapeNet/gt_shapenet/pillow/2fe82cff107cbeaeb357233991a61d01
Loaded 64 GT images successfully!


viewpoint:   0%|          | 0/64 [00:00<?, ?it/s][A[Adealing with 53
[04:37:05] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:70: FutureWarning: Importing `spectral_angle_mapper` from `torchmetrics.functional` was deprecated and will be removed in 2.0. Import `spectral_angle_mapper` from `torchmetrics.image` instead.
  _future_warning(


viewpoint:  84%|████████▍ | 54/64 [13:03<02:25, 14.51s/it][A[ASelf.trainer.train duration: 619.5189 seconds
显存占用: 776.24 MB, 已预留显存: 1134.00 MB
dealing with 54
[04:50:09] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  86%|████████▌ | 55/64 [25:09<04:55, 32.85s/it][A[ASelf.trainer.train duration: 584.8214 seconds
显存占用: 1117.33 MB, 已预留显存: 1666.00 MB
dealing with 55
[05:02:15] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  88%|████████▊ | 56/64 [36:44<07:30, 56.35s/it][A[ASelf.trainer.train duration: 556.8585 seconds
显存占用: 1460.39 MB, 已预留显存: 1854.00 MB
dealing with 56
[05:13:49] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  89%|████████▉ | 57/64 [48:54<10:22, 88.89s/it][A[ASelf.trainer.train duration: 604.4175 seconds
显存占用: 1801.89 MB, 已预留显存: 2350.00 MB
dealing with 57
[05:26:00] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  91%|█████████ | 58/64 [1:00:16<12:42, 127.14s/it][A[ASelf.trainer.train duration: 542.6418 seconds
显存占用: 2143.05 MB, 已预留显存: 2604.00 MB
dealing with 58
[05:37:21] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  92%|█████████▏| 59/64 [1:10:59<14:13, 170.72s/it][A[ASelf.trainer.train duration: 528.7603 seconds
显存占用: 2484.13 MB, 已预留显存: 2978.00 MB
dealing with 59
[05:48:05] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  94%|█████████▍| 60/64 [1:21:59<14:53, 223.34s/it][A[ASelf.trainer.train duration: 516.1514 seconds
显存占用: 2826.33 MB, 已预留显存: 3324.00 MB
dealing with 60
[05:59:05] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  95%|█████████▌| 61/64 [1:32:47<13:59, 279.90s/it][A[ASelf.trainer.train duration: 507.4488 seconds
显存占用: 3168.58 MB, 已预留显存: 3722.00 MB
dealing with 61
[06:09:53] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  97%|█████████▋| 62/64 [1:43:48<11:21, 340.80s/it][A[ASelf.trainer.train duration: 540.7009 seconds
显存占用: 3509.67 MB, 已预留显存: 4072.00 MB
dealing with 62
[06:20:53] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  98%|█████████▊| 63/64 [1:54:51<06:40, 400.85s/it][A[ASelf.trainer.train duration: 539.5239 seconds
显存占用: 3851.13 MB, 已预留显存: 4484.00 MB
dealing with 63
[06:31:57] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint: 100%|██████████| 64/64 [2:06:13<00:00, 459.70s/it][A[Aviewpoint: 100%|██████████| 64/64 [2:06:13<00:00, 118.33s/it]

Processing Models in pillow:   2%|▏         | 2/96 [2:06:50<99:21:56, 3805.50s/model][A/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tyro/_fields.py:1066: UserWarning: Mutable type <class 'config.EnvConfig'> is used as a default value for `env`. This is dangerous! Consider using `dataclasses.field(default_factory=...)` or marking <class 'config.EnvConfig'> as frozen.
  warnings.warn(
Self.trainer.train duration: 545.5595 seconds
显存占用: 4194.82 MB, 已预留显存: 4794.00 MB
pillow:/attached/data/remote-home2/zzq/data/shapenet/ShapeNetCore.v2/03938244/f06843cc11cfe791cbcb2c721c3564d4


CUDA
Generating data for init
saving data to data/shapenet/init/transforms.json
[06:43:37] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Found 64 GT images, loading directly from /remote-home/zzq/data/ShapeNet/gt_shapenet/pillow/f06843cc11cfe791cbcb2c721c3564d4
Loaded 64 GT images successfully!


viewpoint:   0%|          | 0/64 [00:00<?, ?it/s][A[Adealing with 0
[06:43:43] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:   2%|▏         | 1/64 [11:31<12:06:29, 691.90s/it][A[ASelf.trainer.train duration: 571.2355 seconds
显存占用: 4756.27 MB, 已预留显存: 5298.00 MB
dealing with 1
[06:55:15] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:   3%|▎         | 2/64 [23:18<12:03:43, 700.39s/it][A[ASelf.trainer.train duration: 570.0418 seconds
显存占用: 5098.47 MB, 已预留显存: 5740.00 MB
dealing with 2
[07:07:01] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:   5%|▍         | 3/64 [35:04<11:54:44, 703.03s/it][A[ASelf.trainer.train duration: 573.7508 seconds
显存占用: 5440.76 MB, 已预留显存: 6014.00 MB
dealing with 3
[07:18:47] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:   6%|▋         | 4/64 [45:48<11:19:56, 679.94s/it][A[ASelf.trainer.train duration: 522.9388 seconds
显存占用: 5781.33 MB, 已预留显存: 6340.00 MB
dealing with 4
[07:29:32] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:   8%|▊         | 5/64 [56:41<10:58:45, 669.93s/it][A[ASelf.trainer.train duration: 533.5987 seconds
显存占用: 6122.41 MB, 已预留显存: 6698.00 MB
dealing with 5
[07:40:24] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:   9%|▉         | 6/64 [1:07:33<10:41:59, 664.13s/it][A[ASelf.trainer.train duration: 537.4098 seconds
显存占用: 6463.64 MB, 已预留显存: 7010.00 MB
dealing with 6
[07:51:17] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  11%|█         | 7/64 [1:18:35<10:30:09, 663.33s/it][A[ASelf.trainer.train duration: 544.7222 seconds
显存占用: 6805.54 MB, 已预留显存: 7390.00 MB
dealing with 7
[08:02:18] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  12%|█▎        | 8/64 [1:30:05<10:27:07, 671.92s/it][A[ASelf.trainer.train duration: 553.1022 seconds
显存占用: 7146.88 MB, 已预留显存: 7716.00 MB
dealing with 8
[08:13:49] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
System is out of GPU memory

Refer to the Cycles GPU rendering documentation for possible solutions:
https://docs.blender.org/manual/en/latest/render/cycles/gpu_rendering.html

System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
viewpoint:  12%|█▎        | 8/64 [1:30:10<10:31:12, 676.29s/it]

                                                                                     [AProcessing Categories:   0%|          | 0/55 [3:37:25<?, ?category/s]
Traceback (most recent call last):
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 240, in <module>
    distribution_dataset_construction(model_path, num_azimuth, num_elevation, radius, start_viewpoint_index, viewpoint_index_interval)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 160, in distribution_dataset_construction
    env.reset()
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_env.py", line 117, in reset
    np_images, transforms = self.get_images(mode='init')
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_env.py", line 129, in get_images
    return self.gen_data(mode, return_quat=return_quat)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_env.py", line 150, in gen_data
    image = self.scene.render_pose(pose)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_scene.py", line 215, in render_pose
    result = self.render() #
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_scene.py", line 566, in render
    return super().render()
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_scene.py", line 422, in render
    result = bpycv.render_data()
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/bpycv/render_utils.py", line 115, in render_data
    render_result["image"] = _render_image()
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/bpycv/render_utils.py", line 94, in render_image
    bpy.ops.render.render(write_still=True)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/bpy/3.6/scripts/modules/bpy/ops.py", line 113, in __call__
    ret = _op_call(self.idname_py(), None, kw)
RuntimeError: Error: System is out of GPU memory
Error: System is out of GPU memory

Iteration 9 completed

Iteration 10/30
Processing Categories:   0%|          | 0/55 [00:00<?, ?category/s]
Processing Models in pillow:   0%|          | 0/96 [00:00<?, ?model/s][A/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tyro/_fields.py:1066: UserWarning: Mutable type <class 'config.EnvConfig'> is used as a default value for `env`. This is dangerous! Consider using `dataclasses.field(default_factory=...)` or marking <class 'config.EnvConfig'> as frozen.
  warnings.warn(
pillow:/attached/data/remote-home2/zzq/data/shapenet/ShapeNetCore.v2/03938244/f06843cc11cfe791cbcb2c721c3564d4


CUDA
Generating data for init
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/boxx/ylcompat.py:69: BoxxWarning: warning from boxx
    os.environ["DISPLAY"] is not found
    plt.show() are redirect to plt.savefig(tmp)
    function: show, loga, crun, heatmap, plot will be affected
  def __setDisplayEnv():
saving data to data/shapenet/init/transforms.json
[08:15:45] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Found 64 GT images, loading directly from /remote-home/zzq/data/ShapeNet/gt_shapenet/pillow/f06843cc11cfe791cbcb2c721c3564d4
Loaded 64 GT images successfully!


viewpoint:   0%|          | 0/64 [00:00<?, ?it/s][A[Adealing with 8
[08:15:53] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:70: FutureWarning: Importing `spectral_angle_mapper` from `torchmetrics.functional` was deprecated and will be removed in 2.0. Import `spectral_angle_mapper` from `torchmetrics.image` instead.
  _future_warning(


viewpoint:  14%|█▍        | 9/64 [11:21<1:09:27, 75.77s/it][A[ASelf.trainer.train duration: 572.8511 seconds
显存占用: 776.21 MB, 已预留显存: 1154.00 MB
dealing with 9
[08:27:15] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  16%|█▌        | 10/64 [22:33<2:21:37, 157.37s/it][A[ASelf.trainer.train duration: 528.4221 seconds
显存占用: 1118.58 MB, 已预留显存: 1534.00 MB
dealing with 10
[08:38:26] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  17%|█▋        | 11/64 [33:43<3:33:06, 241.26s/it][A[ASelf.trainer.train duration: 547.5539 seconds
显存占用: 1458.63 MB, 已预留显存: 1836.00 MB
dealing with 11
[08:49:36] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  19%|█▉        | 12/64 [44:37<4:36:55, 319.53s/it][A[ASelf.trainer.train duration: 537.3592 seconds
显存占用: 1800.48 MB, 已预留显存: 2168.00 MB
dealing with 12
[09:00:31] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  20%|██        | 13/64 [55:48<5:35:08, 394.29s/it][A[ASelf.trainer.train duration: 550.1411 seconds
显存占用: 2143.19 MB, 已预留显存: 2612.00 MB
dealing with 13
[09:11:41] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  22%|██▏       | 14/64 [1:07:07<6:24:05, 460.92s/it][A[ASelf.trainer.train duration: 561.1955 seconds
显存占用: 2482.67 MB, 已预留显存: 2860.00 MB
dealing with 14
[09:23:01] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  23%|██▎       | 15/64 [1:18:39<7:03:32, 518.63s/it][A[ASelf.trainer.train duration: 568.4359 seconds
显存占用: 2824.98 MB, 已预留显存: 3248.00 MB
dealing with 15
[09:34:33] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  25%|██▌       | 16/64 [1:30:05<7:30:06, 562.63s/it][A[ASelf.trainer.train duration: 550.3304 seconds
显存占用: 3165.99 MB, 已预留显存: 3524.00 MB
dealing with 16
[09:45:58] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  27%|██▋       | 17/64 [1:41:13<7:43:14, 591.38s/it][A[ASelf.trainer.train duration: 542.9783 seconds
显存占用: 3507.00 MB, 已预留显存: 3972.00 MB
dealing with 17
[09:57:06] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  28%|██▊       | 18/64 [1:52:11<7:47:47, 610.16s/it][A[ASelf.trainer.train duration: 534.9381 seconds
显存占用: 3849.16 MB, 已预留显存: 4354.00 MB
dealing with 18
[10:08:05] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  30%|██▉       | 19/64 [2:03:34<7:53:14, 630.99s/it][A[ASelf.trainer.train duration: 562.9782 seconds
显存占用: 4192.25 MB, 已预留显存: 4648.00 MB
dealing with 19
[10:19:28] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  31%|███▏      | 20/64 [2:14:58<7:54:01, 646.39s/it][A[ASelf.trainer.train duration: 552.4977 seconds
显存占用: 4534.63 MB, 已预留显存: 4912.00 MB
dealing with 20
[10:30:52] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  33%|███▎      | 21/64 [2:26:44<7:55:47, 663.91s/it][A[ASelf.trainer.train duration: 582.7763 seconds
显存占用: 4877.54 MB, 已预留显存: 5318.00 MB
dealing with 21
[10:42:38] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  34%|███▍      | 22/64 [2:38:16<7:50:34, 672.25s/it][A[ASelf.trainer.train duration: 547.4119 seconds
显存占用: 5220.65 MB, 已预留显存: 5696.00 MB
dealing with 22
[10:54:10] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  36%|███▌      | 23/64 [2:49:06<7:34:43, 665.44s/it][A[ASelf.trainer.train duration: 521.0414 seconds
显存占用: 5563.06 MB, 已预留显存: 6072.00 MB
dealing with 23
[11:04:59] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  38%|███▊      | 24/64 [3:00:09<7:23:17, 664.93s/it][A[ASelf.trainer.train duration: 552.9262 seconds
显存占用: 5904.10 MB, 已预留显存: 6488.00 MB
dealing with 24
[11:16:03] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json
viewpoint:  38%|███▊      | 24/64 [3:02:11<5:03:39, 455.48s/it]

                                                                      [AProcessing Categories:   0%|          | 0/55 [3:02:37<?, ?category/s]
Traceback (most recent call last):
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 240, in <module>
    distribution_dataset_construction(model_path, num_azimuth, num_elevation, radius, start_viewpoint_index, viewpoint_index_interval)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 164, in distribution_dataset_construction
    NeRF_pipeline.add_image(images=obs,poses=input_pose,model_option=None)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nvf/active_mapping/active_mapping.py", line 233, in add_image
    self.trainer.train()
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nvf/nerfstudio_interface/nbv_trainer.py", line 213, in train
    loss, loss_dict, metrics_dict = self.train_iteration(step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/utils/profiler.py", line 127, in inner
    out = func(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/engine/trainer.py", line 740, in train_iteration
    _, loss_dict, metrics_dict = self.pipeline.get_train_loss_dict(step=step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/pipelines/dynamic_batch.py", line 91, in get_train_loss_dict
    model_outputs, loss_dict, metrics_dict = super().get_train_loss_dict(step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/utils/profiler.py", line 127, in inner
    out = func(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/pipelines/base_pipeline.py", line 284, in get_train_loss_dict
    model_outputs = self._model(ray_bundle)  # train distributed data parallel model if world_size > 1
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/models/base_model.py", line 142, in forward
    return self.get_outputs(ray_bundle)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/models/instant_ngp.py", line 302, in get_outputs
    ray_samples, ray_indices = self.sampler(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/model_components/ray_samplers.py", line 482, in forward
    ray_indices, starts, ends = self.occupancy_grid.sampling(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/nerfacc/estimators/occ_grid.py", line 192, in sampling
    sigmas = sigma_fn(t_starts, t_ends, ray_indices)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/model_components/ray_samplers.py", line 428, in sigma_fn
    return density_fn(positions).squeeze(-1)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/fields/base_field.py", line 67, in density_fn
    density, _ = self.get_density(ray_samples)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/fields/nerfacto_field.py", line 252, in get_density
    h = self.mlp_base(positions_flat).view(*ray_samples.frustums.shape, -1)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/field_components/mlp.py", line 177, in forward
    return self.tcnn_encoding(in_tensor)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tinycudann/modules.py", line 190, in forward
    output = _module_function.apply(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/autograd/function.py", line 506, in apply
    return super().apply(*args, **kwargs)  # type: ignore[misc]
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tinycudann/modules.py", line 102, in forward
    native_ctx, output = native_tcnn_module.fwd(input, params)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 166.00 MiB (GPU 0; 23.68 GiB total capacity; 7.90 GiB already allocated; 161.75 MiB free; 8.10 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
Iteration 10 completed

Iteration 11/30
Processing Categories:   0%|          | 0/55 [00:00<?, ?category/s]
Processing Models in pillow:   0%|          | 0/96 [00:00<?, ?model/s][A/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tyro/_fields.py:1066: UserWarning: Mutable type <class 'config.EnvConfig'> is used as a default value for `env`. This is dangerous! Consider using `dataclasses.field(default_factory=...)` or marking <class 'config.EnvConfig'> as frozen.
  warnings.warn(
pillow:/attached/data/remote-home2/zzq/data/shapenet/ShapeNetCore.v2/03938244/f06843cc11cfe791cbcb2c721c3564d4


CUDA
Generating data for init
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/boxx/ylcompat.py:69: BoxxWarning: warning from boxx
    os.environ["DISPLAY"] is not found
    plt.show() are redirect to plt.savefig(tmp)
    function: show, loga, crun, heatmap, plot will be affected
  def __setDisplayEnv():
saving data to data/shapenet/init/transforms.json
[11:20:09] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Found 64 GT images, loading directly from /remote-home/zzq/data/ShapeNet/gt_shapenet/pillow/f06843cc11cfe791cbcb2c721c3564d4
Loaded 64 GT images successfully!


viewpoint:   0%|          | 0/64 [00:00<?, ?it/s][A[Adealing with 24
[11:20:17] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:70: FutureWarning: Importing `spectral_angle_mapper` from `torchmetrics.functional` was deprecated and will be removed in 2.0. Import `spectral_angle_mapper` from `torchmetrics.image` instead.
  _future_warning(


viewpoint:  39%|███▉      | 25/64 [12:17<19:10, 29.50s/it][A[ASelf.trainer.train duration: 638.3283 seconds
显存占用: 777.78 MB, 已预留显存: 1128.00 MB
dealing with 25
[11:32:35] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  41%|████      | 26/64 [25:01<43:50, 69.22s/it][A[ASelf.trainer.train duration: 639.9585 seconds
显存占用: 1119.91 MB, 已预留显存: 1516.00 MB
dealing with 26
[11:45:19] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  42%|████▏     | 27/64 [38:19<1:14:53, 121.44s/it][A[ASelf.trainer.train duration: 682.9607 seconds
显存占用: 1462.27 MB, 已预留显存: 1888.00 MB
dealing with 27
[11:58:37] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  44%|████▍     | 28/64 [51:19<1:49:32, 182.58s/it][A[ASelf.trainer.train duration: 660.2019 seconds
显存占用: 1803.46 MB, 已预留显存: 2300.00 MB
dealing with 28
[12:11:36] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  45%|████▌     | 29/64 [1:04:14<2:27:01, 252.05s/it][A[ASelf.trainer.train duration: 622.2257 seconds
显存占用: 2144.79 MB, 已预留显存: 2714.00 MB
dealing with 29
[12:24:32] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  47%|████▋     | 30/64 [1:15:42<2:58:12, 314.50s/it][A[ASelf.trainer.train duration: 563.8733 seconds
显存占用: 2485.97 MB, 已预留显存: 2932.00 MB
dealing with 30
[12:35:59] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json
viewpoint:  47%|████▋     | 30/64 [1:17:15<1:27:33, 154.53s/it]

                                                                      [AProcessing Categories:   0%|          | 0/55 [1:17:51<?, ?category/s]
Traceback (most recent call last):
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 240, in <module>
    distribution_dataset_construction(model_path, num_azimuth, num_elevation, radius, start_viewpoint_index, viewpoint_index_interval)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 164, in distribution_dataset_construction
    NeRF_pipeline.add_image(images=obs,poses=input_pose,model_option=None)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nvf/active_mapping/active_mapping.py", line 233, in add_image
    self.trainer.train()
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nvf/nerfstudio_interface/nbv_trainer.py", line 213, in train
    loss, loss_dict, metrics_dict = self.train_iteration(step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/utils/profiler.py", line 127, in inner
    out = func(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/engine/trainer.py", line 740, in train_iteration
    _, loss_dict, metrics_dict = self.pipeline.get_train_loss_dict(step=step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/pipelines/dynamic_batch.py", line 91, in get_train_loss_dict
    model_outputs, loss_dict, metrics_dict = super().get_train_loss_dict(step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/utils/profiler.py", line 127, in inner
    out = func(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/pipelines/base_pipeline.py", line 284, in get_train_loss_dict
    model_outputs = self._model(ray_bundle)  # train distributed data parallel model if world_size > 1
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/models/base_model.py", line 142, in forward
    return self.get_outputs(ray_bundle)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/models/instant_ngp.py", line 302, in get_outputs
    ray_samples, ray_indices = self.sampler(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/model_components/ray_samplers.py", line 482, in forward
    ray_indices, starts, ends = self.occupancy_grid.sampling(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/nerfacc/estimators/occ_grid.py", line 192, in sampling
    sigmas = sigma_fn(t_starts, t_ends, ray_indices)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/model_components/ray_samplers.py", line 428, in sigma_fn
    return density_fn(positions).squeeze(-1)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/fields/base_field.py", line 67, in density_fn
    density, _ = self.get_density(ray_samples)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/fields/nerfacto_field.py", line 252, in get_density
    h = self.mlp_base(positions_flat).view(*ray_samples.frustums.shape, -1)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/field_components/mlp.py", line 177, in forward
    return self.tcnn_encoding(in_tensor)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tinycudann/modules.py", line 190, in forward
    output = _module_function.apply(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/autograd/function.py", line 506, in apply
    return super().apply(*args, **kwargs)  # type: ignore[misc]
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tinycudann/modules.py", line 102, in forward
    native_ctx, output = native_tcnn_module.fwd(input, params)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 276.00 MiB (GPU 0; 23.68 GiB total capacity; 5.79 GiB already allocated; 223.75 MiB free; 6.08 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
Iteration 11 completed

Iteration 12/30
Processing Categories:   0%|          | 0/55 [00:00<?, ?category/s]
Processing Models in pillow:   0%|          | 0/96 [00:00<?, ?model/s][A/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tyro/_fields.py:1066: UserWarning: Mutable type <class 'config.EnvConfig'> is used as a default value for `env`. This is dangerous! Consider using `dataclasses.field(default_factory=...)` or marking <class 'config.EnvConfig'> as frozen.
  warnings.warn(
pillow:/attached/data/remote-home2/zzq/data/shapenet/ShapeNetCore.v2/03938244/f06843cc11cfe791cbcb2c721c3564d4


CUDA
Generating data for init
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/boxx/ylcompat.py:69: BoxxWarning: warning from boxx
    os.environ["DISPLAY"] is not found
    plt.show() are redirect to plt.savefig(tmp)
    function: show, loga, crun, heatmap, plot will be affected
  def __setDisplayEnv():
saving data to data/shapenet/init/transforms.json
[12:39:27] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Found 64 GT images, loading directly from /remote-home/zzq/data/ShapeNet/gt_shapenet/pillow/f06843cc11cfe791cbcb2c721c3564d4
Loaded 64 GT images successfully!


viewpoint:   0%|          | 0/64 [00:00<?, ?it/s][A[Adealing with 30
[12:39:36] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json
viewpoint:  47%|████▋     | 30/64 [01:18<01:28,  2.60s/it]

                                                                      [AProcessing Categories:   0%|          | 0/55 [01:50<?, ?category/s]
Traceback (most recent call last):
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 240, in <module>
    distribution_dataset_construction(model_path, num_azimuth, num_elevation, radius, start_viewpoint_index, viewpoint_index_interval)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 164, in distribution_dataset_construction
    NeRF_pipeline.add_image(images=obs,poses=input_pose,model_option=None)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nvf/active_mapping/active_mapping.py", line 233, in add_image
    self.trainer.train()
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nvf/nerfstudio_interface/nbv_trainer.py", line 213, in train
    loss, loss_dict, metrics_dict = self.train_iteration(step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/utils/profiler.py", line 127, in inner
    out = func(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/engine/trainer.py", line 740, in train_iteration
    _, loss_dict, metrics_dict = self.pipeline.get_train_loss_dict(step=step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/pipelines/dynamic_batch.py", line 91, in get_train_loss_dict
    model_outputs, loss_dict, metrics_dict = super().get_train_loss_dict(step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/utils/profiler.py", line 127, in inner
    out = func(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/pipelines/base_pipeline.py", line 284, in get_train_loss_dict
    model_outputs = self._model(ray_bundle)  # train distributed data parallel model if world_size > 1
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/models/base_model.py", line 142, in forward
    return self.get_outputs(ray_bundle)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/models/instant_ngp.py", line 302, in get_outputs
    ray_samples, ray_indices = self.sampler(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/model_components/ray_samplers.py", line 482, in forward
    ray_indices, starts, ends = self.occupancy_grid.sampling(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/nerfacc/estimators/occ_grid.py", line 192, in sampling
    sigmas = sigma_fn(t_starts, t_ends, ray_indices)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/model_components/ray_samplers.py", line 428, in sigma_fn
    return density_fn(positions).squeeze(-1)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/fields/base_field.py", line 67, in density_fn
    density, _ = self.get_density(ray_samples)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/fields/nerfacto_field.py", line 252, in get_density
    h = self.mlp_base(positions_flat).view(*ray_samples.frustums.shape, -1)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/field_components/mlp.py", line 177, in forward
    return self.tcnn_encoding(in_tensor)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tinycudann/modules.py", line 192, in forward
    x_padded.to(torch.float).contiguous(),
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 1.58 GiB (GPU 0; 23.68 GiB total capacity; 3.67 GiB already allocated; 1.34 GiB free; 3.86 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
Iteration 12 completed

Iteration 13/30
Processing Categories:   0%|          | 0/55 [00:00<?, ?category/s]
Processing Models in pillow:   0%|          | 0/96 [00:00<?, ?model/s][A/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tyro/_fields.py:1066: UserWarning: Mutable type <class 'config.EnvConfig'> is used as a default value for `env`. This is dangerous! Consider using `dataclasses.field(default_factory=...)` or marking <class 'config.EnvConfig'> as frozen.
  warnings.warn(
pillow:/attached/data/remote-home2/zzq/data/shapenet/ShapeNetCore.v2/03938244/f06843cc11cfe791cbcb2c721c3564d4


CUDA
Generating data for init
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/boxx/ylcompat.py:69: BoxxWarning: warning from boxx
    os.environ["DISPLAY"] is not found
    plt.show() are redirect to plt.savefig(tmp)
    function: show, loga, crun, heatmap, plot will be affected
  def __setDisplayEnv():
saving data to data/shapenet/init/transforms.json
[12:42:37] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Found 64 GT images, loading directly from /remote-home/zzq/data/ShapeNet/gt_shapenet/pillow/f06843cc11cfe791cbcb2c721c3564d4
Loaded 64 GT images successfully!


viewpoint:   0%|          | 0/64 [00:00<?, ?it/s][A[Adealing with 30
[12:42:46] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:70: FutureWarning: Importing `spectral_angle_mapper` from `torchmetrics.functional` was deprecated and will be removed in 2.0. Import `spectral_angle_mapper` from `torchmetrics.image` instead.
  _future_warning(


viewpoint:  48%|████▊     | 31/64 [12:04<12:51, 23.39s/it][A[ASelf.trainer.train duration: 592.2762 seconds
显存占用: 778.37 MB, 已预留显存: 1178.00 MB
dealing with 31
[12:54:51] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  50%|█████     | 32/64 [23:35<28:08, 52.78s/it][A[ASelf.trainer.train duration: 584.6049 seconds
显存占用: 1121.66 MB, 已预留显存: 1632.00 MB
dealing with 32
[13:06:22] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  52%|█████▏    | 33/64 [34:54<46:25, 89.87s/it][A[ASelf.trainer.train duration: 562.8460 seconds
显存占用: 1459.44 MB, 已预留显存: 1888.00 MB
dealing with 33
[13:17:41] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json
viewpoint:  52%|█████▏    | 33/64 [36:25<34:12, 66.22s/it]

                                                                      [AProcessing Categories:   0%|          | 0/55 [36:52<?, ?category/s]
Traceback (most recent call last):
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 240, in <module>
    distribution_dataset_construction(model_path, num_azimuth, num_elevation, radius, start_viewpoint_index, viewpoint_index_interval)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 164, in distribution_dataset_construction
    NeRF_pipeline.add_image(images=obs,poses=input_pose,model_option=None)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nvf/active_mapping/active_mapping.py", line 233, in add_image
    self.trainer.train()
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nvf/nerfstudio_interface/nbv_trainer.py", line 213, in train
    loss, loss_dict, metrics_dict = self.train_iteration(step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/utils/profiler.py", line 127, in inner
    out = func(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/engine/trainer.py", line 740, in train_iteration
    _, loss_dict, metrics_dict = self.pipeline.get_train_loss_dict(step=step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/pipelines/dynamic_batch.py", line 91, in get_train_loss_dict
    model_outputs, loss_dict, metrics_dict = super().get_train_loss_dict(step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/utils/profiler.py", line 127, in inner
    out = func(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/pipelines/base_pipeline.py", line 284, in get_train_loss_dict
    model_outputs = self._model(ray_bundle)  # train distributed data parallel model if world_size > 1
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/models/base_model.py", line 142, in forward
    return self.get_outputs(ray_bundle)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/models/instant_ngp.py", line 302, in get_outputs
    ray_samples, ray_indices = self.sampler(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/model_components/ray_samplers.py", line 482, in forward
    ray_indices, starts, ends = self.occupancy_grid.sampling(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/nerfacc/estimators/occ_grid.py", line 192, in sampling
    sigmas = sigma_fn(t_starts, t_ends, ray_indices)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/model_components/ray_samplers.py", line 428, in sigma_fn
    return density_fn(positions).squeeze(-1)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/fields/base_field.py", line 67, in density_fn
    density, _ = self.get_density(ray_samples)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/fields/nerfacto_field.py", line 252, in get_density
    h = self.mlp_base(positions_flat).view(*ray_samples.frustums.shape, -1)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/field_components/mlp.py", line 177, in forward
    return self.tcnn_encoding(in_tensor)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tinycudann/modules.py", line 190, in forward
    output = _module_function.apply(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/autograd/function.py", line 506, in apply
    return super().apply(*args, **kwargs)  # type: ignore[misc]
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tinycudann/modules.py", line 102, in forward
    native_ctx, output = native_tcnn_module.fwd(input, params)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 338.00 MiB (GPU 0; 23.68 GiB total capacity; 5.50 GiB already allocated; 87.75 MiB free; 5.65 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
Iteration 13 completed

Iteration 14/30
Processing Categories:   0%|          | 0/55 [00:00<?, ?category/s]
Processing Models in pillow:   0%|          | 0/96 [00:00<?, ?model/s][A/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tyro/_fields.py:1066: UserWarning: Mutable type <class 'config.EnvConfig'> is used as a default value for `env`. This is dangerous! Consider using `dataclasses.field(default_factory=...)` or marking <class 'config.EnvConfig'> as frozen.
  warnings.warn(
pillow:/attached/data/remote-home2/zzq/data/shapenet/ShapeNetCore.v2/03938244/f06843cc11cfe791cbcb2c721c3564d4


CUDA
Generating data for init
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/boxx/ylcompat.py:69: BoxxWarning: warning from boxx
    os.environ["DISPLAY"] is not found
    plt.show() are redirect to plt.savefig(tmp)
    function: show, loga, crun, heatmap, plot will be affected
  def __setDisplayEnv():
saving data to data/shapenet/init/transforms.json
[13:20:56] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Found 64 GT images, loading directly from /remote-home/zzq/data/ShapeNet/gt_shapenet/pillow/f06843cc11cfe791cbcb2c721c3564d4
Loaded 64 GT images successfully!


viewpoint:   0%|          | 0/64 [00:00<?, ?it/s][A[Adealing with 33
[13:21:04] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:70: FutureWarning: Importing `spectral_angle_mapper` from `torchmetrics.functional` was deprecated and will be removed in 2.0. Import `spectral_angle_mapper` from `torchmetrics.image` instead.
  _future_warning(


viewpoint:  53%|█████▎    | 34/64 [12:34<11:05, 22.20s/it][A[ASelf.trainer.train duration: 673.0214 seconds
显存占用: 780.52 MB, 已预留显存: 1252.00 MB
dealing with 34
[13:33:39] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json
viewpoint:  53%|█████▎    | 34/64 [13:41<12:05, 24.17s/it]

                                                                      [AProcessing Categories:   0%|          | 0/55 [14:09<?, ?category/s]
Traceback (most recent call last):
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 240, in <module>
    distribution_dataset_construction(model_path, num_azimuth, num_elevation, radius, start_viewpoint_index, viewpoint_index_interval)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 164, in distribution_dataset_construction
    NeRF_pipeline.add_image(images=obs,poses=input_pose,model_option=None)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nvf/active_mapping/active_mapping.py", line 233, in add_image
    self.trainer.train()
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nvf/nerfstudio_interface/nbv_trainer.py", line 213, in train
    loss, loss_dict, metrics_dict = self.train_iteration(step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/utils/profiler.py", line 127, in inner
    out = func(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/engine/trainer.py", line 740, in train_iteration
    _, loss_dict, metrics_dict = self.pipeline.get_train_loss_dict(step=step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/pipelines/dynamic_batch.py", line 91, in get_train_loss_dict
    model_outputs, loss_dict, metrics_dict = super().get_train_loss_dict(step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/utils/profiler.py", line 127, in inner
    out = func(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/pipelines/base_pipeline.py", line 284, in get_train_loss_dict
    model_outputs = self._model(ray_bundle)  # train distributed data parallel model if world_size > 1
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/models/base_model.py", line 142, in forward
    return self.get_outputs(ray_bundle)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/models/instant_ngp.py", line 302, in get_outputs
    ray_samples, ray_indices = self.sampler(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/model_components/ray_samplers.py", line 482, in forward
    ray_indices, starts, ends = self.occupancy_grid.sampling(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/nerfacc/estimators/occ_grid.py", line 192, in sampling
    sigmas = sigma_fn(t_starts, t_ends, ray_indices)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/model_components/ray_samplers.py", line 428, in sigma_fn
    return density_fn(positions).squeeze(-1)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/fields/base_field.py", line 67, in density_fn
    density, _ = self.get_density(ray_samples)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/fields/nerfacto_field.py", line 252, in get_density
    h = self.mlp_base(positions_flat).view(*ray_samples.frustums.shape, -1)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/field_components/mlp.py", line 177, in forward
    return self.tcnn_encoding(in_tensor)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tinycudann/modules.py", line 190, in forward
    output = _module_function.apply(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/autograd/function.py", line 506, in apply
    return super().apply(*args, **kwargs)  # type: ignore[misc]
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tinycudann/modules.py", line 102, in forward
    native_ctx, output = native_tcnn_module.fwd(input, params)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 382.00 MiB (GPU 0; 23.68 GiB total capacity; 5.30 GiB already allocated; 321.75 MiB free; 5.44 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
Iteration 14 completed

Iteration 15/30
Processing Categories:   0%|          | 0/55 [00:00<?, ?category/s]
Processing Models in pillow:   0%|          | 0/96 [00:00<?, ?model/s][A/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tyro/_fields.py:1066: UserWarning: Mutable type <class 'config.EnvConfig'> is used as a default value for `env`. This is dangerous! Consider using `dataclasses.field(default_factory=...)` or marking <class 'config.EnvConfig'> as frozen.
  warnings.warn(
pillow:/attached/data/remote-home2/zzq/data/shapenet/ShapeNetCore.v2/03938244/f06843cc11cfe791cbcb2c721c3564d4


CUDA
Generating data for init
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/boxx/ylcompat.py:69: BoxxWarning: warning from boxx
    os.environ["DISPLAY"] is not found
    plt.show() are redirect to plt.savefig(tmp)
    function: show, loga, crun, heatmap, plot will be affected
  def __setDisplayEnv():
saving data to data/shapenet/init/transforms.json
[13:36:31] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Found 64 GT images, loading directly from /remote-home/zzq/data/ShapeNet/gt_shapenet/pillow/f06843cc11cfe791cbcb2c721c3564d4
Loaded 64 GT images successfully!


viewpoint:   0%|          | 0/64 [00:00<?, ?it/s][A[Adealing with 34
[13:36:40] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json
viewpoint:  53%|█████▎    | 34/64 [01:39<01:27,  2.92s/it]

                                                                      [AProcessing Categories:   0%|          | 0/55 [02:06<?, ?category/s]
Traceback (most recent call last):
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 240, in <module>
    distribution_dataset_construction(model_path, num_azimuth, num_elevation, radius, start_viewpoint_index, viewpoint_index_interval)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 164, in distribution_dataset_construction
    NeRF_pipeline.add_image(images=obs,poses=input_pose,model_option=None)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nvf/active_mapping/active_mapping.py", line 233, in add_image
    self.trainer.train()
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nvf/nerfstudio_interface/nbv_trainer.py", line 213, in train
    loss, loss_dict, metrics_dict = self.train_iteration(step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/utils/profiler.py", line 127, in inner
    out = func(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/engine/trainer.py", line 740, in train_iteration
    _, loss_dict, metrics_dict = self.pipeline.get_train_loss_dict(step=step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/pipelines/dynamic_batch.py", line 91, in get_train_loss_dict
    model_outputs, loss_dict, metrics_dict = super().get_train_loss_dict(step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/utils/profiler.py", line 127, in inner
    out = func(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/pipelines/base_pipeline.py", line 284, in get_train_loss_dict
    model_outputs = self._model(ray_bundle)  # train distributed data parallel model if world_size > 1
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/models/base_model.py", line 142, in forward
    return self.get_outputs(ray_bundle)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/models/instant_ngp.py", line 302, in get_outputs
    ray_samples, ray_indices = self.sampler(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/model_components/ray_samplers.py", line 482, in forward
    ray_indices, starts, ends = self.occupancy_grid.sampling(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/nerfacc/estimators/occ_grid.py", line 192, in sampling
    sigmas = sigma_fn(t_starts, t_ends, ray_indices)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/model_components/ray_samplers.py", line 428, in sigma_fn
    return density_fn(positions).squeeze(-1)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/fields/base_field.py", line 67, in density_fn
    density, _ = self.get_density(ray_samples)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/fields/nerfacto_field.py", line 252, in get_density
    h = self.mlp_base(positions_flat).view(*ray_samples.frustums.shape, -1)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/field_components/mlp.py", line 177, in forward
    return self.tcnn_encoding(in_tensor)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tinycudann/modules.py", line 190, in forward
    output = _module_function.apply(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/autograd/function.py", line 506, in apply
    return super().apply(*args, **kwargs)  # type: ignore[misc]
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tinycudann/modules.py", line 102, in forward
    native_ctx, output = native_tcnn_module.fwd(input, params)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 666.00 MiB (GPU 0; 23.68 GiB total capacity; 8.16 GiB already allocated; 563.75 MiB free; 8.46 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
Iteration 15 completed

Iteration 16/30
Processing Categories:   0%|          | 0/55 [00:00<?, ?category/s]
Processing Models in pillow:   0%|          | 0/96 [00:00<?, ?model/s][A/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tyro/_fields.py:1066: UserWarning: Mutable type <class 'config.EnvConfig'> is used as a default value for `env`. This is dangerous! Consider using `dataclasses.field(default_factory=...)` or marking <class 'config.EnvConfig'> as frozen.
  warnings.warn(
pillow:/attached/data/remote-home2/zzq/data/shapenet/ShapeNetCore.v2/03938244/f06843cc11cfe791cbcb2c721c3564d4


CUDA
Generating data for init
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/boxx/ylcompat.py:69: BoxxWarning: warning from boxx
    os.environ["DISPLAY"] is not found
    plt.show() are redirect to plt.savefig(tmp)
    function: show, loga, crun, heatmap, plot will be affected
  def __setDisplayEnv():
saving data to data/shapenet/init/transforms.json
[13:40:05] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Found 64 GT images, loading directly from /remote-home/zzq/data/ShapeNet/gt_shapenet/pillow/f06843cc11cfe791cbcb2c721c3564d4
Loaded 64 GT images successfully!


viewpoint:   0%|          | 0/64 [00:00<?, ?it/s][A[Adealing with 34
[13:40:14] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:70: FutureWarning: Importing `spectral_angle_mapper` from `torchmetrics.functional` was deprecated and will be removed in 2.0. Import `spectral_angle_mapper` from `torchmetrics.image` instead.
  _future_warning(


viewpoint:  55%|█████▍    | 35/64 [13:18<11:01, 22.82s/it][A[ASelf.trainer.train duration: 685.7524 seconds
显存占用: 779.88 MB, 已预留显存: 1178.00 MB
dealing with 35
[13:53:33] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  56%|█████▋    | 36/64 [24:41<22:43, 48.69s/it][A[ASelf.trainer.train duration: 564.2763 seconds
显存占用: 1119.12 MB, 已预留显存: 1630.00 MB
dealing with 36
[14:04:55] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  58%|█████▊    | 37/64 [35:54<36:48, 81.80s/it][A[ASelf.trainer.train duration: 553.9953 seconds
显存占用: 1461.42 MB, 已预留显存: 1876.00 MB
dealing with 37
[14:16:08] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  59%|█████▉    | 38/64 [48:10<55:25, 127.89s/it][A[ASelf.trainer.train duration: 612.7848 seconds
显存占用: 1804.24 MB, 已预留显存: 2344.00 MB
dealing with 38
[14:28:24] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json
viewpoint:  59%|█████▉    | 38/64 [49:21<33:46, 77.93s/it] 

                                                                      [AProcessing Categories:   0%|          | 0/55 [49:50<?, ?category/s]
Traceback (most recent call last):
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 240, in <module>
    distribution_dataset_construction(model_path, num_azimuth, num_elevation, radius, start_viewpoint_index, viewpoint_index_interval)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 164, in distribution_dataset_construction
    NeRF_pipeline.add_image(images=obs,poses=input_pose,model_option=None)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nvf/active_mapping/active_mapping.py", line 233, in add_image
    self.trainer.train()
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nvf/nerfstudio_interface/nbv_trainer.py", line 213, in train
    loss, loss_dict, metrics_dict = self.train_iteration(step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/utils/profiler.py", line 127, in inner
    out = func(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/engine/trainer.py", line 740, in train_iteration
    _, loss_dict, metrics_dict = self.pipeline.get_train_loss_dict(step=step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/pipelines/dynamic_batch.py", line 91, in get_train_loss_dict
    model_outputs, loss_dict, metrics_dict = super().get_train_loss_dict(step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/utils/profiler.py", line 127, in inner
    out = func(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/pipelines/base_pipeline.py", line 284, in get_train_loss_dict
    model_outputs = self._model(ray_bundle)  # train distributed data parallel model if world_size > 1
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/models/base_model.py", line 142, in forward
    return self.get_outputs(ray_bundle)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/models/instant_ngp.py", line 302, in get_outputs
    ray_samples, ray_indices = self.sampler(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/model_components/ray_samplers.py", line 482, in forward
    ray_indices, starts, ends = self.occupancy_grid.sampling(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/nerfacc/estimators/occ_grid.py", line 192, in sampling
    sigmas = sigma_fn(t_starts, t_ends, ray_indices)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/model_components/ray_samplers.py", line 428, in sigma_fn
    return density_fn(positions).squeeze(-1)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/fields/base_field.py", line 67, in density_fn
    density, _ = self.get_density(ray_samples)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/fields/nerfacto_field.py", line 252, in get_density
    h = self.mlp_base(positions_flat).view(*ray_samples.frustums.shape, -1)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/field_components/mlp.py", line 177, in forward
    return self.tcnn_encoding(in_tensor)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tinycudann/modules.py", line 190, in forward
    output = _module_function.apply(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/autograd/function.py", line 506, in apply
    return super().apply(*args, **kwargs)  # type: ignore[misc]
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tinycudann/modules.py", line 102, in forward
    native_ctx, output = native_tcnn_module.fwd(input, params)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 406.00 MiB (GPU 0; 23.68 GiB total capacity; 6.58 GiB already allocated; 385.75 MiB free; 6.73 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
Iteration 16 completed

Iteration 17/30
Processing Categories:   0%|          | 0/55 [00:00<?, ?category/s]
Processing Models in pillow:   0%|          | 0/96 [00:00<?, ?model/s][A/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tyro/_fields.py:1066: UserWarning: Mutable type <class 'config.EnvConfig'> is used as a default value for `env`. This is dangerous! Consider using `dataclasses.field(default_factory=...)` or marking <class 'config.EnvConfig'> as frozen.
  warnings.warn(
pillow:/attached/data/remote-home2/zzq/data/shapenet/ShapeNetCore.v2/03938244/f06843cc11cfe791cbcb2c721c3564d4


CUDA
Generating data for init
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/boxx/ylcompat.py:69: BoxxWarning: warning from boxx
    os.environ["DISPLAY"] is not found
    plt.show() are redirect to plt.savefig(tmp)
    function: show, loga, crun, heatmap, plot will be affected
  def __setDisplayEnv():
saving data to data/shapenet/init/transforms.json
[14:31:22] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Found 64 GT images, loading directly from /remote-home/zzq/data/ShapeNet/gt_shapenet/pillow/f06843cc11cfe791cbcb2c721c3564d4
Loaded 64 GT images successfully!


viewpoint:   0%|          | 0/64 [00:00<?, ?it/s][A[Adealing with 38
[14:31:31] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:70: FutureWarning: Importing `spectral_angle_mapper` from `torchmetrics.functional` was deprecated and will be removed in 2.0. Import `spectral_angle_mapper` from `torchmetrics.image` instead.
  _future_warning(


viewpoint:  61%|██████    | 39/64 [15:54<10:11, 24.48s/it][A[ASelf.trainer.train duration: 835.5372 seconds
显存占用: 781.82 MB, 已预留显存: 1392.00 MB
dealing with 39
[14:47:26] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  62%|██████▎   | 40/64 [29:43<21:09, 52.91s/it][A[ASelf.trainer.train duration: 701.0908 seconds
显存占用: 1121.70 MB, 已预留显存: 1608.00 MB
dealing with 40
[15:01:15] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  64%|██████▍   | 41/64 [42:47<33:44, 88.03s/it][A[ASelf.trainer.train duration: 646.7769 seconds
显存占用: 1460.90 MB, 已预留显存: 1994.00 MB
dealing with 41
[15:14:18] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  66%|██████▌   | 42/64 [58:15<52:03, 141.99s/it][A[ASelf.trainer.train duration: 804.5753 seconds
显存占用: 1802.84 MB, 已预留显存: 2332.00 MB
dealing with 42
[15:29:47] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  67%|██████▋   | 43/64 [1:10:36<1:07:19, 192.34s/it][A[ASelf.trainer.train duration: 622.7006 seconds
显存占用: 2146.15 MB, 已预留显存: 2574.00 MB
dealing with 43
[15:42:08] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  69%|██████▉   | 44/64 [1:22:51<1:23:29, 250.50s/it][A[ASelf.trainer.train duration: 609.2456 seconds
显存占用: 2486.85 MB, 已预留显存: 2902.00 MB
dealing with 44
[15:54:22] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  70%|███████   | 45/64 [1:34:52<1:39:07, 313.05s/it][A[ASelf.trainer.train duration: 599.9382 seconds
显存占用: 2827.72 MB, 已预留显存: 3182.00 MB
dealing with 45
[16:06:24] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  72%|███████▏  | 46/64 [1:47:04<1:53:55, 379.74s/it][A[ASelf.trainer.train duration: 603.3189 seconds
显存占用: 3170.36 MB, 已预留显存: 3640.00 MB
dealing with 46
[16:18:35] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  73%|███████▎  | 47/64 [2:00:13<2:09:08, 455.76s/it][A[ASelf.trainer.train duration: 668.4661 seconds
显存占用: 3511.38 MB, 已预留显存: 3980.00 MB
dealing with 47
[16:31:45] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  75%|███████▌  | 48/64 [2:13:38<2:21:02, 528.90s/it][A[ASelf.trainer.train duration: 678.1880 seconds
显存占用: 3854.32 MB, 已预留显存: 4360.00 MB
dealing with 48
[16:45:09] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  77%|███████▋  | 49/64 [2:28:10<2:31:59, 607.95s/it][A[ASelf.trainer.train duration: 749.5487 seconds
显存占用: 4194.81 MB, 已预留显存: 4778.00 MB
dealing with 49
[16:59:41] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json
viewpoint:  77%|███████▋  | 49/64 [2:28:45<45:32, 182.15s/it]  

                                                                      [AProcessing Categories:   0%|          | 0/55 [2:29:13<?, ?category/s]
Traceback (most recent call last):
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 240, in <module>
    distribution_dataset_construction(model_path, num_azimuth, num_elevation, radius, start_viewpoint_index, viewpoint_index_interval)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 164, in distribution_dataset_construction
    NeRF_pipeline.add_image(images=obs,poses=input_pose,model_option=None)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nvf/active_mapping/active_mapping.py", line 233, in add_image
    self.trainer.train()
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nvf/nerfstudio_interface/nbv_trainer.py", line 213, in train
    loss, loss_dict, metrics_dict = self.train_iteration(step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/utils/profiler.py", line 127, in inner
    out = func(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/engine/trainer.py", line 740, in train_iteration
    _, loss_dict, metrics_dict = self.pipeline.get_train_loss_dict(step=step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/pipelines/dynamic_batch.py", line 91, in get_train_loss_dict
    model_outputs, loss_dict, metrics_dict = super().get_train_loss_dict(step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/utils/profiler.py", line 127, in inner
    out = func(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/pipelines/base_pipeline.py", line 284, in get_train_loss_dict
    model_outputs = self._model(ray_bundle)  # train distributed data parallel model if world_size > 1
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/models/base_model.py", line 142, in forward
    return self.get_outputs(ray_bundle)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/models/instant_ngp.py", line 302, in get_outputs
    ray_samples, ray_indices = self.sampler(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/model_components/ray_samplers.py", line 482, in forward
    ray_indices, starts, ends = self.occupancy_grid.sampling(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/nerfacc/estimators/occ_grid.py", line 192, in sampling
    sigmas = sigma_fn(t_starts, t_ends, ray_indices)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/model_components/ray_samplers.py", line 428, in sigma_fn
    return density_fn(positions).squeeze(-1)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/fields/base_field.py", line 67, in density_fn
    density, _ = self.get_density(ray_samples)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/fields/nerfacto_field.py", line 252, in get_density
    h = self.mlp_base(positions_flat).view(*ray_samples.frustums.shape, -1)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/field_components/mlp.py", line 177, in forward
    return self.tcnn_encoding(in_tensor)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tinycudann/modules.py", line 190, in forward
    output = _module_function.apply(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/autograd/function.py", line 506, in apply
    return super().apply(*args, **kwargs)  # type: ignore[misc]
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tinycudann/modules.py", line 102, in forward
    native_ctx, output = native_tcnn_module.fwd(input, params)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 234.00 MiB (GPU 0; 23.68 GiB total capacity; 7.00 GiB already allocated; 161.75 MiB free; 7.18 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
Iteration 17 completed

Iteration 18/30
Processing Categories:   0%|          | 0/55 [00:00<?, ?category/s]
Processing Models in pillow:   0%|          | 0/96 [00:00<?, ?model/s][A/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tyro/_fields.py:1066: UserWarning: Mutable type <class 'config.EnvConfig'> is used as a default value for `env`. This is dangerous! Consider using `dataclasses.field(default_factory=...)` or marking <class 'config.EnvConfig'> as frozen.
  warnings.warn(
pillow:/attached/data/remote-home2/zzq/data/shapenet/ShapeNetCore.v2/03938244/f06843cc11cfe791cbcb2c721c3564d4


CUDA
Generating data for init
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/boxx/ylcompat.py:69: BoxxWarning: warning from boxx
    os.environ["DISPLAY"] is not found
    plt.show() are redirect to plt.savefig(tmp)
    function: show, loga, crun, heatmap, plot will be affected
  def __setDisplayEnv():
saving data to data/shapenet/init/transforms.json
[17:02:13] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Found 64 GT images, loading directly from /remote-home/zzq/data/ShapeNet/gt_shapenet/pillow/f06843cc11cfe791cbcb2c721c3564d4
Loaded 64 GT images successfully!


viewpoint:   0%|          | 0/64 [00:00<?, ?it/s][A[Adealing with 49
[17:02:22] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:70: FutureWarning: Importing `spectral_angle_mapper` from `torchmetrics.functional` was deprecated and will be removed in 2.0. Import `spectral_angle_mapper` from `torchmetrics.image` instead.
  _future_warning(


viewpoint:  78%|███████▊  | 50/64 [14:10<03:58, 17.02s/it][A[ASelf.trainer.train duration: 707.9762 seconds
显存占用: 776.45 MB, 已预留显存: 1180.00 MB
dealing with 50
[17:16:33] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  80%|███████▉  | 51/64 [27:44<08:28, 39.14s/it][A[ASelf.trainer.train duration: 689.3508 seconds
显存占用: 1117.81 MB, 已预留显存: 1480.00 MB
dealing with 51
[17:30:06] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  81%|████████▏ | 52/64 [40:33<13:24, 67.01s/it][A[ASelf.trainer.train duration: 639.4078 seconds
显存占用: 1459.40 MB, 已预留显存: 1846.00 MB
dealing with 52
[17:42:56] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  83%|████████▎ | 53/64 [53:50<19:11, 104.72s/it][A[ASelf.trainer.train duration: 688.6349 seconds
显存占用: 1802.39 MB, 已预留显存: 2206.00 MB
dealing with 53
[17:56:12] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  84%|████████▍ | 54/64 [1:08:30<26:21, 158.10s/it][A[ASelf.trainer.train duration: 764.5164 seconds
显存占用: 2142.47 MB, 已预留显存: 2524.00 MB
dealing with 54
[18:10:53] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  86%|████████▌ | 55/64 [1:23:42<33:49, 225.55s/it][A[ASelf.trainer.train duration: 794.3443 seconds
显存占用: 2484.89 MB, 已预留显存: 2974.00 MB
dealing with 55
[18:26:05] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  88%|████████▊ | 56/64 [1:36:36<38:21, 287.73s/it][A[ASelf.trainer.train duration: 651.9172 seconds
显存占用: 2825.33 MB, 已预留显存: 3254.00 MB
dealing with 56
[18:38:59] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  89%|████████▉ | 57/64 [1:49:46<41:43, 357.66s/it][A[ASelf.trainer.train duration: 653.1598 seconds
显存占用: 3168.90 MB, 已预留显存: 3678.00 MB
dealing with 57
[18:52:08] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  91%|█████████ | 58/64 [2:03:42<43:42, 437.01s/it][A[ASelf.trainer.train duration: 704.6137 seconds
显存占用: 3511.76 MB, 已预留显存: 3972.00 MB
dealing with 58
[19:06:04] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json
viewpoint:  91%|█████████ | 58/64 [2:04:20<12:51, 128.63s/it]

                                                                      [AProcessing Categories:   0%|          | 0/55 [2:04:52<?, ?category/s]
Traceback (most recent call last):
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 240, in <module>
    distribution_dataset_construction(model_path, num_azimuth, num_elevation, radius, start_viewpoint_index, viewpoint_index_interval)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 164, in distribution_dataset_construction
    NeRF_pipeline.add_image(images=obs,poses=input_pose,model_option=None)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nvf/active_mapping/active_mapping.py", line 233, in add_image
    self.trainer.train()
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nvf/nerfstudio_interface/nbv_trainer.py", line 213, in train
    loss, loss_dict, metrics_dict = self.train_iteration(step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/utils/profiler.py", line 127, in inner
    out = func(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/engine/trainer.py", line 740, in train_iteration
    _, loss_dict, metrics_dict = self.pipeline.get_train_loss_dict(step=step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/pipelines/dynamic_batch.py", line 91, in get_train_loss_dict
    model_outputs, loss_dict, metrics_dict = super().get_train_loss_dict(step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/utils/profiler.py", line 127, in inner
    out = func(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/pipelines/base_pipeline.py", line 284, in get_train_loss_dict
    model_outputs = self._model(ray_bundle)  # train distributed data parallel model if world_size > 1
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/models/base_model.py", line 142, in forward
    return self.get_outputs(ray_bundle)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/models/instant_ngp.py", line 302, in get_outputs
    ray_samples, ray_indices = self.sampler(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/model_components/ray_samplers.py", line 482, in forward
    ray_indices, starts, ends = self.occupancy_grid.sampling(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/nerfacc/estimators/occ_grid.py", line 192, in sampling
    sigmas = sigma_fn(t_starts, t_ends, ray_indices)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/model_components/ray_samplers.py", line 428, in sigma_fn
    return density_fn(positions).squeeze(-1)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/fields/base_field.py", line 67, in density_fn
    density, _ = self.get_density(ray_samples)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/fields/nerfacto_field.py", line 252, in get_density
    h = self.mlp_base(positions_flat).view(*ray_samples.frustums.shape, -1)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/field_components/mlp.py", line 177, in forward
    return self.tcnn_encoding(in_tensor)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tinycudann/modules.py", line 190, in forward
    output = _module_function.apply(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/autograd/function.py", line 506, in apply
    return super().apply(*args, **kwargs)  # type: ignore[misc]
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tinycudann/modules.py", line 102, in forward
    native_ctx, output = native_tcnn_module.fwd(input, params)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 284.00 MiB (GPU 0; 23.68 GiB total capacity; 6.89 GiB already allocated; 227.75 MiB free; 7.14 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
Iteration 18 completed

Iteration 19/30
Processing Categories:   0%|          | 0/55 [00:00<?, ?category/s]
Processing Models in pillow:   0%|          | 0/96 [00:00<?, ?model/s][A/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tyro/_fields.py:1066: UserWarning: Mutable type <class 'config.EnvConfig'> is used as a default value for `env`. This is dangerous! Consider using `dataclasses.field(default_factory=...)` or marking <class 'config.EnvConfig'> as frozen.
  warnings.warn(
pillow:/attached/data/remote-home2/zzq/data/shapenet/ShapeNetCore.v2/03938244/f06843cc11cfe791cbcb2c721c3564d4


CUDA
Generating data for init
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/boxx/ylcompat.py:69: BoxxWarning: warning from boxx
    os.environ["DISPLAY"] is not found
    plt.show() are redirect to plt.savefig(tmp)
    function: show, loga, crun, heatmap, plot will be affected
  def __setDisplayEnv():
saving data to data/shapenet/init/transforms.json
[19:08:40] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Found 64 GT images, loading directly from /remote-home/zzq/data/ShapeNet/gt_shapenet/pillow/f06843cc11cfe791cbcb2c721c3564d4
Loaded 64 GT images successfully!


viewpoint:   0%|          | 0/64 [00:00<?, ?it/s][A[Adealing with 58
[19:08:49] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:70: FutureWarning: Importing `spectral_angle_mapper` from `torchmetrics.functional` was deprecated and will be removed in 2.0. Import `spectral_angle_mapper` from `torchmetrics.image` instead.
  _future_warning(


viewpoint:  92%|█████████▏| 59/64 [15:17<01:17, 15.56s/it][A[ASelf.trainer.train duration: 795.5236 seconds
显存占用: 777.59 MB, 已预留显存: 1278.00 MB
dealing with 59
[19:24:07] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  94%|█████████▍| 60/64 [28:51<02:17, 34.43s/it][A[ASelf.trainer.train duration: 693.8087 seconds
显存占用: 1118.90 MB, 已预留显存: 1484.00 MB
dealing with 60
[19:37:41] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  95%|█████████▌| 61/64 [43:02<03:03, 61.11s/it][A[ASelf.trainer.train duration: 699.1918 seconds
显存占用: 1460.56 MB, 已预留显存: 1934.00 MB
dealing with 61
[19:51:52] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  97%|█████████▋| 62/64 [58:44<03:20, 100.38s/it][A[ASelf.trainer.train duration: 820.7183 seconds
显存占用: 1805.70 MB, 已预留显存: 2550.00 MB
dealing with 62
[20:07:34] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  98%|█████████▊| 63/64 [1:13:45<02:28, 148.30s/it][A[ASelf.trainer.train duration: 774.2336 seconds
显存占用: 2144.98 MB, 已预留显存: 2528.00 MB
dealing with 63
[20:22:35] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint: 100%|██████████| 64/64 [1:27:04<00:00, 199.57s/it][A[Aviewpoint: 100%|██████████| 64/64 [1:27:04<00:00, 81.63s/it] 

Processing Models in pillow:   3%|▎         | 3/96 [1:27:37<45:16:36, 1752.65s/model][A/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tyro/_fields.py:1066: UserWarning: Mutable type <class 'config.EnvConfig'> is used as a default value for `env`. This is dangerous! Consider using `dataclasses.field(default_factory=...)` or marking <class 'config.EnvConfig'> as frozen.
  warnings.warn(
Self.trainer.train duration: 671.0895 seconds
显存占用: 2486.61 MB, 已预留显存: 2886.00 MB
pillow:/attached/data/remote-home2/zzq/data/shapenet/ShapeNetCore.v2/03938244/c1f39c4bcd931875f51f77a6d7299806


CUDA
Generating data for init
saving data to data/shapenet/init/transforms.json
[20:36:12] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Found 64 GT images, loading directly from /remote-home/zzq/data/ShapeNet/gt_shapenet/pillow/c1f39c4bcd931875f51f77a6d7299806
Loaded 64 GT images successfully!


viewpoint:   0%|          | 0/64 [00:00<?, ?it/s][A[Adealing with 0
[20:36:18] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:   2%|▏         | 1/64 [13:19<13:59:19, 799.35s/it][A[ASelf.trainer.train duration: 682.4997 seconds
显存占用: 3047.78 MB, 已预留显存: 3454.00 MB
dealing with 1
[20:49:37] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:   3%|▎         | 2/64 [24:57<12:44:21, 739.71s/it][A[ASelf.trainer.train duration: 582.1258 seconds
显存占用: 3390.62 MB, 已预留显存: 3856.00 MB
dealing with 2
[21:01:15] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:   5%|▍         | 3/64 [37:01<12:25:00, 732.80s/it][A[ASelf.trainer.train duration: 609.2892 seconds
显存占用: 3732.64 MB, 已预留显存: 4216.00 MB
dealing with 3
[21:13:20] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:   6%|▋         | 4/64 [49:45<12:24:58, 744.97s/it][A[ASelf.trainer.train duration: 646.7411 seconds
显存占用: 4076.13 MB, 已预留显存: 4656.00 MB
dealing with 4
[21:26:03] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:   8%|▊         | 5/64 [1:02:16<12:14:44, 747.20s/it][A[ASelf.trainer.train duration: 650.9776 seconds
显存占用: 4419.05 MB, 已预留显存: 5014.00 MB
dealing with 5
[21:38:34] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:   9%|▉         | 6/64 [1:15:05<12:09:23, 754.55s/it][A[ASelf.trainer.train duration: 652.2244 seconds
显存占用: 4759.83 MB, 已预留显存: 5342.00 MB
dealing with 6
[21:51:23] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  11%|█         | 7/64 [1:27:33<11:54:55, 752.55s/it][A[ASelf.trainer.train duration: 628.0880 seconds
显存占用: 5101.47 MB, 已预留显存: 5672.00 MB
dealing with 7
[22:03:52] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
System is out of GPU memory

Refer to the Cycles GPU rendering documentation for possible solutions:
https://docs.blender.org/manual/en/latest/render/cycles/gpu_rendering.html

System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
viewpoint:  11%|█         | 7/64 [1:27:38<11:53:36, 751.16s/it]

                                                                                     [AProcessing Categories:   0%|          | 0/55 [2:55:40<?, ?category/s]
Traceback (most recent call last):
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 240, in <module>
    distribution_dataset_construction(model_path, num_azimuth, num_elevation, radius, start_viewpoint_index, viewpoint_index_interval)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 160, in distribution_dataset_construction
    env.reset()
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_env.py", line 117, in reset
    np_images, transforms = self.get_images(mode='init')
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_env.py", line 129, in get_images
    return self.gen_data(mode, return_quat=return_quat)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_env.py", line 150, in gen_data
    image = self.scene.render_pose(pose)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_scene.py", line 215, in render_pose
    result = self.render() #
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_scene.py", line 566, in render
    return super().render()
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_scene.py", line 422, in render
    result = bpycv.render_data()
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/bpycv/render_utils.py", line 115, in render_data
    render_result["image"] = _render_image()
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/bpycv/render_utils.py", line 94, in render_image
    bpy.ops.render.render(write_still=True)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/bpy/3.6/scripts/modules/bpy/ops.py", line 113, in __call__
    ret = _op_call(self.idname_py(), None, kw)
RuntimeError: Error: System is out of GPU memory
Error: System is out of GPU memory

Iteration 19 completed

Iteration 20/30
Processing Categories:   0%|          | 0/55 [00:00<?, ?category/s]
Processing Models in pillow:   0%|          | 0/96 [00:00<?, ?model/s][A/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tyro/_fields.py:1066: UserWarning: Mutable type <class 'config.EnvConfig'> is used as a default value for `env`. This is dangerous! Consider using `dataclasses.field(default_factory=...)` or marking <class 'config.EnvConfig'> as frozen.
  warnings.warn(
pillow:/attached/data/remote-home2/zzq/data/shapenet/ShapeNetCore.v2/03938244/c1f39c4bcd931875f51f77a6d7299806


CUDA
Generating data for init
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/boxx/ylcompat.py:69: BoxxWarning: warning from boxx
    os.environ["DISPLAY"] is not found
    plt.show() are redirect to plt.savefig(tmp)
    function: show, loga, crun, heatmap, plot will be affected
  def __setDisplayEnv():
saving data to data/shapenet/init/transforms.json
[22:06:06] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Found 64 GT images, loading directly from /remote-home/zzq/data/ShapeNet/gt_shapenet/pillow/c1f39c4bcd931875f51f77a6d7299806
Loaded 64 GT images successfully!


viewpoint:   0%|          | 0/64 [00:00<?, ?it/s][A[Adealing with 7
[22:06:15] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:70: FutureWarning: Importing `spectral_angle_mapper` from `torchmetrics.functional` was deprecated and will be removed in 2.0. Import `spectral_angle_mapper` from `torchmetrics.image` instead.
  _future_warning(


viewpoint:  12%|█▎        | 8/64 [14:14<1:39:38, 106.76s/it][A[ASelf.trainer.train duration: 741.1393 seconds
显存占用: 777.00 MB, 已预留显存: 1318.00 MB
dealing with 8
[22:20:29] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  14%|█▍        | 9/64 [27:02<3:09:44, 206.99s/it][A[ASelf.trainer.train duration: 651.1132 seconds
显存占用: 1118.88 MB, 已预留显存: 1526.00 MB
dealing with 9
[22:33:18] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  16%|█▌        | 10/64 [39:25<4:32:13, 302.48s/it][A[ASelf.trainer.train duration: 623.4001 seconds
显存占用: 1460.17 MB, 已预留显存: 1872.00 MB
dealing with 10
[22:45:41] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  17%|█▋        | 11/64 [51:47<5:45:42, 391.36s/it][A[ASelf.trainer.train duration: 624.6614 seconds
显存占用: 1803.54 MB, 已预留显存: 2230.00 MB
dealing with 11
[22:58:02] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  19%|█▉        | 12/64 [1:03:53<6:44:27, 466.68s/it][A[ASelf.trainer.train duration: 607.1765 seconds
显存占用: 2146.30 MB, 已预留显存: 2542.00 MB
dealing with 12
[23:10:09] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  20%|██        | 13/64 [1:16:14<7:33:19, 533.31s/it][A[ASelf.trainer.train duration: 622.1202 seconds
显存占用: 2489.02 MB, 已预留显存: 3002.00 MB
dealing with 13
[23:22:30] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  22%|██▏       | 14/64 [1:28:32<8:08:22, 586.06s/it][A[ASelf.trainer.train duration: 628.4402 seconds
显存占用: 2830.82 MB, 已预留显存: 3312.00 MB
dealing with 14
[23:34:48] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  23%|██▎       | 15/64 [1:40:56<8:33:16, 628.51s/it][A[ASelf.trainer.train duration: 625.9092 seconds
显存占用: 3170.87 MB, 已预留显存: 3734.00 MB
dealing with 15
[23:47:12] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  25%|██▌       | 16/64 [1:53:48<8:54:37, 668.29s/it][A[ASelf.trainer.train duration: 658.3511 seconds
显存占用: 3513.37 MB, 已预留显存: 4080.00 MB
dealing with 16
[00:00:04] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  27%|██▋       | 17/64 [2:06:44<9:07:30, 698.94s/it][A[ASelf.trainer.train duration: 657.1831 seconds
显存占用: 3855.86 MB, 已预留显存: 4420.00 MB
dealing with 17
[00:13:00] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  28%|██▊       | 18/64 [2:18:50<9:01:47, 706.67s/it][A[ASelf.trainer.train duration: 605.1749 seconds
显存占用: 4197.30 MB, 已预留显存: 4708.00 MB
dealing with 18
[00:25:06] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  30%|██▉       | 19/64 [2:31:44<9:04:40, 726.23s/it][A[ASelf.trainer.train duration: 654.7404 seconds
显存占用: 4539.10 MB, 已预留显存: 5140.00 MB
dealing with 19
[00:38:00] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  31%|███▏      | 20/64 [2:40:51<8:13:56, 673.55s/it][A[ASelf.trainer.train duration: 501.7650 seconds
显存占用: 4880.55 MB, 已预留显存: 5300.00 MB
dealing with 20
[00:47:07] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  33%|███▎      | 21/64 [2:45:01<6:32:49, 548.13s/it][A[ASelf.trainer.train duration: 216.0132 seconds
显存占用: 5223.76 MB, 已预留显存: 5770.00 MB
dealing with 21
[00:51:17] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  34%|███▍      | 22/64 [2:50:48<5:41:47, 488.28s/it][A[ASelf.trainer.train duration: 236.6937 seconds
显存占用: 5564.75 MB, 已预留显存: 6088.00 MB
dealing with 22
[00:57:03] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  36%|███▌      | 23/64 [3:02:53<6:22:03, 559.10s/it][A[ASelf.trainer.train duration: 619.6525 seconds
显存占用: 5906.80 MB, 已预留显存: 6550.00 MB
dealing with 23
[01:09:09] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  38%|███▊      | 24/64 [3:14:56<6:45:11, 607.80s/it][A[ASelf.trainer.train duration: 602.4345 seconds
显存占用: 6247.19 MB, 已预留显存: 6824.00 MB
dealing with 24
[01:21:11] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json
viewpoint:  38%|███▊      | 24/64 [3:15:30<5:25:51, 488.78s/it]

                                                                      [AProcessing Categories:   0%|          | 0/55 [3:15:58<?, ?category/s]
Traceback (most recent call last):
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 240, in <module>
    distribution_dataset_construction(model_path, num_azimuth, num_elevation, radius, start_viewpoint_index, viewpoint_index_interval)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 164, in distribution_dataset_construction
    NeRF_pipeline.add_image(images=obs,poses=input_pose,model_option=None)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nvf/active_mapping/active_mapping.py", line 233, in add_image
    self.trainer.train()
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nvf/nerfstudio_interface/nbv_trainer.py", line 213, in train
    loss, loss_dict, metrics_dict = self.train_iteration(step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/utils/profiler.py", line 127, in inner
    out = func(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/engine/trainer.py", line 740, in train_iteration
    _, loss_dict, metrics_dict = self.pipeline.get_train_loss_dict(step=step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/pipelines/dynamic_batch.py", line 91, in get_train_loss_dict
    model_outputs, loss_dict, metrics_dict = super().get_train_loss_dict(step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/utils/profiler.py", line 127, in inner
    out = func(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/pipelines/base_pipeline.py", line 284, in get_train_loss_dict
    model_outputs = self._model(ray_bundle)  # train distributed data parallel model if world_size > 1
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/models/base_model.py", line 142, in forward
    return self.get_outputs(ray_bundle)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/models/instant_ngp.py", line 302, in get_outputs
    ray_samples, ray_indices = self.sampler(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/model_components/ray_samplers.py", line 482, in forward
    ray_indices, starts, ends = self.occupancy_grid.sampling(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/nerfacc/estimators/occ_grid.py", line 192, in sampling
    sigmas = sigma_fn(t_starts, t_ends, ray_indices)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/model_components/ray_samplers.py", line 428, in sigma_fn
    return density_fn(positions).squeeze(-1)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/fields/base_field.py", line 67, in density_fn
    density, _ = self.get_density(ray_samples)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/fields/nerfacto_field.py", line 252, in get_density
    h = self.mlp_base(positions_flat).view(*ray_samples.frustums.shape, -1)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/field_components/mlp.py", line 177, in forward
    return self.tcnn_encoding(in_tensor)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tinycudann/modules.py", line 190, in forward
    output = _module_function.apply(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/autograd/function.py", line 506, in apply
    return super().apply(*args, **kwargs)  # type: ignore[misc]
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tinycudann/modules.py", line 102, in forward
    native_ctx, output = native_tcnn_module.fwd(input, params)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 150.00 MiB (GPU 0; 23.68 GiB total capacity; 8.07 GiB already allocated; 135.75 MiB free; 8.34 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
Iteration 20 completed

Iteration 21/30
Processing Categories:   0%|          | 0/55 [00:00<?, ?category/s]
Processing Models in pillow:   0%|          | 0/96 [00:00<?, ?model/s][A/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tyro/_fields.py:1066: UserWarning: Mutable type <class 'config.EnvConfig'> is used as a default value for `env`. This is dangerous! Consider using `dataclasses.field(default_factory=...)` or marking <class 'config.EnvConfig'> as frozen.
  warnings.warn(
pillow:/attached/data/remote-home2/zzq/data/shapenet/ShapeNetCore.v2/03938244/c1f39c4bcd931875f51f77a6d7299806


CUDA
Generating data for init
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/boxx/ylcompat.py:69: BoxxWarning: warning from boxx
    os.environ["DISPLAY"] is not found
    plt.show() are redirect to plt.savefig(tmp)
    function: show, loga, crun, heatmap, plot will be affected
  def __setDisplayEnv():
saving data to data/shapenet/init/transforms.json
[01:24:04] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Found 64 GT images, loading directly from /remote-home/zzq/data/ShapeNet/gt_shapenet/pillow/c1f39c4bcd931875f51f77a6d7299806
Loaded 64 GT images successfully!


viewpoint:   0%|          | 0/64 [00:00<?, ?it/s][A[Adealing with 24
[01:24:13] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json
viewpoint:  38%|███▊      | 24/64 [01:09<01:56,  2.90s/it]

                                                                      [AProcessing Categories:   0%|          | 0/55 [01:36<?, ?category/s]
Traceback (most recent call last):
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 240, in <module>
    distribution_dataset_construction(model_path, num_azimuth, num_elevation, radius, start_viewpoint_index, viewpoint_index_interval)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 164, in distribution_dataset_construction
    NeRF_pipeline.add_image(images=obs,poses=input_pose,model_option=None)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nvf/active_mapping/active_mapping.py", line 233, in add_image
    self.trainer.train()
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nvf/nerfstudio_interface/nbv_trainer.py", line 213, in train
    loss, loss_dict, metrics_dict = self.train_iteration(step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/utils/profiler.py", line 127, in inner
    out = func(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/engine/trainer.py", line 740, in train_iteration
    _, loss_dict, metrics_dict = self.pipeline.get_train_loss_dict(step=step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/pipelines/dynamic_batch.py", line 91, in get_train_loss_dict
    model_outputs, loss_dict, metrics_dict = super().get_train_loss_dict(step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/utils/profiler.py", line 127, in inner
    out = func(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/pipelines/base_pipeline.py", line 284, in get_train_loss_dict
    model_outputs = self._model(ray_bundle)  # train distributed data parallel model if world_size > 1
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/models/base_model.py", line 142, in forward
    return self.get_outputs(ray_bundle)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/models/instant_ngp.py", line 302, in get_outputs
    ray_samples, ray_indices = self.sampler(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/model_components/ray_samplers.py", line 482, in forward
    ray_indices, starts, ends = self.occupancy_grid.sampling(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/nerfacc/estimators/occ_grid.py", line 192, in sampling
    sigmas = sigma_fn(t_starts, t_ends, ray_indices)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/model_components/ray_samplers.py", line 428, in sigma_fn
    return density_fn(positions).squeeze(-1)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/fields/base_field.py", line 67, in density_fn
    density, _ = self.get_density(ray_samples)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/fields/nerfacto_field.py", line 252, in get_density
    h = self.mlp_base(positions_flat).view(*ray_samples.frustums.shape, -1)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/field_components/mlp.py", line 177, in forward
    return self.tcnn_encoding(in_tensor)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tinycudann/modules.py", line 190, in forward
    output = _module_function.apply(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/autograd/function.py", line 506, in apply
    return super().apply(*args, **kwargs)  # type: ignore[misc]
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tinycudann/modules.py", line 102, in forward
    native_ctx, output = native_tcnn_module.fwd(input, params)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 350.00 MiB (GPU 0; 23.68 GiB total capacity; 4.67 GiB already allocated; 213.75 MiB free; 4.92 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
Iteration 21 completed

Iteration 22/30
Processing Categories:   0%|          | 0/55 [00:00<?, ?category/s]
Processing Models in pillow:   0%|          | 0/96 [00:00<?, ?model/s][A/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tyro/_fields.py:1066: UserWarning: Mutable type <class 'config.EnvConfig'> is used as a default value for `env`. This is dangerous! Consider using `dataclasses.field(default_factory=...)` or marking <class 'config.EnvConfig'> as frozen.
  warnings.warn(
pillow:/attached/data/remote-home2/zzq/data/shapenet/ShapeNetCore.v2/03938244/c1f39c4bcd931875f51f77a6d7299806


CUDA
Generating data for init
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/boxx/ylcompat.py:69: BoxxWarning: warning from boxx
    os.environ["DISPLAY"] is not found
    plt.show() are redirect to plt.savefig(tmp)
    function: show, loga, crun, heatmap, plot will be affected
  def __setDisplayEnv():
saving data to data/shapenet/init/transforms.json
[01:27:27] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Found 64 GT images, loading directly from /remote-home/zzq/data/ShapeNet/gt_shapenet/pillow/c1f39c4bcd931875f51f77a6d7299806
Loaded 64 GT images successfully!


viewpoint:   0%|          | 0/64 [00:00<?, ?it/s][A[Adealing with 24
[01:27:36] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json
viewpoint:  38%|███▊      | 24/64 [01:03<01:45,  2.65s/it]

                                                                      [AProcessing Categories:   0%|          | 0/55 [01:28<?, ?category/s]
Traceback (most recent call last):
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 240, in <module>
    distribution_dataset_construction(model_path, num_azimuth, num_elevation, radius, start_viewpoint_index, viewpoint_index_interval)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 164, in distribution_dataset_construction
    NeRF_pipeline.add_image(images=obs,poses=input_pose,model_option=None)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nvf/active_mapping/active_mapping.py", line 233, in add_image
    self.trainer.train()
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nvf/nerfstudio_interface/nbv_trainer.py", line 213, in train
    loss, loss_dict, metrics_dict = self.train_iteration(step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/utils/profiler.py", line 127, in inner
    out = func(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/engine/trainer.py", line 740, in train_iteration
    _, loss_dict, metrics_dict = self.pipeline.get_train_loss_dict(step=step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/pipelines/dynamic_batch.py", line 91, in get_train_loss_dict
    model_outputs, loss_dict, metrics_dict = super().get_train_loss_dict(step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/utils/profiler.py", line 127, in inner
    out = func(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/pipelines/base_pipeline.py", line 284, in get_train_loss_dict
    model_outputs = self._model(ray_bundle)  # train distributed data parallel model if world_size > 1
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/models/base_model.py", line 142, in forward
    return self.get_outputs(ray_bundle)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/models/instant_ngp.py", line 302, in get_outputs
    ray_samples, ray_indices = self.sampler(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/model_components/ray_samplers.py", line 482, in forward
    ray_indices, starts, ends = self.occupancy_grid.sampling(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/nerfacc/estimators/occ_grid.py", line 192, in sampling
    sigmas = sigma_fn(t_starts, t_ends, ray_indices)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/model_components/ray_samplers.py", line 428, in sigma_fn
    return density_fn(positions).squeeze(-1)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/fields/base_field.py", line 67, in density_fn
    density, _ = self.get_density(ray_samples)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/fields/nerfacto_field.py", line 252, in get_density
    h = self.mlp_base(positions_flat).view(*ray_samples.frustums.shape, -1)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/field_components/mlp.py", line 177, in forward
    return self.tcnn_encoding(in_tensor)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tinycudann/modules.py", line 190, in forward
    output = _module_function.apply(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/autograd/function.py", line 506, in apply
    return super().apply(*args, **kwargs)  # type: ignore[misc]
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tinycudann/modules.py", line 102, in forward
    native_ctx, output = native_tcnn_module.fwd(input, params)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 352.00 MiB (GPU 0; 23.68 GiB total capacity; 4.64 GiB already allocated; 325.75 MiB free; 4.80 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
Iteration 22 completed

Iteration 23/30
Processing Categories:   0%|          | 0/55 [00:00<?, ?category/s]
Processing Models in pillow:   0%|          | 0/96 [00:00<?, ?model/s][A/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tyro/_fields.py:1066: UserWarning: Mutable type <class 'config.EnvConfig'> is used as a default value for `env`. This is dangerous! Consider using `dataclasses.field(default_factory=...)` or marking <class 'config.EnvConfig'> as frozen.
  warnings.warn(
pillow:/attached/data/remote-home2/zzq/data/shapenet/ShapeNetCore.v2/03938244/c1f39c4bcd931875f51f77a6d7299806


CUDA
Generating data for init
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/boxx/ylcompat.py:69: BoxxWarning: warning from boxx
    os.environ["DISPLAY"] is not found
    plt.show() are redirect to plt.savefig(tmp)
    function: show, loga, crun, heatmap, plot will be affected
  def __setDisplayEnv():
saving data to data/shapenet/init/transforms.json
[01:30:46] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Found 64 GT images, loading directly from /remote-home/zzq/data/ShapeNet/gt_shapenet/pillow/c1f39c4bcd931875f51f77a6d7299806
Loaded 64 GT images successfully!


viewpoint:   0%|          | 0/64 [00:00<?, ?it/s][A[Adealing with 24
[01:30:55] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:70: FutureWarning: Importing `spectral_angle_mapper` from `torchmetrics.functional` was deprecated and will be removed in 2.0. Import `spectral_angle_mapper` from `torchmetrics.image` instead.
  _future_warning(


viewpoint:  39%|███▉      | 25/64 [15:05<23:33, 36.24s/it][A[ASelf.trainer.train duration: 789.2392 seconds
显存占用: 780.37 MB, 已预留显存: 1560.00 MB
dealing with 25
[01:46:01] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  41%|████      | 26/64 [28:39<49:34, 78.28s/it][A[ASelf.trainer.train duration: 696.7032 seconds
显存占用: 1119.78 MB, 已预留显存: 1614.00 MB
dealing with 26
[01:59:35] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  42%|████▏     | 27/64 [41:37<1:19:11, 128.43s/it][A[ASelf.trainer.train duration: 661.1599 seconds
显存占用: 1460.39 MB, 已预留显存: 1882.00 MB
dealing with 27
[02:12:33] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  44%|████▍     | 28/64 [55:07<1:55:02, 191.75s/it][A[ASelf.trainer.train duration: 695.3154 seconds
显存占用: 1801.74 MB, 已预留显存: 2258.00 MB
dealing with 28
[02:26:03] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  45%|████▌     | 29/64 [1:08:03<2:31:45, 260.16s/it][A[ASelf.trainer.train duration: 656.9299 seconds
显存占用: 2144.25 MB, 已预留显存: 2650.00 MB
dealing with 29
[02:38:59] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  47%|████▋     | 30/64 [1:21:23<3:11:17, 337.58s/it][A[ASelf.trainer.train duration: 687.0216 seconds
显存占用: 2487.09 MB, 已预留显存: 3006.00 MB
dealing with 30
[02:52:19] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  48%|████▊     | 31/64 [1:34:50<3:49:32, 417.34s/it][A[ASelf.trainer.train duration: 707.6499 seconds
显存占用: 2828.19 MB, 已预留显存: 3234.00 MB
dealing with 31
[03:05:45] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  50%|█████     | 32/64 [1:48:24<4:23:57, 494.93s/it][A[ASelf.trainer.train duration: 692.9387 seconds
显存占用: 3170.23 MB, 已预留显存: 3706.00 MB
dealing with 32
[03:19:20] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  52%|█████▏    | 33/64 [2:02:48<4:57:17, 575.41s/it][A[ASelf.trainer.train duration: 751.5824 seconds
显存占用: 3512.37 MB, 已预留显存: 4088.00 MB
dealing with 33
[03:33:44] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  53%|█████▎    | 34/64 [2:16:42<5:18:24, 636.80s/it][A[ASelf.trainer.train duration: 716.9835 seconds
显存占用: 3853.41 MB, 已预留显存: 4452.00 MB
dealing with 34
[03:47:37] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  55%|█████▍    | 35/64 [2:29:50<5:26:20, 675.20s/it][A[ASelf.trainer.train duration: 673.9692 seconds
显存占用: 4196.14 MB, 已预留显存: 4784.00 MB
dealing with 35
[04:00:46] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json
viewpoint:  55%|█████▍    | 35/64 [2:31:14<2:05:18, 259.26s/it]

                                                                      [AProcessing Categories:   0%|          | 0/55 [2:31:40<?, ?category/s]
Traceback (most recent call last):
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 240, in <module>
    distribution_dataset_construction(model_path, num_azimuth, num_elevation, radius, start_viewpoint_index, viewpoint_index_interval)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 164, in distribution_dataset_construction
    NeRF_pipeline.add_image(images=obs,poses=input_pose,model_option=None)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nvf/active_mapping/active_mapping.py", line 233, in add_image
    self.trainer.train()
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nvf/nerfstudio_interface/nbv_trainer.py", line 213, in train
    loss, loss_dict, metrics_dict = self.train_iteration(step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/utils/profiler.py", line 127, in inner
    out = func(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/engine/trainer.py", line 740, in train_iteration
    _, loss_dict, metrics_dict = self.pipeline.get_train_loss_dict(step=step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/pipelines/dynamic_batch.py", line 91, in get_train_loss_dict
    model_outputs, loss_dict, metrics_dict = super().get_train_loss_dict(step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/utils/profiler.py", line 127, in inner
    out = func(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/pipelines/base_pipeline.py", line 284, in get_train_loss_dict
    model_outputs = self._model(ray_bundle)  # train distributed data parallel model if world_size > 1
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/models/base_model.py", line 142, in forward
    return self.get_outputs(ray_bundle)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/models/instant_ngp.py", line 302, in get_outputs
    ray_samples, ray_indices = self.sampler(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/model_components/ray_samplers.py", line 482, in forward
    ray_indices, starts, ends = self.occupancy_grid.sampling(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/nerfacc/estimators/occ_grid.py", line 192, in sampling
    sigmas = sigma_fn(t_starts, t_ends, ray_indices)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/model_components/ray_samplers.py", line 428, in sigma_fn
    return density_fn(positions).squeeze(-1)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/fields/base_field.py", line 67, in density_fn
    density, _ = self.get_density(ray_samples)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/fields/nerfacto_field.py", line 252, in get_density
    h = self.mlp_base(positions_flat).view(*ray_samples.frustums.shape, -1)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/field_components/mlp.py", line 177, in forward
    return self.tcnn_encoding(in_tensor)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tinycudann/modules.py", line 190, in forward
    output = _module_function.apply(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/autograd/function.py", line 506, in apply
    return super().apply(*args, **kwargs)  # type: ignore[misc]
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tinycudann/modules.py", line 102, in forward
    native_ctx, output = native_tcnn_module.fwd(input, params)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 144.00 MiB (GPU 0; 23.68 GiB total capacity; 6.00 GiB already allocated; 115.75 MiB free; 6.21 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
Iteration 23 completed

Iteration 24/30
Processing Categories:   0%|          | 0/55 [00:00<?, ?category/s]
Processing Models in pillow:   0%|          | 0/96 [00:00<?, ?model/s][A/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tyro/_fields.py:1066: UserWarning: Mutable type <class 'config.EnvConfig'> is used as a default value for `env`. This is dangerous! Consider using `dataclasses.field(default_factory=...)` or marking <class 'config.EnvConfig'> as frozen.
  warnings.warn(
pillow:/attached/data/remote-home2/zzq/data/shapenet/ShapeNetCore.v2/03938244/c1f39c4bcd931875f51f77a6d7299806


CUDA
Generating data for init
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/boxx/ylcompat.py:69: BoxxWarning: warning from boxx
    os.environ["DISPLAY"] is not found
    plt.show() are redirect to plt.savefig(tmp)
    function: show, loga, crun, heatmap, plot will be affected
  def __setDisplayEnv():
saving data to data/shapenet/init/transforms.json
[04:04:31] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Found 64 GT images, loading directly from /remote-home/zzq/data/ShapeNet/gt_shapenet/pillow/c1f39c4bcd931875f51f77a6d7299806
Loaded 64 GT images successfully!


viewpoint:   0%|          | 0/64 [00:00<?, ?it/s][A[Adealing with 35
[04:04:39] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:70: FutureWarning: Importing `spectral_angle_mapper` from `torchmetrics.functional` was deprecated and will be removed in 2.0. Import `spectral_angle_mapper` from `torchmetrics.image` instead.
  _future_warning(


viewpoint:  56%|█████▋    | 36/64 [15:01<11:41, 25.04s/it][A[ASelf.trainer.train duration: 787.0981 seconds
显存占用: 779.66 MB, 已预留显存: 1522.00 MB
dealing with 36
[04:19:41] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  58%|█████▊    | 37/64 [29:40<25:56, 57.63s/it][A[ASelf.trainer.train duration: 764.7777 seconds
显存占用: 1121.88 MB, 已预留显存: 1784.00 MB
dealing with 37
[04:34:20] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  59%|█████▉    | 38/64 [42:34<41:01, 94.67s/it][A[ASelf.trainer.train duration: 677.6362 seconds
显存占用: 1462.48 MB, 已预留显存: 2002.00 MB
dealing with 38
[04:47:14] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  61%|██████    | 39/64 [56:20<1:00:23, 144.95s/it][A[ASelf.trainer.train duration: 711.0097 seconds
显存占用: 1805.49 MB, 已预留显存: 2440.00 MB
dealing with 39
[05:01:00] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  62%|██████▎   | 40/64 [1:10:08<1:22:26, 206.12s/it][A[ASelf.trainer.train duration: 711.9929 seconds
显存占用: 2147.53 MB, 已预留显存: 2718.00 MB
dealing with 40
[05:14:48] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  64%|██████▍   | 41/64 [1:22:58<1:43:30, 270.03s/it][A[ASelf.trainer.train duration: 652.6322 seconds
显存占用: 2486.12 MB, 已预留显存: 3058.00 MB
dealing with 41
[05:27:38] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  66%|██████▌   | 42/64 [1:34:47<2:01:25, 331.14s/it][A[ASelf.trainer.train duration: 588.9799 seconds
显存占用: 2828.10 MB, 已预留显存: 3240.00 MB
dealing with 42
[05:39:27] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  67%|██████▋   | 43/64 [1:46:46<2:18:28, 395.65s/it][A[ASelf.trainer.train duration: 601.8536 seconds
显存占用: 3171.82 MB, 已预留显存: 3714.00 MB
dealing with 43
[05:51:26] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  69%|██████▉   | 44/64 [1:58:46<2:32:33, 457.68s/it][A[ASelf.trainer.train duration: 596.1817 seconds
显存占用: 3512.63 MB, 已预留显存: 4048.00 MB
dealing with 44
[06:03:26] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  70%|███████   | 45/64 [2:11:18<2:45:01, 521.11s/it][A[ASelf.trainer.train duration: 650.5234 seconds
显存占用: 3857.24 MB, 已预留显存: 4416.00 MB
dealing with 45
[06:15:58] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  72%|███████▏  | 46/64 [2:23:25<2:50:46, 569.27s/it][A[ASelf.trainer.train duration: 603.3879 seconds
显存占用: 4198.43 MB, 已预留显存: 4636.00 MB
dealing with 46
[06:28:05] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
System is out of GPU memory

Refer to the Cycles GPU rendering documentation for possible solutions:
https://docs.blender.org/manual/en/latest/render/cycles/gpu_rendering.html

System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
viewpoint:  72%|███████▏  | 46/64 [2:23:29<56:08, 187.17s/it]  

                                                                      [AProcessing Categories:   0%|          | 0/55 [2:23:59<?, ?category/s]
Traceback (most recent call last):
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 240, in <module>
    distribution_dataset_construction(model_path, num_azimuth, num_elevation, radius, start_viewpoint_index, viewpoint_index_interval)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 160, in distribution_dataset_construction
    env.reset()
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_env.py", line 117, in reset
    np_images, transforms = self.get_images(mode='init')
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_env.py", line 129, in get_images
    return self.gen_data(mode, return_quat=return_quat)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_env.py", line 150, in gen_data
    image = self.scene.render_pose(pose)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_scene.py", line 215, in render_pose
    result = self.render() #
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_scene.py", line 566, in render
    return super().render()
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_scene.py", line 422, in render
    result = bpycv.render_data()
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/bpycv/render_utils.py", line 115, in render_data
    render_result["image"] = _render_image()
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/bpycv/render_utils.py", line 94, in render_image
    bpy.ops.render.render(write_still=True)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/bpy/3.6/scripts/modules/bpy/ops.py", line 113, in __call__
    ret = _op_call(self.idname_py(), None, kw)
RuntimeError: Error: System is out of GPU memory
Error: System is out of GPU memory

Iteration 24 completed

Iteration 25/30
Processing Categories:   0%|          | 0/55 [00:00<?, ?category/s]
Processing Models in pillow:   0%|          | 0/96 [00:00<?, ?model/s][A/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tyro/_fields.py:1066: UserWarning: Mutable type <class 'config.EnvConfig'> is used as a default value for `env`. This is dangerous! Consider using `dataclasses.field(default_factory=...)` or marking <class 'config.EnvConfig'> as frozen.
  warnings.warn(
pillow:/attached/data/remote-home2/zzq/data/shapenet/ShapeNetCore.v2/03938244/c1f39c4bcd931875f51f77a6d7299806


CUDA
Generating data for init
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/boxx/ylcompat.py:69: BoxxWarning: warning from boxx
    os.environ["DISPLAY"] is not found
    plt.show() are redirect to plt.savefig(tmp)
    function: show, loga, crun, heatmap, plot will be affected
  def __setDisplayEnv():
saving data to data/shapenet/init/transforms.json
[06:30:25] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Found 64 GT images, loading directly from /remote-home/zzq/data/ShapeNet/gt_shapenet/pillow/c1f39c4bcd931875f51f77a6d7299806
Loaded 64 GT images successfully!


viewpoint:   0%|          | 0/64 [00:00<?, ?it/s][A[Adealing with 46
[06:30:33] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:70: FutureWarning: Importing `spectral_angle_mapper` from `torchmetrics.functional` was deprecated and will be removed in 2.0. Import `spectral_angle_mapper` from `torchmetrics.image` instead.
  _future_warning(


viewpoint:  73%|███████▎  | 47/64 [12:53<04:39, 16.47s/it][A[ASelf.trainer.train duration: 655.5790 seconds
显存占用: 776.65 MB, 已预留显存: 1228.00 MB
dealing with 47
[06:43:27] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  75%|███████▌  | 48/64 [25:32<10:13, 38.35s/it][A[ASelf.trainer.train duration: 641.8816 seconds
显存占用: 1118.04 MB, 已预留显存: 1634.00 MB
dealing with 48
[06:56:06] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  77%|███████▋  | 49/64 [37:31<16:28, 65.89s/it][A[ASelf.trainer.train duration: 605.4584 seconds
显存占用: 1459.79 MB, 已预留显存: 1866.00 MB
dealing with 49
[07:08:05] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  78%|███████▊  | 50/64 [49:31<23:42, 101.58s/it][A[ASelf.trainer.train duration: 603.2017 seconds
显存占用: 1802.08 MB, 已预留显存: 2278.00 MB
dealing with 50
[07:20:04] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  80%|███████▉  | 51/64 [1:01:20<31:32, 145.58s/it][A[ASelf.trainer.train duration: 582.2301 seconds
显存占用: 2143.03 MB, 已预留显存: 2544.00 MB
dealing with 51
[07:31:54] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  81%|████████▏ | 52/64 [1:13:15<39:46, 198.88s/it][A[ASelf.trainer.train duration: 603.5520 seconds
显存占用: 2485.93 MB, 已预留显存: 2954.00 MB
dealing with 52
[07:43:48] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  83%|████████▎ | 53/64 [1:25:17<47:47, 260.69s/it][A[ASelf.trainer.train duration: 603.5225 seconds
显存占用: 2827.34 MB, 已预留显存: 3260.00 MB
dealing with 53
[07:55:51] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  84%|████████▍ | 54/64 [1:36:56<53:59, 323.98s/it][A[ASelf.trainer.train duration: 584.4367 seconds
显存占用: 3168.79 MB, 已预留显存: 3632.00 MB
dealing with 54
[08:07:30] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  86%|████████▌ | 55/64 [1:48:44<58:26, 389.60s/it][A[ASelf.trainer.train duration: 593.9935 seconds
显存占用: 3511.79 MB, 已预留显存: 3952.00 MB
dealing with 55
[08:19:18] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  88%|████████▊ | 56/64 [2:00:20<59:57, 449.72s/it][A[ASelf.trainer.train duration: 579.4171 seconds
显存占用: 3852.72 MB, 已预留显存: 4292.00 MB
dealing with 56
[08:30:54] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  89%|████████▉ | 57/64 [2:12:17<59:17, 508.23s/it][A[ASelf.trainer.train duration: 597.7771 seconds
显存占用: 4195.33 MB, 已预留显存: 4662.00 MB
dealing with 57
[08:42:51] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  91%|█████████ | 58/64 [2:24:20<55:55, 559.28s/it][A[ASelf.trainer.train duration: 602.4529 seconds
显存占用: 4536.76 MB, 已预留显存: 5002.00 MB
dealing with 58
[08:54:53] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  92%|█████████▏| 59/64 [2:36:17<49:57, 599.50s/it][A[ASelf.trainer.train duration: 597.2863 seconds
显存占用: 4876.43 MB, 已预留显存: 5276.00 MB
dealing with 59
[09:06:51] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  94%|█████████▍| 60/64 [2:47:53<41:40, 625.06s/it][A[ASelf.trainer.train duration: 577.4706 seconds
显存占用: 5218.37 MB, 已预留显存: 5700.00 MB
dealing with 60
[09:18:27] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  95%|█████████▌| 61/64 [2:59:49<32:30, 650.12s/it][A[ASelf.trainer.train duration: 602.5878 seconds
显存占用: 5559.15 MB, 已预留显存: 6114.00 MB
dealing with 61
[09:30:23] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  97%|█████████▋| 62/64 [3:11:39<22:13, 666.98s/it][A[ASelf.trainer.train duration: 593.2243 seconds
显存占用: 5901.25 MB, 已预留显存: 6436.00 MB
dealing with 62
[09:42:12] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  98%|█████████▊| 63/64 [3:23:24<11:18, 678.11s/it][A[ASelf.trainer.train duration: 603.9982 seconds
显存占用: 6243.50 MB, 已预留显存: 6774.00 MB
dealing with 63
[09:53:58] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint: 100%|██████████| 64/64 [3:35:13<00:00, 686.98s/it][A[Aviewpoint: 100%|██████████| 64/64 [3:35:13<00:00, 201.77s/it]

Processing Models in pillow:   4%|▍         | 4/96 [3:35:37<82:39:23, 3234.38s/model][A/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tyro/_fields.py:1066: UserWarning: Mutable type <class 'config.EnvConfig'> is used as a default value for `env`. This is dangerous! Consider using `dataclasses.field(default_factory=...)` or marking <class 'config.EnvConfig'> as frozen.
  warnings.warn(
Self.trainer.train duration: 591.4474 seconds
显存占用: 6584.83 MB, 已预留显存: 7100.00 MB
pillow:/attached/data/remote-home2/zzq/data/shapenet/ShapeNetCore.v2/03938244/a0903daa3dfa996837b2bb75885cfc44


CUDA
Generating data for init
saving data to data/shapenet/init/transforms.json
[10:06:08] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Found 64 GT images, loading directly from /remote-home/zzq/data/ShapeNet/gt_shapenet/pillow/a0903daa3dfa996837b2bb75885cfc44
Loaded 64 GT images successfully!


viewpoint:   0%|          | 0/64 [00:00<?, ?it/s][A[Adealing with 0
[10:06:13] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
System is out of GPU memory

Refer to the Cycles GPU rendering documentation for possible solutions:
https://docs.blender.org/manual/en/latest/render/cycles/gpu_rendering.html

System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
viewpoint:   0%|          | 0/64 [00:04<?, ?it/s]

                                                                                     [AProcessing Categories:   0%|          | 0/55 [3:36:08<?, ?category/s]
Traceback (most recent call last):
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 240, in <module>
    distribution_dataset_construction(model_path, num_azimuth, num_elevation, radius, start_viewpoint_index, viewpoint_index_interval)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 160, in distribution_dataset_construction
    env.reset()
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_env.py", line 117, in reset
    np_images, transforms = self.get_images(mode='init')
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_env.py", line 129, in get_images
    return self.gen_data(mode, return_quat=return_quat)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_env.py", line 150, in gen_data
    image = self.scene.render_pose(pose)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_scene.py", line 215, in render_pose
    result = self.render() #
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_scene.py", line 566, in render
    return super().render()
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_scene.py", line 422, in render
    result = bpycv.render_data()
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/bpycv/render_utils.py", line 115, in render_data
    render_result["image"] = _render_image()
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/bpycv/render_utils.py", line 94, in render_image
    bpy.ops.render.render(write_still=True)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/bpy/3.6/scripts/modules/bpy/ops.py", line 113, in __call__
    ret = _op_call(self.idname_py(), None, kw)
RuntimeError: Error: System is out of GPU memory
Error: System is out of GPU memory

Iteration 25 completed

Iteration 26/30
Processing Categories:   0%|          | 0/55 [00:00<?, ?category/s]
Processing Models in pillow:   0%|          | 0/96 [00:00<?, ?model/s][A/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tyro/_fields.py:1066: UserWarning: Mutable type <class 'config.EnvConfig'> is used as a default value for `env`. This is dangerous! Consider using `dataclasses.field(default_factory=...)` or marking <class 'config.EnvConfig'> as frozen.
  warnings.warn(
pillow:/attached/data/remote-home2/zzq/data/shapenet/ShapeNetCore.v2/03938244/a0903daa3dfa996837b2bb75885cfc44


CUDA
Generating data for init
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/boxx/ylcompat.py:69: BoxxWarning: warning from boxx
    os.environ["DISPLAY"] is not found
    plt.show() are redirect to plt.savefig(tmp)
    function: show, loga, crun, heatmap, plot will be affected
  def __setDisplayEnv():
saving data to data/shapenet/init/transforms.json
[10:08:51] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Found 64 GT images, loading directly from /remote-home/zzq/data/ShapeNet/gt_shapenet/pillow/a0903daa3dfa996837b2bb75885cfc44
Loaded 64 GT images successfully!


viewpoint:   0%|          | 0/64 [00:00<?, ?it/s][A[Adealing with 0
[10:09:01] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:70: FutureWarning: Importing `spectral_angle_mapper` from `torchmetrics.functional` was deprecated and will be removed in 2.0. Import `spectral_angle_mapper` from `torchmetrics.image` instead.
  _future_warning(


viewpoint:   2%|▏         | 1/64 [15:05<15:50:37, 905.35s/it][A[ASelf.trainer.train duration: 757.4777 seconds
显存占用: 778.02 MB, 已预留显存: 1644.00 MB
dealing with 1
[10:24:06] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:   3%|▎         | 2/64 [29:51<15:23:47, 893.99s/it][A[ASelf.trainer.train duration: 740.3688 seconds
显存占用: 1118.47 MB, 已预留显存: 1922.00 MB
dealing with 2
[10:38:52] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:   5%|▍         | 3/64 [45:22<15:25:57, 910.78s/it][A[ASelf.trainer.train duration: 743.8089 seconds
显存占用: 1461.84 MB, 已预留显存: 2310.00 MB
dealing with 3
[10:54:23] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:   6%|▋         | 4/64 [59:15<14:40:04, 880.07s/it][A[ASelf.trainer.train duration: 696.9142 seconds
显存占用: 1802.06 MB, 已预留显存: 2328.00 MB
dealing with 4
[11:08:16] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:   8%|▊         | 5/64 [1:14:15<14:32:26, 887.23s/it][A[ASelf.trainer.train duration: 767.5141 seconds
显存占用: 2144.26 MB, 已预留显存: 3002.00 MB
dealing with 5
[11:23:16] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:   9%|▉         | 6/64 [1:29:40<14:30:17, 900.30s/it][A[ASelf.trainer.train duration: 793.1889 seconds
显存占用: 2487.16 MB, 已预留显存: 3520.00 MB
dealing with 6
[11:38:41] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  11%|█         | 7/64 [1:42:36<13:36:37, 859.61s/it][A[ASelf.trainer.train duration: 657.8784 seconds
显存占用: 2826.88 MB, 已预留显存: 3354.00 MB
dealing with 7
[11:51:37] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  12%|█▎        | 8/64 [1:56:03<13:06:34, 842.76s/it][A[ASelf.trainer.train duration: 681.7157 seconds
显存占用: 3168.54 MB, 已预留显存: 3738.00 MB
dealing with 8
[12:05:04] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  14%|█▍        | 9/64 [2:10:10<12:53:57, 844.32s/it][A[ASelf.trainer.train duration: 699.6395 seconds
显存占用: 3509.20 MB, 已预留显存: 4258.00 MB
dealing with 9
[12:19:12] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  16%|█▌        | 10/64 [2:25:07<12:54:17, 860.32s/it][A[ASelf.trainer.train duration: 756.7979 seconds
显存占用: 3850.13 MB, 已预留显存: 4678.00 MB
dealing with 10
[12:34:08] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  17%|█▋        | 11/64 [2:39:16<12:37:00, 857.00s/it][A[ASelf.trainer.train duration: 717.3367 seconds
显存占用: 4191.65 MB, 已预留显存: 4948.00 MB
dealing with 11
[12:48:17] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  19%|█▉        | 12/64 [2:53:48<12:26:45, 861.64s/it][A[ASelf.trainer.train duration: 736.6018 seconds
显存占用: 4533.52 MB, 已预留显存: 5278.00 MB
dealing with 12
[13:02:50] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  20%|██        | 13/64 [3:07:08<11:56:26, 842.88s/it][A[ASelf.trainer.train duration: 670.8497 seconds
显存占用: 4874.05 MB, 已预留显存: 5456.00 MB
dealing with 13
[13:16:09] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  22%|██▏       | 14/64 [3:20:35<11:33:21, 832.03s/it][A[ASelf.trainer.train duration: 663.1616 seconds
显存占用: 5217.02 MB, 已预留显存: 5894.00 MB
dealing with 14
[13:29:36] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  23%|██▎       | 15/64 [3:34:11<11:15:29, 827.13s/it][A[ASelf.trainer.train duration: 685.1115 seconds
显存占用: 5559.12 MB, 已预留显存: 6266.00 MB
dealing with 15
[13:43:12] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json
viewpoint:  23%|██▎       | 15/64 [3:35:36<11:44:18, 862.42s/it]

                                                                      [AProcessing Categories:   0%|          | 0/55 [3:36:18<?, ?category/s]
Traceback (most recent call last):
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 240, in <module>
    distribution_dataset_construction(model_path, num_azimuth, num_elevation, radius, start_viewpoint_index, viewpoint_index_interval)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 164, in distribution_dataset_construction
    NeRF_pipeline.add_image(images=obs,poses=input_pose,model_option=None)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nvf/active_mapping/active_mapping.py", line 233, in add_image
    self.trainer.train()
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nvf/nerfstudio_interface/nbv_trainer.py", line 213, in train
    loss, loss_dict, metrics_dict = self.train_iteration(step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/utils/profiler.py", line 127, in inner
    out = func(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/engine/trainer.py", line 740, in train_iteration
    _, loss_dict, metrics_dict = self.pipeline.get_train_loss_dict(step=step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/pipelines/dynamic_batch.py", line 91, in get_train_loss_dict
    model_outputs, loss_dict, metrics_dict = super().get_train_loss_dict(step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/utils/profiler.py", line 127, in inner
    out = func(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/pipelines/base_pipeline.py", line 284, in get_train_loss_dict
    model_outputs = self._model(ray_bundle)  # train distributed data parallel model if world_size > 1
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/models/base_model.py", line 142, in forward
    return self.get_outputs(ray_bundle)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/models/instant_ngp.py", line 302, in get_outputs
    ray_samples, ray_indices = self.sampler(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/model_components/ray_samplers.py", line 482, in forward
    ray_indices, starts, ends = self.occupancy_grid.sampling(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/nerfacc/estimators/occ_grid.py", line 192, in sampling
    sigmas = sigma_fn(t_starts, t_ends, ray_indices)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/model_components/ray_samplers.py", line 428, in sigma_fn
    return density_fn(positions).squeeze(-1)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/fields/base_field.py", line 67, in density_fn
    density, _ = self.get_density(ray_samples)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/fields/nerfacto_field.py", line 252, in get_density
    h = self.mlp_base(positions_flat).view(*ray_samples.frustums.shape, -1)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/field_components/mlp.py", line 177, in forward
    return self.tcnn_encoding(in_tensor)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tinycudann/modules.py", line 190, in forward
    output = _module_function.apply(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/autograd/function.py", line 506, in apply
    return super().apply(*args, **kwargs)  # type: ignore[misc]
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tinycudann/modules.py", line 102, in forward
    native_ctx, output = native_tcnn_module.fwd(input, params)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 140.00 MiB (GPU 0; 23.68 GiB total capacity; 7.33 GiB already allocated; 99.75 MiB free; 7.71 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
Iteration 26 completed

Iteration 27/30
Processing Categories:   0%|          | 0/55 [00:00<?, ?category/s]
Processing Models in pillow:   0%|          | 0/96 [00:00<?, ?model/s][A/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tyro/_fields.py:1066: UserWarning: Mutable type <class 'config.EnvConfig'> is used as a default value for `env`. This is dangerous! Consider using `dataclasses.field(default_factory=...)` or marking <class 'config.EnvConfig'> as frozen.
  warnings.warn(
pillow:/attached/data/remote-home2/zzq/data/shapenet/ShapeNetCore.v2/03938244/a0903daa3dfa996837b2bb75885cfc44


CUDA
Generating data for init
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/boxx/ylcompat.py:69: BoxxWarning: warning from boxx
    os.environ["DISPLAY"] is not found
    plt.show() are redirect to plt.savefig(tmp)
    function: show, loga, crun, heatmap, plot will be affected
  def __setDisplayEnv():
saving data to data/shapenet/init/transforms.json
[13:47:15] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Found 64 GT images, loading directly from /remote-home/zzq/data/ShapeNet/gt_shapenet/pillow/a0903daa3dfa996837b2bb75885cfc44
Loaded 64 GT images successfully!


viewpoint:   0%|          | 0/64 [00:00<?, ?it/s][A[Adealing with 15
[13:47:23] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:70: FutureWarning: Importing `spectral_angle_mapper` from `torchmetrics.functional` was deprecated and will be removed in 2.0. Import `spectral_angle_mapper` from `torchmetrics.image` instead.
  _future_warning(


viewpoint:  25%|██▌       | 16/64 [14:42<44:07, 55.15s/it][A[ASelf.trainer.train duration: 752.0706 seconds
显存占用: 778.14 MB, 已预留显存: 1516.00 MB
dealing with 16
[14:02:06] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  27%|██▋       | 17/64 [29:15<1:35:42, 122.17s/it][A[ASelf.trainer.train duration: 764.7716 seconds
显存占用: 1119.20 MB, 已预留显存: 1772.00 MB
dealing with 17
[14:16:38] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  28%|██▊       | 18/64 [44:28<2:37:13, 205.09s/it][A[ASelf.trainer.train duration: 773.6751 seconds
显存占用: 1461.83 MB, 已预留显存: 2128.00 MB
dealing with 18
[14:31:52] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  30%|██▉       | 19/64 [59:23<3:41:13, 294.96s/it][A[ASelf.trainer.train duration: 764.0146 seconds
显存占用: 1803.40 MB, 已预留显存: 2516.00 MB
dealing with 19
[14:46:47] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  31%|███▏      | 20/64 [1:12:55<4:35:44, 376.00s/it][A[ASelf.trainer.train duration: 648.5010 seconds
显存占用: 2143.61 MB, 已预留显存: 2624.00 MB
dealing with 20
[15:00:18] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  33%|███▎      | 21/64 [1:27:02<5:31:20, 462.34s/it][A[ASelf.trainer.train duration: 715.5760 seconds
显存占用: 2486.59 MB, 已预留显存: 3142.00 MB
dealing with 21
[15:14:26] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  34%|███▍      | 22/64 [1:41:11<6:19:46, 542.54s/it][A[ASelf.trainer.train duration: 720.2774 seconds
显存占用: 2828.84 MB, 已预留显存: 3370.00 MB
dealing with 22
[15:28:35] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  36%|███▌      | 23/64 [1:55:04<6:56:01, 608.81s/it][A[ASelf.trainer.train duration: 682.4200 seconds
显存占用: 3171.18 MB, 已预留显存: 3740.00 MB
dealing with 23
[15:42:28] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  38%|███▊      | 24/64 [2:09:08<7:24:30, 666.77s/it][A[ASelf.trainer.train duration: 708.1583 seconds
显存占用: 3512.42 MB, 已预留显存: 4126.00 MB
dealing with 24
[15:56:32] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  39%|███▉      | 25/64 [2:23:57<7:50:58, 724.57s/it][A[ASelf.trainer.train duration: 721.3608 seconds
显存占用: 3857.40 MB, 已预留显存: 4408.00 MB
dealing with 25
[16:11:21] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json
viewpoint:  39%|███▉      | 25/64 [2:26:03<3:47:50, 350.53s/it]

                                                                      [AProcessing Categories:   0%|          | 0/55 [2:26:46<?, ?category/s]
Traceback (most recent call last):
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 240, in <module>
    distribution_dataset_construction(model_path, num_azimuth, num_elevation, radius, start_viewpoint_index, viewpoint_index_interval)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 164, in distribution_dataset_construction
    NeRF_pipeline.add_image(images=obs,poses=input_pose,model_option=None)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nvf/active_mapping/active_mapping.py", line 233, in add_image
    self.trainer.train()
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nvf/nerfstudio_interface/nbv_trainer.py", line 213, in train
    loss, loss_dict, metrics_dict = self.train_iteration(step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/utils/profiler.py", line 127, in inner
    out = func(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/engine/trainer.py", line 740, in train_iteration
    _, loss_dict, metrics_dict = self.pipeline.get_train_loss_dict(step=step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/pipelines/dynamic_batch.py", line 91, in get_train_loss_dict
    model_outputs, loss_dict, metrics_dict = super().get_train_loss_dict(step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/utils/profiler.py", line 127, in inner
    out = func(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/pipelines/base_pipeline.py", line 284, in get_train_loss_dict
    model_outputs = self._model(ray_bundle)  # train distributed data parallel model if world_size > 1
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/models/base_model.py", line 142, in forward
    return self.get_outputs(ray_bundle)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/models/instant_ngp.py", line 302, in get_outputs
    ray_samples, ray_indices = self.sampler(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/model_components/ray_samplers.py", line 482, in forward
    ray_indices, starts, ends = self.occupancy_grid.sampling(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/nerfacc/estimators/occ_grid.py", line 192, in sampling
    sigmas = sigma_fn(t_starts, t_ends, ray_indices)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/model_components/ray_samplers.py", line 428, in sigma_fn
    return density_fn(positions).squeeze(-1)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/fields/base_field.py", line 67, in density_fn
    density, _ = self.get_density(ray_samples)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/fields/nerfacto_field.py", line 252, in get_density
    h = self.mlp_base(positions_flat).view(*ray_samples.frustums.shape, -1)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/field_components/mlp.py", line 177, in forward
    return self.tcnn_encoding(in_tensor)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tinycudann/modules.py", line 190, in forward
    output = _module_function.apply(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/autograd/function.py", line 506, in apply
    return super().apply(*args, **kwargs)  # type: ignore[misc]
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tinycudann/modules.py", line 102, in forward
    native_ctx, output = native_tcnn_module.fwd(input, params)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 218.00 MiB (GPU 0; 23.68 GiB total capacity; 6.49 GiB already allocated; 159.75 MiB free; 6.68 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
Iteration 27 completed

Iteration 28/30
Processing Categories:   0%|          | 0/55 [00:00<?, ?category/s]
Processing Models in pillow:   0%|          | 0/96 [00:00<?, ?model/s][A/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tyro/_fields.py:1066: UserWarning: Mutable type <class 'config.EnvConfig'> is used as a default value for `env`. This is dangerous! Consider using `dataclasses.field(default_factory=...)` or marking <class 'config.EnvConfig'> as frozen.
  warnings.warn(
pillow:/attached/data/remote-home2/zzq/data/shapenet/ShapeNetCore.v2/03938244/a0903daa3dfa996837b2bb75885cfc44


CUDA
Generating data for init
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/boxx/ylcompat.py:69: BoxxWarning: warning from boxx
    os.environ["DISPLAY"] is not found
    plt.show() are redirect to plt.savefig(tmp)
    function: show, loga, crun, heatmap, plot will be affected
  def __setDisplayEnv():
saving data to data/shapenet/init/transforms.json
[16:15:53] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Found 64 GT images, loading directly from /remote-home/zzq/data/ShapeNet/gt_shapenet/pillow/a0903daa3dfa996837b2bb75885cfc44
Loaded 64 GT images successfully!


viewpoint:   0%|          | 0/64 [00:00<?, ?it/s][A[Adealing with 25
[16:16:02] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:70: FutureWarning: Importing `spectral_angle_mapper` from `torchmetrics.functional` was deprecated and will be removed in 2.0. Import `spectral_angle_mapper` from `torchmetrics.image` instead.
  _future_warning(


viewpoint:  41%|████      | 26/64 [12:20<18:02, 28.49s/it][A[ASelf.trainer.train duration: 623.7507 seconds
显存占用: 778.98 MB, 已预留显存: 1316.00 MB
dealing with 26
[16:28:23] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  42%|████▏     | 27/64 [26:58<44:51, 72.75s/it][A[ASelf.trainer.train duration: 738.8959 seconds
显存占用: 1120.31 MB, 已预留显存: 1710.00 MB
dealing with 27
[16:43:01] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  44%|████▍     | 28/64 [41:31<1:16:53, 128.16s/it][A[ASelf.trainer.train duration: 723.0086 seconds
显存占用: 1461.96 MB, 已预留显存: 2154.00 MB
dealing with 28
[16:57:34] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  45%|████▌     | 29/64 [55:05<1:50:46, 189.90s/it][A[ASelf.trainer.train duration: 673.2777 seconds
显存占用: 1804.38 MB, 已预留显存: 2326.00 MB
dealing with 29
[17:11:08] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  47%|████▋     | 30/64 [1:09:22<2:30:41, 265.93s/it][A[ASelf.trainer.train duration: 728.0375 seconds
显存占用: 2146.52 MB, 已预留显存: 2758.00 MB
dealing with 30
[17:25:25] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  48%|████▊     | 31/64 [1:24:41<3:16:29, 357.26s/it][A[ASelf.trainer.train duration: 771.7964 seconds
显存占用: 2487.19 MB, 已预留显存: 3064.00 MB
dealing with 31
[17:40:44] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  50%|█████     | 32/64 [1:38:14<3:51:03, 433.24s/it][A[ASelf.trainer.train duration: 693.6086 seconds
显存占用: 2828.10 MB, 已预留显存: 3266.00 MB
dealing with 32
[17:54:17] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  52%|█████▏    | 33/64 [1:51:22<4:19:06, 501.52s/it][A[ASelf.trainer.train duration: 649.8756 seconds
显存占用: 3171.21 MB, 已预留显存: 3766.00 MB
dealing with 33
[18:07:25] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  53%|█████▎    | 34/64 [2:05:31<4:48:14, 576.47s/it][A[ASelf.trainer.train duration: 700.5876 seconds
显存占用: 3511.82 MB, 已预留显存: 4054.00 MB
dealing with 34
[18:21:34] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  55%|█████▍    | 35/64 [2:19:23<5:07:37, 636.46s/it][A[ASelf.trainer.train duration: 700.0413 seconds
显存占用: 3853.19 MB, 已预留显存: 4416.00 MB
dealing with 35
[18:35:26] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  56%|█████▋    | 36/64 [2:32:51<5:17:12, 679.74s/it][A[ASelf.trainer.train duration: 668.5209 seconds
显存占用: 4197.15 MB, 已预留显存: 4762.00 MB
dealing with 36
[18:48:54] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json
viewpoint:  56%|█████▋    | 36/64 [2:35:04<2:00:36, 258.46s/it]

                                                                      [AProcessing Categories:   0%|          | 0/55 [2:35:47<?, ?category/s]
Traceback (most recent call last):
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 240, in <module>
    distribution_dataset_construction(model_path, num_azimuth, num_elevation, radius, start_viewpoint_index, viewpoint_index_interval)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 164, in distribution_dataset_construction
    NeRF_pipeline.add_image(images=obs,poses=input_pose,model_option=None)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nvf/active_mapping/active_mapping.py", line 233, in add_image
    self.trainer.train()
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nvf/nerfstudio_interface/nbv_trainer.py", line 213, in train
    loss, loss_dict, metrics_dict = self.train_iteration(step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/utils/profiler.py", line 127, in inner
    out = func(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/engine/trainer.py", line 740, in train_iteration
    _, loss_dict, metrics_dict = self.pipeline.get_train_loss_dict(step=step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/pipelines/dynamic_batch.py", line 91, in get_train_loss_dict
    model_outputs, loss_dict, metrics_dict = super().get_train_loss_dict(step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/utils/profiler.py", line 127, in inner
    out = func(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/pipelines/base_pipeline.py", line 284, in get_train_loss_dict
    model_outputs = self._model(ray_bundle)  # train distributed data parallel model if world_size > 1
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/models/base_model.py", line 142, in forward
    return self.get_outputs(ray_bundle)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/models/instant_ngp.py", line 302, in get_outputs
    ray_samples, ray_indices = self.sampler(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/model_components/ray_samplers.py", line 482, in forward
    ray_indices, starts, ends = self.occupancy_grid.sampling(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/nerfacc/estimators/occ_grid.py", line 192, in sampling
    sigmas = sigma_fn(t_starts, t_ends, ray_indices)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/model_components/ray_samplers.py", line 428, in sigma_fn
    return density_fn(positions).squeeze(-1)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/fields/base_field.py", line 67, in density_fn
    density, _ = self.get_density(ray_samples)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/fields/nerfacto_field.py", line 252, in get_density
    h = self.mlp_base(positions_flat).view(*ray_samples.frustums.shape, -1)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/field_components/mlp.py", line 177, in forward
    return self.tcnn_encoding(in_tensor)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tinycudann/modules.py", line 190, in forward
    output = _module_function.apply(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/autograd/function.py", line 506, in apply
    return super().apply(*args, **kwargs)  # type: ignore[misc]
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tinycudann/modules.py", line 102, in forward
    native_ctx, output = native_tcnn_module.fwd(input, params)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 194.00 MiB (GPU 0; 23.68 GiB total capacity; 6.56 GiB already allocated; 165.75 MiB free; 6.84 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
Iteration 28 completed

Iteration 29/30
Processing Categories:   0%|          | 0/55 [00:00<?, ?category/s]
Processing Models in pillow:   0%|          | 0/96 [00:00<?, ?model/s][A/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tyro/_fields.py:1066: UserWarning: Mutable type <class 'config.EnvConfig'> is used as a default value for `env`. This is dangerous! Consider using `dataclasses.field(default_factory=...)` or marking <class 'config.EnvConfig'> as frozen.
  warnings.warn(
pillow:/attached/data/remote-home2/zzq/data/shapenet/ShapeNetCore.v2/03938244/a0903daa3dfa996837b2bb75885cfc44


CUDA
Generating data for init
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/boxx/ylcompat.py:69: BoxxWarning: warning from boxx
    os.environ["DISPLAY"] is not found
    plt.show() are redirect to plt.savefig(tmp)
    function: show, loga, crun, heatmap, plot will be affected
  def __setDisplayEnv():
saving data to data/shapenet/init/transforms.json
[18:53:32] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Found 64 GT images, loading directly from /remote-home/zzq/data/ShapeNet/gt_shapenet/pillow/a0903daa3dfa996837b2bb75885cfc44
Loaded 64 GT images successfully!


viewpoint:   0%|          | 0/64 [00:00<?, ?it/s][A[Adealing with 36
[18:53:41] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:70: FutureWarning: Importing `spectral_angle_mapper` from `torchmetrics.functional` was deprecated and will be removed in 2.0. Import `spectral_angle_mapper` from `torchmetrics.image` instead.
  _future_warning(


viewpoint:  58%|█████▊    | 37/64 [14:28<10:33, 23.47s/it][A[ASelf.trainer.train duration: 710.0610 seconds
显存占用: 776.67 MB, 已预留显存: 1184.00 MB
dealing with 37
[19:08:09] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  59%|█████▉    | 38/64 [28:35<23:26, 54.10s/it][A[ASelf.trainer.train duration: 730.2419 seconds
显存占用: 1119.66 MB, 已预留显存: 1570.00 MB
dealing with 38
[19:22:16] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  61%|██████    | 39/64 [43:09<39:46, 95.45s/it][A[ASelf.trainer.train duration: 750.2762 seconds
显存占用: 1462.55 MB, 已预留显存: 2032.00 MB
dealing with 39
[19:36:50] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  62%|██████▎   | 40/64 [56:41<57:25, 143.58s/it][A[ASelf.trainer.train duration: 688.5533 seconds
显存占用: 1805.08 MB, 已预留显存: 2312.00 MB
dealing with 40
[19:50:22] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  64%|██████▍   | 41/64 [1:08:45<1:14:31, 194.43s/it][A[ASelf.trainer.train duration: 586.1421 seconds
显存占用: 2145.00 MB, 已预留显存: 2692.00 MB
dealing with 41
[20:02:26] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  66%|██████▌   | 42/64 [1:20:16<1:31:31, 249.60s/it][A[ASelf.trainer.train duration: 563.7070 seconds
显存占用: 2486.07 MB, 已预留显存: 2940.00 MB
dealing with 42
[20:13:57] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  67%|██████▋   | 43/64 [1:34:18<1:55:48, 330.88s/it][A[ASelf.trainer.train duration: 708.8936 seconds
显存占用: 2828.97 MB, 已预留显存: 3532.00 MB
dealing with 43
[20:27:59] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  69%|██████▉   | 44/64 [1:48:16<2:17:58, 413.91s/it][A[ASelf.trainer.train duration: 703.3956 seconds
显存占用: 3169.56 MB, 已预留显存: 3906.00 MB
dealing with 44
[20:41:57] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  70%|███████   | 45/64 [2:01:05<2:32:22, 481.20s/it][A[ASelf.trainer.train duration: 624.1133 seconds
显存占用: 3511.29 MB, 已预留显存: 4020.00 MB
dealing with 45
[20:54:46] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  72%|███████▏  | 46/64 [2:13:07<2:39:46, 532.58s/it][A[ASelf.trainer.train duration: 606.3407 seconds
显存占用: 3852.87 MB, 已预留显存: 4448.00 MB
dealing with 46
[21:06:48] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  73%|███████▎  | 47/64 [2:26:04<2:47:04, 589.67s/it][A[ASelf.trainer.train duration: 627.5215 seconds
显存占用: 4194.42 MB, 已预留显存: 4850.00 MB
dealing with 47
[21:19:45] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  75%|███████▌  | 48/64 [2:38:20<2:47:00, 626.29s/it][A[ASelf.trainer.train duration: 607.9106 seconds
显存占用: 4537.74 MB, 已预留显存: 5202.00 MB
dealing with 48
[21:32:01] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  77%|███████▋  | 49/64 [2:48:30<2:35:29, 621.94s/it][A[ASelf.trainer.train duration: 474.1347 seconds
显存占用: 4880.13 MB, 已预留显存: 5454.00 MB
dealing with 49
[21:42:11] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  78%|███████▊  | 50/64 [3:00:29<2:31:18, 648.43s/it][A[ASelf.trainer.train duration: 516.6042 seconds
显存占用: 5221.42 MB, 已预留显存: 5934.00 MB
dealing with 50
[21:54:10] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
System is out of GPU memory

Refer to the Cycles GPU rendering documentation for possible solutions:
https://docs.blender.org/manual/en/latest/render/cycles/gpu_rendering.html

System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
viewpoint:  78%|███████▊  | 50/64 [3:00:33<50:33, 216.68s/it]  

                                                                      [AProcessing Categories:   0%|          | 0/55 [3:01:04<?, ?category/s]
Traceback (most recent call last):
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 240, in <module>
    distribution_dataset_construction(model_path, num_azimuth, num_elevation, radius, start_viewpoint_index, viewpoint_index_interval)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 160, in distribution_dataset_construction
    env.reset()
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_env.py", line 117, in reset
    np_images, transforms = self.get_images(mode='init')
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_env.py", line 129, in get_images
    return self.gen_data(mode, return_quat=return_quat)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_env.py", line 150, in gen_data
    image = self.scene.render_pose(pose)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_scene.py", line 215, in render_pose
    result = self.render() #
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_scene.py", line 566, in render
    return super().render()
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_scene.py", line 422, in render
    result = bpycv.render_data()
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/bpycv/render_utils.py", line 115, in render_data
    render_result["image"] = _render_image()
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/bpycv/render_utils.py", line 94, in render_image
    bpy.ops.render.render(write_still=True)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/bpy/3.6/scripts/modules/bpy/ops.py", line 113, in __call__
    ret = _op_call(self.idname_py(), None, kw)
RuntimeError: Error: System is out of GPU memory
Error: System is out of GPU memory

Iteration 29 completed

Iteration 30/30
Processing Categories:   0%|          | 0/55 [00:00<?, ?category/s]
Processing Models in pillow:   0%|          | 0/96 [00:00<?, ?model/s][A/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tyro/_fields.py:1066: UserWarning: Mutable type <class 'config.EnvConfig'> is used as a default value for `env`. This is dangerous! Consider using `dataclasses.field(default_factory=...)` or marking <class 'config.EnvConfig'> as frozen.
  warnings.warn(
pillow:/attached/data/remote-home2/zzq/data/shapenet/ShapeNetCore.v2/03938244/a0903daa3dfa996837b2bb75885cfc44


CUDA
Generating data for init
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/boxx/ylcompat.py:69: BoxxWarning: warning from boxx
    os.environ["DISPLAY"] is not found
    plt.show() are redirect to plt.savefig(tmp)
    function: show, loga, crun, heatmap, plot will be affected
  def __setDisplayEnv():
saving data to data/shapenet/init/transforms.json
[21:56:58] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Found 64 GT images, loading directly from /remote-home/zzq/data/ShapeNet/gt_shapenet/pillow/a0903daa3dfa996837b2bb75885cfc44
Loaded 64 GT images successfully!


viewpoint:   0%|          | 0/64 [00:00<?, ?it/s][A[Adealing with 50
[21:57:06] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:70: FutureWarning: Importing `spectral_angle_mapper` from `torchmetrics.functional` was deprecated and will be removed in 2.0. Import `spectral_angle_mapper` from `torchmetrics.image` instead.
  _future_warning(


viewpoint:  80%|███████▉  | 51/64 [11:23<02:54, 13.40s/it][A[ASelf.trainer.train duration: 549.6118 seconds
显存占用: 778.05 MB, 已预留显存: 1358.00 MB
dealing with 51
[22:08:29] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  81%|████████▏ | 52/64 [22:41<06:18, 31.52s/it][A[ASelf.trainer.train duration: 535.1480 seconds
显存占用: 1118.19 MB, 已预留显存: 1548.00 MB
dealing with 52
[22:19:48] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  83%|████████▎ | 53/64 [32:45<09:42, 52.96s/it][A[ASelf.trainer.train duration: 486.3384 seconds
显存占用: 1460.08 MB, 已预留显存: 1924.00 MB
dealing with 53
[22:29:51] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  84%|████████▍ | 54/64 [43:18<13:44, 82.43s/it][A[ASelf.trainer.train duration: 487.2560 seconds
显存占用: 1802.85 MB, 已预留显存: 2232.00 MB
dealing with 54
[22:40:24] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  86%|████████▌ | 55/64 [53:08<17:30, 116.76s/it][A[ASelf.trainer.train duration: 473.0773 seconds
显存占用: 2143.92 MB, 已预留显存: 2612.00 MB
dealing with 55
[22:50:14] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  88%|████████▊ | 56/64 [1:03:32<21:31, 161.45s/it][A[ASelf.trainer.train duration: 482.8776 seconds
显存占用: 2485.41 MB, 已预留显存: 2936.00 MB
dealing with 56
[23:00:38] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  89%|████████▉ | 57/64 [1:13:44<24:43, 211.94s/it][A[ASelf.trainer.train duration: 475.1772 seconds
显存占用: 2827.49 MB, 已预留显存: 3280.00 MB
dealing with 57
[23:10:51] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  91%|█████████ | 58/64 [1:24:11<26:54, 269.03s/it][A[ASelf.trainer.train duration: 510.9073 seconds
显存占用: 3168.58 MB, 已预留显存: 3722.00 MB
dealing with 58
[23:21:17] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  92%|█████████▏| 59/64 [1:34:21<27:05, 325.17s/it][A[ASelf.trainer.train duration: 474.8014 seconds
显存占用: 3510.04 MB, 已预留显存: 4056.00 MB
dealing with 59
[23:31:27] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  94%|█████████▍| 60/64 [1:44:17<25:06, 376.67s/it][A[ASelf.trainer.train duration: 470.4657 seconds
显存占用: 3853.22 MB, 已预留显存: 4366.00 MB
dealing with 60
[23:41:23] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  95%|█████████▌| 61/64 [1:54:55<21:37, 432.59s/it][A[ASelf.trainer.train duration: 493.2259 seconds
显存占用: 4192.99 MB, 已预留显存: 4842.00 MB
dealing with 61
[23:52:02] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  97%|█████████▋| 62/64 [2:05:26<15:57, 478.91s/it][A[ASelf.trainer.train duration: 492.3220 seconds
显存占用: 4533.99 MB, 已预留显存: 5100.00 MB
dealing with 62
[00:02:32] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  98%|█████████▊| 63/64 [2:16:01<08:37, 517.96s/it][A[ASelf.trainer.train duration: 496.9859 seconds
显存占用: 4876.76 MB, 已预留显存: 5526.00 MB
dealing with 63
[00:13:07] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint: 100%|██████████| 64/64 [2:25:59<00:00, 539.11s/it][A[Aviewpoint: 100%|██████████| 64/64 [2:25:59<00:00, 136.87s/it]

Processing Models in pillow:   5%|▌         | 5/96 [2:26:36<44:28:15, 1759.29s/model][A/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tyro/_fields.py:1066: UserWarning: Mutable type <class 'config.EnvConfig'> is used as a default value for `env`. This is dangerous! Consider using `dataclasses.field(default_factory=...)` or marking <class 'config.EnvConfig'> as frozen.
  warnings.warn(
Self.trainer.train duration: 472.4345 seconds
显存占用: 5217.92 MB, 已预留显存: 5792.00 MB
pillow:/attached/data/remote-home2/zzq/data/shapenet/ShapeNetCore.v2/03938244/9451f92833603bd3630771196b76eab9


CUDA
Generating data for init
saving data to data/shapenet/init/transforms.json
[00:23:31] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Found 64 GT images, loading directly from /remote-home/zzq/data/ShapeNet/gt_shapenet/pillow/9451f92833603bd3630771196b76eab9
Loaded 64 GT images successfully!


viewpoint:   0%|          | 0/64 [00:00<?, ?it/s][A[Adealing with 0
[00:23:35] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:   2%|▏         | 1/64 [11:23<11:58:04, 683.88s/it][A[ASelf.trainer.train duration: 547.4066 seconds
显存占用: 5782.03 MB, 已预留显存: 6586.00 MB
dealing with 1
[00:34:59] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:   3%|▎         | 2/64 [22:12<11:25:31, 663.41s/it][A[ASelf.trainer.train duration: 526.5295 seconds
显存占用: 6122.79 MB, 已预留显存: 6786.00 MB
dealing with 2
[00:45:48] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:   5%|▍         | 3/64 [33:03<11:08:16, 657.32s/it][A[ASelf.trainer.train duration: 526.7407 seconds
显存占用: 6465.20 MB, 已预留显存: 7108.00 MB
dealing with 3
[00:56:38] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
System is out of GPU memory

Refer to the Cycles GPU rendering documentation for possible solutions:
https://docs.blender.org/manual/en/latest/render/cycles/gpu_rendering.html

System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
viewpoint:   5%|▍         | 3/64 [33:06<11:13:18, 662.27s/it]

                                                                                     [AProcessing Categories:   0%|          | 0/55 [3:00:12<?, ?category/s]
Traceback (most recent call last):
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 240, in <module>
    distribution_dataset_construction(model_path, num_azimuth, num_elevation, radius, start_viewpoint_index, viewpoint_index_interval)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 160, in distribution_dataset_construction
    env.reset()
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_env.py", line 117, in reset
    np_images, transforms = self.get_images(mode='init')
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_env.py", line 129, in get_images
    return self.gen_data(mode, return_quat=return_quat)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_env.py", line 150, in gen_data
    image = self.scene.render_pose(pose)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_scene.py", line 215, in render_pose
    result = self.render() #
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_scene.py", line 566, in render
    return super().render()
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_scene.py", line 422, in render
    result = bpycv.render_data()
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/bpycv/render_utils.py", line 115, in render_data
    render_result["image"] = _render_image()
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/bpycv/render_utils.py", line 94, in render_image
    bpy.ops.render.render(write_still=True)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/bpy/3.6/scripts/modules/bpy/ops.py", line 113, in __call__
    ret = _op_call(self.idname_py(), None, kw)
RuntimeError: Error: System is out of GPU memory
Error: System is out of GPU memory

Iteration 30 completed

Iteration 31/30
Processing Categories:   0%|          | 0/55 [00:00<?, ?category/s]
Processing Models in pillow:   0%|          | 0/96 [00:00<?, ?model/s][A/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tyro/_fields.py:1066: UserWarning: Mutable type <class 'config.EnvConfig'> is used as a default value for `env`. This is dangerous! Consider using `dataclasses.field(default_factory=...)` or marking <class 'config.EnvConfig'> as frozen.
  warnings.warn(
pillow:/attached/data/remote-home2/zzq/data/shapenet/ShapeNetCore.v2/03938244/9451f92833603bd3630771196b76eab9


CUDA
Generating data for init
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/boxx/ylcompat.py:69: BoxxWarning: warning from boxx
    os.environ["DISPLAY"] is not found
    plt.show() are redirect to plt.savefig(tmp)
    function: show, loga, crun, heatmap, plot will be affected
  def __setDisplayEnv():
saving data to data/shapenet/init/transforms.json
[00:59:08] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Found 64 GT images, loading directly from /remote-home/zzq/data/ShapeNet/gt_shapenet/pillow/9451f92833603bd3630771196b76eab9
Loaded 64 GT images successfully!


viewpoint:   0%|          | 0/64 [00:00<?, ?it/s][A[Adealing with 3
[00:59:16] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:70: FutureWarning: Importing `spectral_angle_mapper` from `torchmetrics.functional` was deprecated and will be removed in 2.0. Import `spectral_angle_mapper` from `torchmetrics.image` instead.
  _future_warning(


viewpoint:   6%|▋         | 4/64 [10:49<2:42:28, 162.48s/it][A[ASelf.trainer.train duration: 520.2483 seconds
显存占用: 776.23 MB, 已预留显存: 1198.00 MB
dealing with 4
[01:10:06] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:   8%|▊         | 5/64 [21:30<4:43:34, 288.37s/it][A[ASelf.trainer.train duration: 525.7098 seconds
显存占用: 1118.23 MB, 已预留显存: 1564.00 MB
dealing with 5
[01:20:47] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:   9%|▉         | 6/64 [32:07<6:10:43, 383.51s/it][A[ASelf.trainer.train duration: 538.5948 seconds
显存占用: 1459.78 MB, 已预留显存: 2054.00 MB
dealing with 6
[01:31:23] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  11%|█         | 7/64 [43:03<7:17:02, 460.04s/it][A[ASelf.trainer.train duration: 524.5698 seconds
显存占用: 1800.72 MB, 已预留显存: 2316.00 MB
dealing with 7
[01:42:19] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  12%|█▎        | 8/64 [53:35<7:55:23, 509.34s/it][A[ASelf.trainer.train duration: 523.4468 seconds
显存占用: 2142.61 MB, 已预留显存: 2668.00 MB
dealing with 8
[01:52:52] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  14%|█▍        | 9/64 [1:05:13<8:36:59, 564.00s/it][A[ASelf.trainer.train duration: 567.7437 seconds
显存占用: 2484.48 MB, 已预留显存: 3078.00 MB
dealing with 9
[02:04:29] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  16%|█▌        | 10/64 [1:16:05<8:50:42, 589.67s/it][A[ASelf.trainer.train duration: 529.5333 seconds
显存占用: 2825.94 MB, 已预留显存: 3418.00 MB
dealing with 10
[02:15:21] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  17%|█▋        | 11/64 [1:26:46<8:54:20, 604.92s/it][A[ASelf.trainer.train duration: 521.0508 seconds
显存占用: 3167.55 MB, 已预留显存: 3690.00 MB
dealing with 11
[02:26:02] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  19%|█▉        | 12/64 [1:38:24<9:08:07, 632.46s/it][A[ASelf.trainer.train duration: 582.5278 seconds
显存占用: 3510.47 MB, 已预留显存: 4294.00 MB
dealing with 12
[02:37:40] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  20%|██        | 13/64 [1:49:25<9:04:51, 641.01s/it][A[ASelf.trainer.train duration: 543.4773 seconds
显存占用: 3854.02 MB, 已预留显存: 4504.00 MB
dealing with 13
[02:48:41] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  22%|██▏       | 14/64 [2:00:57<9:06:48, 656.17s/it][A[ASelf.trainer.train duration: 571.0820 seconds
显存占用: 4195.61 MB, 已预留显存: 5018.00 MB
dealing with 14
[03:00:13] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  23%|██▎       | 15/64 [2:11:46<8:54:07, 654.03s/it][A[ASelf.trainer.train duration: 515.0162 seconds
显存占用: 4536.32 MB, 已预留显存: 5082.00 MB
dealing with 15
[03:11:02] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  25%|██▌       | 16/64 [2:22:43<8:44:00, 655.01s/it][A[ASelf.trainer.train duration: 536.0345 seconds
显存占用: 4879.38 MB, 已预留显存: 5438.00 MB
dealing with 16
[03:21:59] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  27%|██▋       | 17/64 [2:33:39<8:33:26, 655.46s/it][A[ASelf.trainer.train duration: 541.1076 seconds
显存占用: 5221.30 MB, 已预留显存: 5800.00 MB
dealing with 17
[03:32:56] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  28%|██▊       | 18/64 [2:44:58<8:27:55, 662.51s/it][A[ASelf.trainer.train duration: 552.9047 seconds
显存占用: 5563.73 MB, 已预留显存: 6186.00 MB
dealing with 18
[03:44:15] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  30%|██▉       | 19/64 [2:56:09<8:18:40, 664.90s/it][A[ASelf.trainer.train duration: 547.6364 seconds
显存占用: 5906.02 MB, 已预留显存: 6612.00 MB
dealing with 19
[03:55:25] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  31%|███▏      | 20/64 [3:07:25<8:10:04, 668.29s/it][A[ASelf.trainer.train duration: 551.8432 seconds
显存占用: 6247.11 MB, 已预留显存: 6990.00 MB
dealing with 20
[04:06:41] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  33%|███▎      | 21/64 [3:18:23<7:56:46, 665.26s/it][A[ASelf.trainer.train duration: 534.3424 seconds
显存占用: 6589.00 MB, 已预留显存: 7160.00 MB
dealing with 21
[04:17:40] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  34%|███▍      | 22/64 [3:29:15<7:42:44, 661.05s/it][A[ASelf.trainer.train duration: 528.4540 seconds
显存占用: 6930.54 MB, 已预留显存: 7574.00 MB
dealing with 22
[04:28:31] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
System is out of GPU memory

Refer to the Cycles GPU rendering documentation for possible solutions:
https://docs.blender.org/manual/en/latest/render/cycles/gpu_rendering.html

System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
viewpoint:  34%|███▍      | 22/64 [3:29:19<6:39:36, 570.87s/it]

                                                                      [AProcessing Categories:   0%|          | 0/55 [3:29:55<?, ?category/s]
Traceback (most recent call last):
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 240, in <module>
    distribution_dataset_construction(model_path, num_azimuth, num_elevation, radius, start_viewpoint_index, viewpoint_index_interval)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 160, in distribution_dataset_construction
    env.reset()
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_env.py", line 117, in reset
    np_images, transforms = self.get_images(mode='init')
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_env.py", line 129, in get_images
    return self.gen_data(mode, return_quat=return_quat)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_env.py", line 150, in gen_data
    image = self.scene.render_pose(pose)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_scene.py", line 215, in render_pose
    result = self.render() #
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_scene.py", line 566, in render
    return super().render()
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_scene.py", line 422, in render
    result = bpycv.render_data()
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/bpycv/render_utils.py", line 115, in render_data
    render_result["image"] = _render_image()
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/bpycv/render_utils.py", line 94, in render_image
    bpy.ops.render.render(write_still=True)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/bpy/3.6/scripts/modules/bpy/ops.py", line 113, in __call__
    ret = _op_call(self.idname_py(), None, kw)
RuntimeError: Error: System is out of GPU memory
Error: System is out of GPU memory

Iteration 31 completed

Iteration 32/30
Processing Categories:   0%|          | 0/55 [00:00<?, ?category/s]
Processing Models in pillow:   0%|          | 0/96 [00:00<?, ?model/s][A/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tyro/_fields.py:1066: UserWarning: Mutable type <class 'config.EnvConfig'> is used as a default value for `env`. This is dangerous! Consider using `dataclasses.field(default_factory=...)` or marking <class 'config.EnvConfig'> as frozen.
  warnings.warn(
pillow:/attached/data/remote-home2/zzq/data/shapenet/ShapeNetCore.v2/03938244/9451f92833603bd3630771196b76eab9


CUDA
Generating data for init
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/boxx/ylcompat.py:69: BoxxWarning: warning from boxx
    os.environ["DISPLAY"] is not found
    plt.show() are redirect to plt.savefig(tmp)
    function: show, loga, crun, heatmap, plot will be affected
  def __setDisplayEnv():
saving data to data/shapenet/init/transforms.json
[04:30:50] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Found 64 GT images, loading directly from /remote-home/zzq/data/ShapeNet/gt_shapenet/pillow/9451f92833603bd3630771196b76eab9
Loaded 64 GT images successfully!


viewpoint:   0%|          | 0/64 [00:00<?, ?it/s][A[Adealing with 22
[04:30:59] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:70: FutureWarning: Importing `spectral_angle_mapper` from `torchmetrics.functional` was deprecated and will be removed in 2.0. Import `spectral_angle_mapper` from `torchmetrics.image` instead.
  _future_warning(


viewpoint:  36%|███▌      | 23/64 [11:07<19:49, 29.02s/it][A[ASelf.trainer.train duration: 543.3653 seconds
显存占用: 779.65 MB, 已预留显存: 1318.00 MB
dealing with 23
[04:42:06] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  38%|███▊      | 24/64 [22:01<43:42, 65.57s/it][A[ASelf.trainer.train duration: 534.4521 seconds
显存占用: 1119.06 MB, 已预留显存: 1630.00 MB
dealing with 24
[04:53:00] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  39%|███▉      | 25/64 [33:39<1:14:17, 114.30s/it][A[ASelf.trainer.train duration: 578.2656 seconds
显存占用: 1459.79 MB, 已预留显存: 2058.00 MB
dealing with 25
[05:04:38] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  41%|████      | 26/64 [45:21<1:49:19, 172.62s/it][A[ASelf.trainer.train duration: 583.7783 seconds
显存占用: 1802.31 MB, 已预留显存: 2378.00 MB
dealing with 26
[05:16:20] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  42%|████▏     | 27/64 [56:29<2:24:25, 234.19s/it][A[ASelf.trainer.train duration: 555.0269 seconds
显存占用: 2145.62 MB, 已预留显存: 2678.00 MB
dealing with 27
[05:27:28] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  44%|████▍     | 28/64 [1:07:51<3:00:55, 301.56s/it][A[ASelf.trainer.train duration: 572.4257 seconds
显存占用: 2487.86 MB, 已预留显存: 3076.00 MB
dealing with 28
[05:38:50] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json
viewpoint:  44%|████▍     | 28/64 [1:08:46<1:28:25, 147.36s/it]

                                                                      [AProcessing Categories:   0%|          | 0/55 [1:09:11<?, ?category/s]
Traceback (most recent call last):
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 240, in <module>
    distribution_dataset_construction(model_path, num_azimuth, num_elevation, radius, start_viewpoint_index, viewpoint_index_interval)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 164, in distribution_dataset_construction
    NeRF_pipeline.add_image(images=obs,poses=input_pose,model_option=None)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nvf/active_mapping/active_mapping.py", line 233, in add_image
    self.trainer.train()
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nvf/nerfstudio_interface/nbv_trainer.py", line 213, in train
    loss, loss_dict, metrics_dict = self.train_iteration(step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/utils/profiler.py", line 127, in inner
    out = func(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/engine/trainer.py", line 740, in train_iteration
    _, loss_dict, metrics_dict = self.pipeline.get_train_loss_dict(step=step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/pipelines/dynamic_batch.py", line 91, in get_train_loss_dict
    model_outputs, loss_dict, metrics_dict = super().get_train_loss_dict(step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/utils/profiler.py", line 127, in inner
    out = func(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/pipelines/base_pipeline.py", line 284, in get_train_loss_dict
    model_outputs = self._model(ray_bundle)  # train distributed data parallel model if world_size > 1
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/models/base_model.py", line 142, in forward
    return self.get_outputs(ray_bundle)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/models/instant_ngp.py", line 302, in get_outputs
    ray_samples, ray_indices = self.sampler(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/model_components/ray_samplers.py", line 482, in forward
    ray_indices, starts, ends = self.occupancy_grid.sampling(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/nerfacc/estimators/occ_grid.py", line 192, in sampling
    sigmas = sigma_fn(t_starts, t_ends, ray_indices)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/model_components/ray_samplers.py", line 428, in sigma_fn
    return density_fn(positions).squeeze(-1)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/fields/base_field.py", line 67, in density_fn
    density, _ = self.get_density(ray_samples)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/fields/nerfacto_field.py", line 252, in get_density
    h = self.mlp_base(positions_flat).view(*ray_samples.frustums.shape, -1)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/field_components/mlp.py", line 177, in forward
    return self.tcnn_encoding(in_tensor)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tinycudann/modules.py", line 190, in forward
    output = _module_function.apply(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/autograd/function.py", line 506, in apply
    return super().apply(*args, **kwargs)  # type: ignore[misc]
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tinycudann/modules.py", line 102, in forward
    native_ctx, output = native_tcnn_module.fwd(input, params)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 298.00 MiB (GPU 0; 23.68 GiB total capacity; 6.11 GiB already allocated; 209.75 MiB free; 6.50 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
Iteration 32 completed

Iteration 33/30
Processing Categories:   0%|          | 0/55 [00:00<?, ?category/s]
Processing Models in pillow:   0%|          | 0/96 [00:00<?, ?model/s][A/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tyro/_fields.py:1066: UserWarning: Mutable type <class 'config.EnvConfig'> is used as a default value for `env`. This is dangerous! Consider using `dataclasses.field(default_factory=...)` or marking <class 'config.EnvConfig'> as frozen.
  warnings.warn(
pillow:/attached/data/remote-home2/zzq/data/shapenet/ShapeNetCore.v2/03938244/9451f92833603bd3630771196b76eab9


CUDA
Generating data for init
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/boxx/ylcompat.py:69: BoxxWarning: warning from boxx
    os.environ["DISPLAY"] is not found
    plt.show() are redirect to plt.savefig(tmp)
    function: show, loga, crun, heatmap, plot will be affected
  def __setDisplayEnv():
saving data to data/shapenet/init/transforms.json
[05:42:00] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Found 64 GT images, loading directly from /remote-home/zzq/data/ShapeNet/gt_shapenet/pillow/9451f92833603bd3630771196b76eab9
Loaded 64 GT images successfully!


viewpoint:   0%|          | 0/64 [00:00<?, ?it/s][A[Adealing with 28
[05:42:08] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:70: FutureWarning: Importing `spectral_angle_mapper` from `torchmetrics.functional` was deprecated and will be removed in 2.0. Import `spectral_angle_mapper` from `torchmetrics.image` instead.
  _future_warning(


viewpoint:  45%|████▌     | 29/64 [15:18<18:28, 31.67s/it][A[ASelf.trainer.train duration: 792.0997 seconds
显存占用: 782.74 MB, 已预留显存: 2062.00 MB
dealing with 29
[05:57:26] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  47%|████▋     | 30/64 [28:16<37:48, 66.71s/it][A[ASelf.trainer.train duration: 658.8224 seconds
显存占用: 1121.82 MB, 已预留显存: 1902.00 MB
dealing with 30
[06:10:24] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  48%|████▊     | 31/64 [39:35<57:51, 105.20s/it][A[ASelf.trainer.train duration: 559.9901 seconds
显存占用: 1464.44 MB, 已预留显存: 2124.00 MB
dealing with 31
[06:21:43] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  50%|█████     | 32/64 [51:03<1:21:41, 153.18s/it][A[ASelf.trainer.train duration: 549.0465 seconds
显存占用: 1804.31 MB, 已预留显存: 2318.00 MB
dealing with 32
[06:33:11] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  52%|█████▏    | 33/64 [1:02:04<1:46:49, 206.75s/it][A[ASelf.trainer.train duration: 533.4937 seconds
显存占用: 2144.94 MB, 已预留显存: 2550.00 MB
dealing with 33
[06:44:13] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  53%|█████▎    | 34/64 [1:13:17<2:13:50, 267.68s/it][A[ASelf.trainer.train duration: 559.4397 seconds
显存占用: 2486.44 MB, 已预留显存: 3034.00 MB
dealing with 34
[06:55:25] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  55%|█████▍    | 35/64 [1:24:28<2:40:04, 331.18s/it][A[ASelf.trainer.train duration: 543.8674 seconds
显存占用: 2830.68 MB, 已预留显存: 3366.00 MB
dealing with 35
[07:06:37] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json
viewpoint:  55%|█████▍    | 35/64 [1:25:20<1:10:42, 146.31s/it]

                                                                      [AProcessing Categories:   0%|          | 0/55 [1:25:48<?, ?category/s]
Traceback (most recent call last):
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 240, in <module>
    distribution_dataset_construction(model_path, num_azimuth, num_elevation, radius, start_viewpoint_index, viewpoint_index_interval)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 164, in distribution_dataset_construction
    NeRF_pipeline.add_image(images=obs,poses=input_pose,model_option=None)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nvf/active_mapping/active_mapping.py", line 233, in add_image
    self.trainer.train()
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nvf/nerfstudio_interface/nbv_trainer.py", line 213, in train
    loss, loss_dict, metrics_dict = self.train_iteration(step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/utils/profiler.py", line 127, in inner
    out = func(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/engine/trainer.py", line 740, in train_iteration
    _, loss_dict, metrics_dict = self.pipeline.get_train_loss_dict(step=step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/pipelines/dynamic_batch.py", line 91, in get_train_loss_dict
    model_outputs, loss_dict, metrics_dict = super().get_train_loss_dict(step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/utils/profiler.py", line 127, in inner
    out = func(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/pipelines/base_pipeline.py", line 284, in get_train_loss_dict
    model_outputs = self._model(ray_bundle)  # train distributed data parallel model if world_size > 1
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/models/base_model.py", line 142, in forward
    return self.get_outputs(ray_bundle)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/models/instant_ngp.py", line 302, in get_outputs
    ray_samples, ray_indices = self.sampler(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/model_components/ray_samplers.py", line 482, in forward
    ray_indices, starts, ends = self.occupancy_grid.sampling(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/nerfacc/estimators/occ_grid.py", line 192, in sampling
    sigmas = sigma_fn(t_starts, t_ends, ray_indices)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/model_components/ray_samplers.py", line 428, in sigma_fn
    return density_fn(positions).squeeze(-1)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/fields/base_field.py", line 67, in density_fn
    density, _ = self.get_density(ray_samples)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/fields/nerfacto_field.py", line 252, in get_density
    h = self.mlp_base(positions_flat).view(*ray_samples.frustums.shape, -1)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/field_components/mlp.py", line 177, in forward
    return self.tcnn_encoding(in_tensor)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tinycudann/modules.py", line 190, in forward
    output = _module_function.apply(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/autograd/function.py", line 506, in apply
    return super().apply(*args, **kwargs)  # type: ignore[misc]
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tinycudann/modules.py", line 102, in forward
    native_ctx, output = native_tcnn_module.fwd(input, params)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 206.00 MiB (GPU 0; 23.68 GiB total capacity; 5.35 GiB already allocated; 177.75 MiB free; 5.57 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
Iteration 33 completed

Iteration 34/30
Processing Categories:   0%|          | 0/55 [00:00<?, ?category/s]
Processing Models in pillow:   0%|          | 0/96 [00:00<?, ?model/s][A/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tyro/_fields.py:1066: UserWarning: Mutable type <class 'config.EnvConfig'> is used as a default value for `env`. This is dangerous! Consider using `dataclasses.field(default_factory=...)` or marking <class 'config.EnvConfig'> as frozen.
  warnings.warn(
pillow:/attached/data/remote-home2/zzq/data/shapenet/ShapeNetCore.v2/03938244/9451f92833603bd3630771196b76eab9


CUDA
Generating data for init
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/boxx/ylcompat.py:69: BoxxWarning: warning from boxx
    os.environ["DISPLAY"] is not found
    plt.show() are redirect to plt.savefig(tmp)
    function: show, loga, crun, heatmap, plot will be affected
  def __setDisplayEnv():
saving data to data/shapenet/init/transforms.json
[07:09:58] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Found 64 GT images, loading directly from /remote-home/zzq/data/ShapeNet/gt_shapenet/pillow/9451f92833603bd3630771196b76eab9
Loaded 64 GT images successfully!


viewpoint:   0%|          | 0/64 [00:00<?, ?it/s][A[Adealing with 35
[07:10:07] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:70: FutureWarning: Importing `spectral_angle_mapper` from `torchmetrics.functional` was deprecated and will be removed in 2.0. Import `spectral_angle_mapper` from `torchmetrics.image` instead.
  _future_warning(


viewpoint:  56%|█████▋    | 36/64 [12:20<09:35, 20.57s/it][A[ASelf.trainer.train duration: 620.8780 seconds
显存占用: 779.87 MB, 已预留显存: 1416.00 MB
dealing with 36
[07:22:27] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  58%|█████▊    | 37/64 [24:26<21:22, 47.50s/it][A[ASelf.trainer.train duration: 590.0243 seconds
显存占用: 1120.74 MB, 已预留显存: 1696.00 MB
dealing with 37
[07:34:34] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  59%|█████▉    | 38/64 [35:43<34:41, 80.04s/it][A[ASelf.trainer.train duration: 547.7566 seconds
显存占用: 1461.38 MB, 已预留显存: 2006.00 MB
dealing with 38
[07:45:50] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  61%|██████    | 39/64 [47:06<50:37, 121.49s/it][A[ASelf.trainer.train duration: 556.3748 seconds
显存占用: 1804.61 MB, 已预留显存: 2380.00 MB
dealing with 39
[07:57:13] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  62%|██████▎   | 40/64 [58:52<1:09:32, 173.86s/it][A[ASelf.trainer.train duration: 598.3353 seconds
显存占用: 2145.76 MB, 已预留显存: 2764.00 MB
dealing with 40
[08:09:00] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  64%|██████▍   | 41/64 [1:09:22<1:26:27, 225.54s/it][A[ASelf.trainer.train duration: 509.3711 seconds
显存占用: 2486.25 MB, 已预留显存: 2962.00 MB
dealing with 41
[08:19:30] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  66%|██████▌   | 42/64 [1:20:12<1:44:20, 284.59s/it][A[ASelf.trainer.train duration: 524.9534 seconds
显存占用: 2827.41 MB, 已预留显存: 3364.00 MB
dealing with 42
[08:30:19] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  67%|██████▋   | 43/64 [1:30:44<1:59:48, 342.31s/it][A[ASelf.trainer.train duration: 510.4160 seconds
显存占用: 3169.77 MB, 已预留显存: 3674.00 MB
dealing with 43
[08:40:51] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  69%|██████▉   | 44/64 [1:41:11<2:12:19, 396.97s/it][A[ASelf.trainer.train duration: 497.5943 seconds
显存占用: 3510.20 MB, 已预留显存: 3976.00 MB
dealing with 44
[08:51:19] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  70%|███████   | 45/64 [1:51:41<2:21:31, 446.90s/it][A[ASelf.trainer.train duration: 508.5331 seconds
显存占用: 3852.55 MB, 已预留显存: 4448.00 MB
dealing with 45
[09:01:48] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  72%|███████▏  | 46/64 [2:02:36<2:28:45, 495.86s/it][A[ASelf.trainer.train duration: 533.9137 seconds
显存占用: 4194.03 MB, 已预留显存: 4842.00 MB
dealing with 46
[09:12:43] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  73%|███████▎  | 47/64 [2:13:32<2:31:56, 536.24s/it][A[ASelf.trainer.train duration: 528.0069 seconds
显存占用: 4535.33 MB, 已预留显存: 5186.00 MB
dealing with 47
[09:23:40] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  75%|███████▌  | 48/64 [2:24:09<2:30:03, 562.71s/it][A[ASelf.trainer.train duration: 522.3444 seconds
显存占用: 4875.44 MB, 已预留显存: 5532.00 MB
dealing with 48
[09:34:16] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
System is out of GPU memory

Refer to the Cycles GPU rendering documentation for possible solutions:
https://docs.blender.org/manual/en/latest/render/cycles/gpu_rendering.html

System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
viewpoint:  75%|███████▌  | 48/64 [2:24:13<48:04, 180.28s/it]  

                                                                      [AProcessing Categories:   0%|          | 0/55 [2:24:51<?, ?category/s]
Traceback (most recent call last):
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 240, in <module>
    distribution_dataset_construction(model_path, num_azimuth, num_elevation, radius, start_viewpoint_index, viewpoint_index_interval)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 160, in distribution_dataset_construction
    env.reset()
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_env.py", line 117, in reset
    np_images, transforms = self.get_images(mode='init')
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_env.py", line 129, in get_images
    return self.gen_data(mode, return_quat=return_quat)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_env.py", line 150, in gen_data
    image = self.scene.render_pose(pose)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_scene.py", line 215, in render_pose
    result = self.render() #
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_scene.py", line 566, in render
    return super().render()
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_scene.py", line 422, in render
    result = bpycv.render_data()
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/bpycv/render_utils.py", line 115, in render_data
    render_result["image"] = _render_image()
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/bpycv/render_utils.py", line 94, in render_image
    bpy.ops.render.render(write_still=True)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/bpy/3.6/scripts/modules/bpy/ops.py", line 113, in __call__
    ret = _op_call(self.idname_py(), None, kw)
RuntimeError: Error: System is out of GPU memory
Error: System is out of GPU memory

Iteration 34 completed

Iteration 35/30
Processing Categories:   0%|          | 0/55 [00:00<?, ?category/s]
Processing Models in pillow:   0%|          | 0/96 [00:00<?, ?model/s][A/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tyro/_fields.py:1066: UserWarning: Mutable type <class 'config.EnvConfig'> is used as a default value for `env`. This is dangerous! Consider using `dataclasses.field(default_factory=...)` or marking <class 'config.EnvConfig'> as frozen.
  warnings.warn(
pillow:/attached/data/remote-home2/zzq/data/shapenet/ShapeNetCore.v2/03938244/9451f92833603bd3630771196b76eab9


CUDA
Generating data for init
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/boxx/ylcompat.py:69: BoxxWarning: warning from boxx
    os.environ["DISPLAY"] is not found
    plt.show() are redirect to plt.savefig(tmp)
    function: show, loga, crun, heatmap, plot will be affected
  def __setDisplayEnv():
saving data to data/shapenet/init/transforms.json
[09:36:47] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Found 64 GT images, loading directly from /remote-home/zzq/data/ShapeNet/gt_shapenet/pillow/9451f92833603bd3630771196b76eab9
Loaded 64 GT images successfully!


viewpoint:   0%|          | 0/64 [00:00<?, ?it/s][A[Adealing with 48
[09:36:55] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:70: FutureWarning: Importing `spectral_angle_mapper` from `torchmetrics.functional` was deprecated and will be removed in 2.0. Import `spectral_angle_mapper` from `torchmetrics.image` instead.
  _future_warning(


viewpoint:  77%|███████▋  | 49/64 [10:31<03:13, 12.89s/it][A[ASelf.trainer.train duration: 512.0213 seconds
显存占用: 776.35 MB, 已预留显存: 1200.00 MB
dealing with 49
[09:47:26] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  78%|███████▊  | 50/64 [21:04<07:06, 30.45s/it][A[ASelf.trainer.train duration: 515.4392 seconds
显存占用: 1118.04 MB, 已预留显存: 1544.00 MB
dealing with 50
[09:57:59] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  80%|███████▉  | 51/64 [31:15<11:29, 53.05s/it][A[ASelf.trainer.train duration: 494.6711 seconds
显存占用: 1460.34 MB, 已预留显存: 1842.00 MB
dealing with 51
[10:08:11] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  81%|████████▏ | 52/64 [41:11<16:19, 81.64s/it][A[ASelf.trainer.train duration: 483.4046 seconds
显存占用: 1801.87 MB, 已预留显存: 2210.00 MB
dealing with 52
[10:18:07] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  83%|████████▎ | 53/64 [51:28<21:49, 119.05s/it][A[ASelf.trainer.train duration: 491.4600 seconds
显存占用: 2144.52 MB, 已预留显存: 2642.00 MB
dealing with 53
[10:28:24] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  84%|████████▍ | 54/64 [1:01:55<27:31, 165.19s/it][A[ASelf.trainer.train duration: 515.6268 seconds
显存占用: 2485.83 MB, 已预留显存: 2976.00 MB
dealing with 54
[10:38:50] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  86%|████████▌ | 55/64 [1:12:23<32:44, 218.29s/it][A[ASelf.trainer.train duration: 499.8933 seconds
显存占用: 2828.00 MB, 已预留显存: 3318.00 MB
dealing with 55
[10:49:18] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  88%|████████▊ | 56/64 [1:23:19<37:20, 280.01s/it][A[ASelf.trainer.train duration: 533.4825 seconds
显存占用: 3170.12 MB, 已预留显存: 3794.00 MB
dealing with 56
[11:00:14] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  89%|████████▉ | 57/64 [1:33:54<39:37, 339.65s/it][A[ASelf.trainer.train duration: 517.9826 seconds
显存占用: 3510.71 MB, 已预留显存: 4140.00 MB
dealing with 57
[11:10:50] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  91%|█████████ | 58/64 [1:45:08<40:24, 404.16s/it][A[ASelf.trainer.train duration: 535.4859 seconds
显存占用: 3853.32 MB, 已预留显存: 4524.00 MB
dealing with 58
[11:22:04] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  92%|█████████▏| 59/64 [1:55:49<37:57, 455.48s/it][A[ASelf.trainer.train duration: 522.1904 seconds
显存占用: 4194.66 MB, 已预留显存: 4802.00 MB
dealing with 59
[11:32:45] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  94%|█████████▍| 60/64 [2:06:35<33:21, 500.45s/it][A[ASelf.trainer.train duration: 520.8967 seconds
显存占用: 4537.59 MB, 已预留显存: 5212.00 MB
dealing with 60
[11:43:31] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  95%|█████████▌| 61/64 [2:16:53<26:29, 529.97s/it][A[ASelf.trainer.train duration: 506.1427 seconds
显存占用: 4877.71 MB, 已预留显存: 5520.00 MB
dealing with 61
[11:53:48] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  97%|█████████▋| 62/64 [2:27:17<18:29, 554.91s/it][A[ASelf.trainer.train duration: 501.9812 seconds
显存占用: 5219.56 MB, 已预留显存: 5790.00 MB
dealing with 62
[12:04:13] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  98%|█████████▊| 63/64 [2:37:55<09:37, 577.69s/it][A[ASelf.trainer.train duration: 498.6711 seconds
显存占用: 5559.96 MB, 已预留显存: 6184.00 MB
dealing with 63
[12:14:50] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint: 100%|██████████| 64/64 [2:48:02<00:00, 586.05s/it][A[Aviewpoint: 100%|██████████| 64/64 [2:48:02<00:00, 157.54s/it]

Processing Models in pillow:   6%|▋         | 6/96 [2:48:39<42:09:57, 1686.64s/model][A/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tyro/_fields.py:1066: UserWarning: Mutable type <class 'config.EnvConfig'> is used as a default value for `env`. This is dangerous! Consider using `dataclasses.field(default_factory=...)` or marking <class 'config.EnvConfig'> as frozen.
  warnings.warn(
Self.trainer.train duration: 497.1547 seconds
显存占用: 5901.81 MB, 已预留显存: 6614.00 MB
pillow:/attached/data/remote-home2/zzq/data/shapenet/ShapeNetCore.v2/03938244/530cc7dd793df95f8f5ae2c97614087a


CUDA
Generating data for init
saving data to data/shapenet/init/transforms.json
[12:25:34] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Found 64 GT images, loading directly from /remote-home/zzq/data/ShapeNet/gt_shapenet/pillow/530cc7dd793df95f8f5ae2c97614087a
Loaded 64 GT images successfully!


viewpoint:   0%|          | 0/64 [00:00<?, ?it/s][A[Adealing with 0
[12:25:39] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:   2%|▏         | 1/64 [11:49<12:24:32, 709.09s/it][A[ASelf.trainer.train duration: 571.0222 seconds
显存占用: 6463.33 MB, 已预留显存: 7338.00 MB
dealing with 1
[12:37:28] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json
viewpoint:   2%|▏         | 1/64 [12:39<13:17:14, 759.28s/it]

                                                                                     [AProcessing Categories:   0%|          | 0/55 [3:01:59<?, ?category/s]
Traceback (most recent call last):
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 240, in <module>
    distribution_dataset_construction(model_path, num_azimuth, num_elevation, radius, start_viewpoint_index, viewpoint_index_interval)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 164, in distribution_dataset_construction
    NeRF_pipeline.add_image(images=obs,poses=input_pose,model_option=None)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nvf/active_mapping/active_mapping.py", line 233, in add_image
    self.trainer.train()
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nvf/nerfstudio_interface/nbv_trainer.py", line 213, in train
    loss, loss_dict, metrics_dict = self.train_iteration(step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/utils/profiler.py", line 127, in inner
    out = func(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/engine/trainer.py", line 740, in train_iteration
    _, loss_dict, metrics_dict = self.pipeline.get_train_loss_dict(step=step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/pipelines/dynamic_batch.py", line 91, in get_train_loss_dict
    model_outputs, loss_dict, metrics_dict = super().get_train_loss_dict(step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/utils/profiler.py", line 127, in inner
    out = func(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/pipelines/base_pipeline.py", line 284, in get_train_loss_dict
    model_outputs = self._model(ray_bundle)  # train distributed data parallel model if world_size > 1
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/models/base_model.py", line 142, in forward
    return self.get_outputs(ray_bundle)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/models/instant_ngp.py", line 302, in get_outputs
    ray_samples, ray_indices = self.sampler(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/model_components/ray_samplers.py", line 482, in forward
    ray_indices, starts, ends = self.occupancy_grid.sampling(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/nerfacc/estimators/occ_grid.py", line 192, in sampling
    sigmas = sigma_fn(t_starts, t_ends, ray_indices)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/model_components/ray_samplers.py", line 428, in sigma_fn
    return density_fn(positions).squeeze(-1)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/fields/base_field.py", line 67, in density_fn
    density, _ = self.get_density(ray_samples)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/fields/nerfacto_field.py", line 252, in get_density
    h = self.mlp_base(positions_flat).view(*ray_samples.frustums.shape, -1)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/field_components/mlp.py", line 177, in forward
    return self.tcnn_encoding(in_tensor)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tinycudann/modules.py", line 190, in forward
    output = _module_function.apply(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/autograd/function.py", line 506, in apply
    return super().apply(*args, **kwargs)  # type: ignore[misc]
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tinycudann/modules.py", line 102, in forward
    native_ctx, output = native_tcnn_module.fwd(input, params)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 110.00 MiB (GPU 0; 23.68 GiB total capacity; 7.82 GiB already allocated; 49.75 MiB free; 8.11 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
Iteration 35 completed

Iteration 36/30
Processing Categories:   0%|          | 0/55 [00:00<?, ?category/s]
Processing Models in pillow:   0%|          | 0/96 [00:00<?, ?model/s][A/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tyro/_fields.py:1066: UserWarning: Mutable type <class 'config.EnvConfig'> is used as a default value for `env`. This is dangerous! Consider using `dataclasses.field(default_factory=...)` or marking <class 'config.EnvConfig'> as frozen.
  warnings.warn(
pillow:/attached/data/remote-home2/zzq/data/shapenet/ShapeNetCore.v2/03938244/530cc7dd793df95f8f5ae2c97614087a


CUDA
Generating data for init
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/boxx/ylcompat.py:69: BoxxWarning: warning from boxx
    os.environ["DISPLAY"] is not found
    plt.show() are redirect to plt.savefig(tmp)
    function: show, loga, crun, heatmap, plot will be affected
  def __setDisplayEnv():
saving data to data/shapenet/init/transforms.json
[12:40:46] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Found 64 GT images, loading directly from /remote-home/zzq/data/ShapeNet/gt_shapenet/pillow/530cc7dd793df95f8f5ae2c97614087a
Loaded 64 GT images successfully!


viewpoint:   0%|          | 0/64 [00:00<?, ?it/s][A[Adealing with 1
[12:40:54] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:70: FutureWarning: Importing `spectral_angle_mapper` from `torchmetrics.functional` was deprecated and will be removed in 2.0. Import `spectral_angle_mapper` from `torchmetrics.image` instead.
  _future_warning(


viewpoint:   3%|▎         | 2/64 [12:00<6:12:10, 360.17s/it][A[ASelf.trainer.train duration: 603.8915 seconds
显存占用: 777.88 MB, 已预留显存: 1376.00 MB
dealing with 2
[12:52:55] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:   5%|▍         | 3/64 [23:37<8:29:05, 500.74s/it][A[ASelf.trainer.train duration: 564.3255 seconds
显存占用: 1119.68 MB, 已预留显存: 1604.00 MB
dealing with 3
[13:04:32] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:   6%|▋         | 4/64 [35:00<9:28:28, 568.47s/it][A[ASelf.trainer.train duration: 548.4452 seconds
显存占用: 1460.88 MB, 已预留显存: 1998.00 MB
dealing with 4
[13:15:55] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:   8%|▊         | 5/64 [46:43<10:05:01, 615.28s/it][A[ASelf.trainer.train duration: 562.7161 seconds
显存占用: 1803.20 MB, 已预留显存: 2374.00 MB
dealing with 5
[13:27:38] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:   9%|▉         | 6/64 [58:19<10:20:44, 642.14s/it][A[ASelf.trainer.train duration: 568.0390 seconds
显存占用: 2144.99 MB, 已预留显存: 2692.00 MB
dealing with 6
[13:39:14] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  11%|█         | 7/64 [1:09:39<10:21:33, 654.27s/it][A[ASelf.trainer.train duration: 535.6393 seconds
显存占用: 2487.38 MB, 已预留显存: 2964.00 MB
dealing with 7
[13:50:34] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  12%|█▎        | 8/64 [1:20:27<10:08:50, 652.34s/it][A[ASelf.trainer.train duration: 504.6564 seconds
显存占用: 2830.68 MB, 已预留显存: 3376.00 MB
dealing with 8
[14:01:22] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  14%|█▍        | 9/64 [1:33:00<10:26:45, 683.74s/it][A[ASelf.trainer.train duration: 616.2961 seconds
显存占用: 3172.57 MB, 已预留显存: 3956.00 MB
dealing with 9
[14:13:55] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  16%|█▌        | 10/64 [1:44:35<10:18:14, 686.93s/it][A[ASelf.trainer.train duration: 543.6377 seconds
显存占用: 3514.51 MB, 已预留显存: 4104.00 MB
dealing with 10
[14:25:30] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  17%|█▋        | 11/64 [1:56:03<10:07:15, 687.47s/it][A[ASelf.trainer.train duration: 556.4988 seconds
显存占用: 3856.25 MB, 已预留显存: 4514.00 MB
dealing with 11
[14:36:58] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  19%|█▉        | 12/64 [2:08:07<10:05:23, 698.54s/it][A[ASelf.trainer.train duration: 587.5407 seconds
显存占用: 4198.18 MB, 已预留显存: 4898.00 MB
dealing with 12
[14:49:02] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  20%|██        | 13/64 [2:19:03<9:42:52, 685.73s/it] [A[ASelf.trainer.train duration: 521.7068 seconds
显存占用: 4540.19 MB, 已预留显存: 5152.00 MB
dealing with 13
[14:59:58] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  22%|██▏       | 14/64 [2:30:17<9:28:25, 682.12s/it][A[ASelf.trainer.train duration: 520.0533 seconds
显存占用: 4881.55 MB, 已预留显存: 5502.00 MB
dealing with 14
[15:11:12] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  23%|██▎       | 15/64 [2:41:58<9:21:45, 687.87s/it][A[ASelf.trainer.train duration: 564.1281 seconds
显存占用: 5223.54 MB, 已预留显存: 5904.00 MB
dealing with 15
[15:22:53] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  25%|██▌       | 16/64 [2:53:30<9:11:09, 688.95s/it][A[ASelf.trainer.train duration: 548.2834 seconds
显存占用: 5565.74 MB, 已预留显存: 6144.00 MB
dealing with 16
[15:34:25] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  27%|██▋       | 17/64 [3:04:18<8:50:10, 676.82s/it][A[ASelf.trainer.train duration: 508.0938 seconds
显存占用: 5906.83 MB, 已预留显存: 6442.00 MB
dealing with 17
[15:45:13] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
System is out of GPU memory

Refer to the Cycles GPU rendering documentation for possible solutions:
https://docs.blender.org/manual/en/latest/render/cycles/gpu_rendering.html

System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
System is out of GPU memory
viewpoint:  27%|██▋       | 17/64 [3:04:23<8:29:46, 650.78s/it]

                                                                      [AProcessing Categories:   0%|          | 0/55 [3:05:04<?, ?category/s]
Traceback (most recent call last):
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 240, in <module>
    distribution_dataset_construction(model_path, num_azimuth, num_elevation, radius, start_viewpoint_index, viewpoint_index_interval)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 160, in distribution_dataset_construction
    env.reset()
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_env.py", line 117, in reset
    np_images, transforms = self.get_images(mode='init')
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_env.py", line 129, in get_images
    return self.gen_data(mode, return_quat=return_quat)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_env.py", line 150, in gen_data
    image = self.scene.render_pose(pose)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_scene.py", line 215, in render_pose
    result = self.render() #
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_scene.py", line 566, in render
    return super().render()
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/env/shapenet_scene.py", line 422, in render
    result = bpycv.render_data()
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/bpycv/render_utils.py", line 115, in render_data
    render_result["image"] = _render_image()
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/bpycv/render_utils.py", line 94, in render_image
    bpy.ops.render.render(write_still=True)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/bpy/3.6/scripts/modules/bpy/ops.py", line 113, in __call__
    ret = _op_call(self.idname_py(), None, kw)
RuntimeError: Error: System is out of GPU memory
Error: System is out of GPU memory

Iteration 36 completed

Iteration 37/30
Processing Categories:   0%|          | 0/55 [00:00<?, ?category/s]
Processing Models in pillow:   0%|          | 0/96 [00:00<?, ?model/s][A/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tyro/_fields.py:1066: UserWarning: Mutable type <class 'config.EnvConfig'> is used as a default value for `env`. This is dangerous! Consider using `dataclasses.field(default_factory=...)` or marking <class 'config.EnvConfig'> as frozen.
  warnings.warn(
pillow:/attached/data/remote-home2/zzq/data/shapenet/ShapeNetCore.v2/03938244/530cc7dd793df95f8f5ae2c97614087a


CUDA
Generating data for init
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/boxx/ylcompat.py:69: BoxxWarning: warning from boxx
    os.environ["DISPLAY"] is not found
    plt.show() are redirect to plt.savefig(tmp)
    function: show, loga, crun, heatmap, plot will be affected
  def __setDisplayEnv():
saving data to data/shapenet/init/transforms.json
[15:47:55] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Found 64 GT images, loading directly from /remote-home/zzq/data/ShapeNet/gt_shapenet/pillow/530cc7dd793df95f8f5ae2c97614087a
Loaded 64 GT images successfully!


viewpoint:   0%|          | 0/64 [00:00<?, ?it/s][A[Adealing with 17
[15:48:04] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:70: FutureWarning: Importing `spectral_angle_mapper` from `torchmetrics.functional` was deprecated and will be removed in 2.0. Import `spectral_angle_mapper` from `torchmetrics.image` instead.
  _future_warning(


viewpoint:  28%|██▊       | 18/64 [11:41<29:53, 38.99s/it][A[ASelf.trainer.train duration: 569.3097 seconds
显存占用: 777.66 MB, 已预留显存: 1294.00 MB
dealing with 18
[15:59:46] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  30%|██▉       | 19/64 [23:22<1:05:42, 87.62s/it][A[ASelf.trainer.train duration: 558.7777 seconds
显存占用: 1121.08 MB, 已预留显存: 1630.00 MB
dealing with 19
[16:11:26] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  31%|███▏      | 20/64 [35:54<1:50:36, 150.83s/it][A[ASelf.trainer.train duration: 590.4995 seconds
显存占用: 1461.48 MB, 已预留显存: 2058.00 MB
dealing with 20
[16:23:59] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  33%|███▎      | 21/64 [47:27<2:34:31, 215.63s/it][A[ASelf.trainer.train duration: 560.4304 seconds
显存占用: 1805.54 MB, 已预留显存: 2292.00 MB
dealing with 21
[16:35:31] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  34%|███▍      | 22/64 [58:34<3:17:03, 281.52s/it][A[ASelf.trainer.train duration: 528.2868 seconds
显存占用: 2147.30 MB, 已预留显存: 2580.00 MB
dealing with 22
[16:46:39] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  36%|███▌      | 23/64 [1:10:13<4:01:34, 353.53s/it][A[ASelf.trainer.train duration: 558.8397 seconds
显存占用: 2490.46 MB, 已预留显存: 2948.00 MB
dealing with 23
[16:58:18] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  38%|███▊      | 24/64 [1:21:00<4:34:17, 411.44s/it][A[ASelf.trainer.train duration: 510.1778 seconds
显存占用: 2831.87 MB, 已预留显存: 3280.00 MB
dealing with 24
[17:09:04] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json
viewpoint:  38%|███▊      | 24/64 [1:22:15<2:17:05, 205.64s/it]

                                                                      [AProcessing Categories:   0%|          | 0/55 [1:22:54<?, ?category/s]
Traceback (most recent call last):
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 240, in <module>
    distribution_dataset_construction(model_path, num_azimuth, num_elevation, radius, start_viewpoint_index, viewpoint_index_interval)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 164, in distribution_dataset_construction
    NeRF_pipeline.add_image(images=obs,poses=input_pose,model_option=None)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nvf/active_mapping/active_mapping.py", line 233, in add_image
    self.trainer.train()
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nvf/nerfstudio_interface/nbv_trainer.py", line 213, in train
    loss, loss_dict, metrics_dict = self.train_iteration(step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/utils/profiler.py", line 127, in inner
    out = func(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/engine/trainer.py", line 740, in train_iteration
    _, loss_dict, metrics_dict = self.pipeline.get_train_loss_dict(step=step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/pipelines/dynamic_batch.py", line 91, in get_train_loss_dict
    model_outputs, loss_dict, metrics_dict = super().get_train_loss_dict(step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/utils/profiler.py", line 127, in inner
    out = func(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/pipelines/base_pipeline.py", line 284, in get_train_loss_dict
    model_outputs = self._model(ray_bundle)  # train distributed data parallel model if world_size > 1
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/models/base_model.py", line 142, in forward
    return self.get_outputs(ray_bundle)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/models/instant_ngp.py", line 302, in get_outputs
    ray_samples, ray_indices = self.sampler(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/model_components/ray_samplers.py", line 482, in forward
    ray_indices, starts, ends = self.occupancy_grid.sampling(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/nerfacc/estimators/occ_grid.py", line 192, in sampling
    sigmas = sigma_fn(t_starts, t_ends, ray_indices)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/model_components/ray_samplers.py", line 428, in sigma_fn
    return density_fn(positions).squeeze(-1)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/fields/base_field.py", line 67, in density_fn
    density, _ = self.get_density(ray_samples)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/fields/nerfacto_field.py", line 252, in get_density
    h = self.mlp_base(positions_flat).view(*ray_samples.frustums.shape, -1)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/field_components/mlp.py", line 177, in forward
    return self.tcnn_encoding(in_tensor)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tinycudann/modules.py", line 190, in forward
    output = _module_function.apply(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/autograd/function.py", line 506, in apply
    return super().apply(*args, **kwargs)  # type: ignore[misc]
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tinycudann/modules.py", line 102, in forward
    native_ctx, output = native_tcnn_module.fwd(input, params)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 386.00 MiB (GPU 0; 23.68 GiB total capacity; 7.36 GiB already allocated; 367.75 MiB free; 7.61 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
Iteration 37 completed

Iteration 38/30
Processing Categories:   0%|          | 0/55 [00:00<?, ?category/s]
Processing Models in pillow:   0%|          | 0/96 [00:00<?, ?model/s][A/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tyro/_fields.py:1066: UserWarning: Mutable type <class 'config.EnvConfig'> is used as a default value for `env`. This is dangerous! Consider using `dataclasses.field(default_factory=...)` or marking <class 'config.EnvConfig'> as frozen.
  warnings.warn(
pillow:/attached/data/remote-home2/zzq/data/shapenet/ShapeNetCore.v2/03938244/530cc7dd793df95f8f5ae2c97614087a


CUDA
Generating data for init
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/boxx/ylcompat.py:69: BoxxWarning: warning from boxx
    os.environ["DISPLAY"] is not found
    plt.show() are redirect to plt.savefig(tmp)
    function: show, loga, crun, heatmap, plot will be affected
  def __setDisplayEnv():
saving data to data/shapenet/init/transforms.json
[17:12:59] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Found 64 GT images, loading directly from /remote-home/zzq/data/ShapeNet/gt_shapenet/pillow/530cc7dd793df95f8f5ae2c97614087a
Loaded 64 GT images successfully!


viewpoint:   0%|          | 0/64 [00:00<?, ?it/s][A[Adealing with 24
[17:13:07] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:70: FutureWarning: Importing `spectral_angle_mapper` from `torchmetrics.functional` was deprecated and will be removed in 2.0. Import `spectral_angle_mapper` from `torchmetrics.image` instead.
  _future_warning(


viewpoint:  39%|███▉      | 25/64 [12:56<20:11, 31.08s/it][A[ASelf.trainer.train duration: 640.1487 seconds
显存占用: 778.97 MB, 已预留显存: 1258.00 MB
dealing with 25
[17:26:04] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  41%|████      | 26/64 [24:49<43:01, 67.93s/it][A[ASelf.trainer.train duration: 572.4553 seconds
显存占用: 1120.68 MB, 已预留显存: 1576.00 MB
dealing with 26
[17:37:57] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  42%|████▏     | 27/64 [36:44<1:10:29, 114.32s/it][A[ASelf.trainer.train duration: 587.8057 seconds
显存占用: 1462.65 MB, 已预留显存: 2068.00 MB
dealing with 27
[17:49:52] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json
viewpoint:  42%|████▏     | 27/64 [37:43<51:42, 83.84s/it]   

                                                                      [AProcessing Categories:   0%|          | 0/55 [38:35<?, ?category/s]
Traceback (most recent call last):
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 240, in <module>
    distribution_dataset_construction(model_path, num_azimuth, num_elevation, radius, start_viewpoint_index, viewpoint_index_interval)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 164, in distribution_dataset_construction
    NeRF_pipeline.add_image(images=obs,poses=input_pose,model_option=None)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nvf/active_mapping/active_mapping.py", line 233, in add_image
    self.trainer.train()
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nvf/nerfstudio_interface/nbv_trainer.py", line 213, in train
    loss, loss_dict, metrics_dict = self.train_iteration(step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/utils/profiler.py", line 127, in inner
    out = func(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/engine/trainer.py", line 740, in train_iteration
    _, loss_dict, metrics_dict = self.pipeline.get_train_loss_dict(step=step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/pipelines/dynamic_batch.py", line 91, in get_train_loss_dict
    model_outputs, loss_dict, metrics_dict = super().get_train_loss_dict(step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/utils/profiler.py", line 127, in inner
    out = func(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/pipelines/base_pipeline.py", line 284, in get_train_loss_dict
    model_outputs = self._model(ray_bundle)  # train distributed data parallel model if world_size > 1
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/models/base_model.py", line 142, in forward
    return self.get_outputs(ray_bundle)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/models/instant_ngp.py", line 302, in get_outputs
    ray_samples, ray_indices = self.sampler(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/model_components/ray_samplers.py", line 482, in forward
    ray_indices, starts, ends = self.occupancy_grid.sampling(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/nerfacc/estimators/occ_grid.py", line 192, in sampling
    sigmas = sigma_fn(t_starts, t_ends, ray_indices)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/model_components/ray_samplers.py", line 428, in sigma_fn
    return density_fn(positions).squeeze(-1)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/fields/base_field.py", line 67, in density_fn
    density, _ = self.get_density(ray_samples)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/fields/nerfacto_field.py", line 252, in get_density
    h = self.mlp_base(positions_flat).view(*ray_samples.frustums.shape, -1)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/field_components/mlp.py", line 177, in forward
    return self.tcnn_encoding(in_tensor)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tinycudann/modules.py", line 190, in forward
    output = _module_function.apply(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/autograd/function.py", line 506, in apply
    return super().apply(*args, **kwargs)  # type: ignore[misc]
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tinycudann/modules.py", line 102, in forward
    native_ctx, output = native_tcnn_module.fwd(input, params)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 266.00 MiB (GPU 0; 23.68 GiB total capacity; 4.74 GiB already allocated; 101.75 MiB free; 5.04 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
Iteration 38 completed

Iteration 39/30
Processing Categories:   0%|          | 0/55 [00:00<?, ?category/s]
Processing Models in pillow:   0%|          | 0/96 [00:00<?, ?model/s][A/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tyro/_fields.py:1066: UserWarning: Mutable type <class 'config.EnvConfig'> is used as a default value for `env`. This is dangerous! Consider using `dataclasses.field(default_factory=...)` or marking <class 'config.EnvConfig'> as frozen.
  warnings.warn(
pillow:/attached/data/remote-home2/zzq/data/shapenet/ShapeNetCore.v2/03938244/530cc7dd793df95f8f5ae2c97614087a


CUDA
Generating data for init
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/boxx/ylcompat.py:69: BoxxWarning: warning from boxx
    os.environ["DISPLAY"] is not found
    plt.show() are redirect to plt.savefig(tmp)
    function: show, loga, crun, heatmap, plot will be affected
  def __setDisplayEnv():
saving data to data/shapenet/init/transforms.json
[17:53:34] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Found 64 GT images, loading directly from /remote-home/zzq/data/ShapeNet/gt_shapenet/pillow/530cc7dd793df95f8f5ae2c97614087a
Loaded 64 GT images successfully!


viewpoint:   0%|          | 0/64 [00:00<?, ?it/s][A[Adealing with 27
[17:53:41] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:70: FutureWarning: Importing `spectral_angle_mapper` from `torchmetrics.functional` was deprecated and will be removed in 2.0. Import `spectral_angle_mapper` from `torchmetrics.image` instead.
  _future_warning(


viewpoint:  44%|████▍     | 28/64 [11:48<15:11, 25.32s/it][A[ASelf.trainer.train duration: 576.3395 seconds
显存占用: 778.24 MB, 已预留显存: 1252.00 MB
dealing with 28
[18:05:30] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json
viewpoint:  44%|████▍     | 28/64 [13:32<17:24, 29.02s/it]

                                                                      [AProcessing Categories:   0%|          | 0/55 [14:24<?, ?category/s]
Traceback (most recent call last):
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 240, in <module>
    distribution_dataset_construction(model_path, num_azimuth, num_elevation, radius, start_viewpoint_index, viewpoint_index_interval)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 164, in distribution_dataset_construction
    NeRF_pipeline.add_image(images=obs,poses=input_pose,model_option=None)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nvf/active_mapping/active_mapping.py", line 233, in add_image
    self.trainer.train()
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nvf/nerfstudio_interface/nbv_trainer.py", line 213, in train
    loss, loss_dict, metrics_dict = self.train_iteration(step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/utils/profiler.py", line 127, in inner
    out = func(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/engine/trainer.py", line 740, in train_iteration
    _, loss_dict, metrics_dict = self.pipeline.get_train_loss_dict(step=step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/pipelines/dynamic_batch.py", line 91, in get_train_loss_dict
    model_outputs, loss_dict, metrics_dict = super().get_train_loss_dict(step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/utils/profiler.py", line 127, in inner
    out = func(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/pipelines/base_pipeline.py", line 284, in get_train_loss_dict
    model_outputs = self._model(ray_bundle)  # train distributed data parallel model if world_size > 1
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/models/base_model.py", line 142, in forward
    return self.get_outputs(ray_bundle)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/models/instant_ngp.py", line 302, in get_outputs
    ray_samples, ray_indices = self.sampler(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/model_components/ray_samplers.py", line 482, in forward
    ray_indices, starts, ends = self.occupancy_grid.sampling(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/nerfacc/estimators/occ_grid.py", line 192, in sampling
    sigmas = sigma_fn(t_starts, t_ends, ray_indices)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/model_components/ray_samplers.py", line 428, in sigma_fn
    return density_fn(positions).squeeze(-1)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/fields/base_field.py", line 67, in density_fn
    density, _ = self.get_density(ray_samples)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/fields/nerfacto_field.py", line 252, in get_density
    h = self.mlp_base(positions_flat).view(*ray_samples.frustums.shape, -1)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/field_components/mlp.py", line 177, in forward
    return self.tcnn_encoding(in_tensor)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tinycudann/modules.py", line 190, in forward
    output = _module_function.apply(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/autograd/function.py", line 506, in apply
    return super().apply(*args, **kwargs)  # type: ignore[misc]
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tinycudann/modules.py", line 102, in forward
    native_ctx, output = native_tcnn_module.fwd(input, params)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 346.00 MiB (GPU 0; 23.68 GiB total capacity; 4.91 GiB already allocated; 319.75 MiB free; 5.03 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
Iteration 39 completed

Iteration 40/30
Processing Categories:   0%|          | 0/55 [00:00<?, ?category/s]
Processing Models in pillow:   0%|          | 0/96 [00:00<?, ?model/s][A/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tyro/_fields.py:1066: UserWarning: Mutable type <class 'config.EnvConfig'> is used as a default value for `env`. This is dangerous! Consider using `dataclasses.field(default_factory=...)` or marking <class 'config.EnvConfig'> as frozen.
  warnings.warn(
pillow:/attached/data/remote-home2/zzq/data/shapenet/ShapeNetCore.v2/03938244/530cc7dd793df95f8f5ae2c97614087a


CUDA
Generating data for init
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/boxx/ylcompat.py:69: BoxxWarning: warning from boxx
    os.environ["DISPLAY"] is not found
    plt.show() are redirect to plt.savefig(tmp)
    function: show, loga, crun, heatmap, plot will be affected
  def __setDisplayEnv():
saving data to data/shapenet/init/transforms.json
[18:09:50] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Found 64 GT images, loading directly from /remote-home/zzq/data/ShapeNet/gt_shapenet/pillow/530cc7dd793df95f8f5ae2c97614087a
Loaded 64 GT images successfully!


viewpoint:   0%|          | 0/64 [00:00<?, ?it/s][A[Adealing with 28
[18:09:58] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:70: FutureWarning: Importing `spectral_angle_mapper` from `torchmetrics.functional` was deprecated and will be removed in 2.0. Import `spectral_angle_mapper` from `torchmetrics.image` instead.
  _future_warning(


viewpoint:  45%|████▌     | 29/64 [12:12<14:43, 25.26s/it][A[ASelf.trainer.train duration: 597.3013 seconds
显存占用: 778.76 MB, 已预留显存: 1232.00 MB
dealing with 29
[18:22:10] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  47%|████▋     | 30/64 [24:38<33:29, 59.12s/it][A[ASelf.trainer.train duration: 604.3388 seconds
显存占用: 1121.38 MB, 已预留显存: 1698.00 MB
dealing with 30
[18:34:37] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json
viewpoint:  47%|████▋     | 30/64 [26:01<29:29, 52.04s/it]

                                                                      [AProcessing Categories:   0%|          | 0/55 [26:49<?, ?category/s]
Traceback (most recent call last):
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 240, in <module>
    distribution_dataset_construction(model_path, num_azimuth, num_elevation, radius, start_viewpoint_index, viewpoint_index_interval)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 164, in distribution_dataset_construction
    NeRF_pipeline.add_image(images=obs,poses=input_pose,model_option=None)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nvf/active_mapping/active_mapping.py", line 233, in add_image
    self.trainer.train()
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nvf/nerfstudio_interface/nbv_trainer.py", line 213, in train
    loss, loss_dict, metrics_dict = self.train_iteration(step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/utils/profiler.py", line 127, in inner
    out = func(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/engine/trainer.py", line 740, in train_iteration
    _, loss_dict, metrics_dict = self.pipeline.get_train_loss_dict(step=step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/pipelines/dynamic_batch.py", line 91, in get_train_loss_dict
    model_outputs, loss_dict, metrics_dict = super().get_train_loss_dict(step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/utils/profiler.py", line 127, in inner
    out = func(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/pipelines/base_pipeline.py", line 284, in get_train_loss_dict
    model_outputs = self._model(ray_bundle)  # train distributed data parallel model if world_size > 1
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/models/base_model.py", line 142, in forward
    return self.get_outputs(ray_bundle)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/models/instant_ngp.py", line 302, in get_outputs
    ray_samples, ray_indices = self.sampler(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/model_components/ray_samplers.py", line 482, in forward
    ray_indices, starts, ends = self.occupancy_grid.sampling(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/nerfacc/estimators/occ_grid.py", line 192, in sampling
    sigmas = sigma_fn(t_starts, t_ends, ray_indices)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/model_components/ray_samplers.py", line 428, in sigma_fn
    return density_fn(positions).squeeze(-1)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/fields/base_field.py", line 67, in density_fn
    density, _ = self.get_density(ray_samples)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/fields/nerfacto_field.py", line 252, in get_density
    h = self.mlp_base(positions_flat).view(*ray_samples.frustums.shape, -1)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/field_components/mlp.py", line 177, in forward
    return self.tcnn_encoding(in_tensor)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tinycudann/modules.py", line 190, in forward
    output = _module_function.apply(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/autograd/function.py", line 506, in apply
    return super().apply(*args, **kwargs)  # type: ignore[misc]
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tinycudann/modules.py", line 102, in forward
    native_ctx, output = native_tcnn_module.fwd(input, params)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 338.00 MiB (GPU 0; 23.68 GiB total capacity; 5.16 GiB already allocated; 335.75 MiB free; 5.33 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
Iteration 40 completed

Iteration 41/30
Processing Categories:   0%|          | 0/55 [00:00<?, ?category/s]
Processing Models in pillow:   0%|          | 0/96 [00:00<?, ?model/s][A/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tyro/_fields.py:1066: UserWarning: Mutable type <class 'config.EnvConfig'> is used as a default value for `env`. This is dangerous! Consider using `dataclasses.field(default_factory=...)` or marking <class 'config.EnvConfig'> as frozen.
  warnings.warn(
pillow:/attached/data/remote-home2/zzq/data/shapenet/ShapeNetCore.v2/03938244/530cc7dd793df95f8f5ae2c97614087a


CUDA
Generating data for init
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/boxx/ylcompat.py:69: BoxxWarning: warning from boxx
    os.environ["DISPLAY"] is not found
    plt.show() are redirect to plt.savefig(tmp)
    function: show, loga, crun, heatmap, plot will be affected
  def __setDisplayEnv():
saving data to data/shapenet/init/transforms.json
[18:38:37] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Found 64 GT images, loading directly from /remote-home/zzq/data/ShapeNet/gt_shapenet/pillow/530cc7dd793df95f8f5ae2c97614087a
Loaded 64 GT images successfully!


viewpoint:   0%|          | 0/64 [00:00<?, ?it/s][A[Adealing with 30
[18:38:45] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:70: FutureWarning: Importing `spectral_angle_mapper` from `torchmetrics.functional` was deprecated and will be removed in 2.0. Import `spectral_angle_mapper` from `torchmetrics.image` instead.
  _future_warning(


viewpoint:  48%|████▊     | 31/64 [12:40<13:30, 24.55s/it][A[ASelf.trainer.train duration: 612.9191 seconds
显存占用: 779.90 MB, 已预留显存: 1278.00 MB
dealing with 31
[18:51:26] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  50%|█████     | 32/64 [25:00<29:53, 56.05s/it][A[ASelf.trainer.train duration: 598.6416 seconds
显存占用: 1120.23 MB, 已预留显存: 1612.00 MB
dealing with 32
[19:03:46] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  52%|█████▏    | 33/64 [37:03<49:21, 95.54s/it][A[ASelf.trainer.train duration: 584.3737 seconds
显存占用: 1460.13 MB, 已预留显存: 1950.00 MB
dealing with 33
[19:15:49] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  53%|█████▎    | 34/64 [49:31<1:13:13, 146.45s/it][A[ASelf.trainer.train duration: 611.6339 seconds
显存占用: 1803.34 MB, 已预留显存: 2306.00 MB
dealing with 34
[19:28:17] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json
viewpoint:  53%|█████▎    | 34/64 [51:16<45:14, 90.49s/it]   

                                                                      [AProcessing Categories:   0%|          | 0/55 [52:10<?, ?category/s]
Traceback (most recent call last):
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 240, in <module>
    distribution_dataset_construction(model_path, num_azimuth, num_elevation, radius, start_viewpoint_index, viewpoint_index_interval)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 164, in distribution_dataset_construction
    NeRF_pipeline.add_image(images=obs,poses=input_pose,model_option=None)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nvf/active_mapping/active_mapping.py", line 233, in add_image
    self.trainer.train()
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nvf/nerfstudio_interface/nbv_trainer.py", line 213, in train
    loss, loss_dict, metrics_dict = self.train_iteration(step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/utils/profiler.py", line 127, in inner
    out = func(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/engine/trainer.py", line 740, in train_iteration
    _, loss_dict, metrics_dict = self.pipeline.get_train_loss_dict(step=step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/pipelines/dynamic_batch.py", line 91, in get_train_loss_dict
    model_outputs, loss_dict, metrics_dict = super().get_train_loss_dict(step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/utils/profiler.py", line 127, in inner
    out = func(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/pipelines/base_pipeline.py", line 284, in get_train_loss_dict
    model_outputs = self._model(ray_bundle)  # train distributed data parallel model if world_size > 1
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/models/base_model.py", line 142, in forward
    return self.get_outputs(ray_bundle)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/models/instant_ngp.py", line 302, in get_outputs
    ray_samples, ray_indices = self.sampler(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/model_components/ray_samplers.py", line 482, in forward
    ray_indices, starts, ends = self.occupancy_grid.sampling(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/nerfacc/estimators/occ_grid.py", line 192, in sampling
    sigmas = sigma_fn(t_starts, t_ends, ray_indices)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/model_components/ray_samplers.py", line 428, in sigma_fn
    return density_fn(positions).squeeze(-1)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/fields/base_field.py", line 67, in density_fn
    density, _ = self.get_density(ray_samples)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/fields/nerfacto_field.py", line 252, in get_density
    h = self.mlp_base(positions_flat).view(*ray_samples.frustums.shape, -1)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/field_components/mlp.py", line 177, in forward
    return self.tcnn_encoding(in_tensor)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tinycudann/modules.py", line 190, in forward
    output = _module_function.apply(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/autograd/function.py", line 506, in apply
    return super().apply(*args, **kwargs)  # type: ignore[misc]
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tinycudann/modules.py", line 102, in forward
    native_ctx, output = native_tcnn_module.fwd(input, params)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 276.00 MiB (GPU 0; 23.68 GiB total capacity; 5.14 GiB already allocated; 243.75 MiB free; 5.31 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
Iteration 41 completed

Iteration 42/30
Processing Categories:   0%|          | 0/55 [00:00<?, ?category/s]
Processing Models in pillow:   0%|          | 0/96 [00:00<?, ?model/s][A/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tyro/_fields.py:1066: UserWarning: Mutable type <class 'config.EnvConfig'> is used as a default value for `env`. This is dangerous! Consider using `dataclasses.field(default_factory=...)` or marking <class 'config.EnvConfig'> as frozen.
  warnings.warn(
pillow:/attached/data/remote-home2/zzq/data/shapenet/ShapeNetCore.v2/03938244/530cc7dd793df95f8f5ae2c97614087a


CUDA
Generating data for init
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/boxx/ylcompat.py:69: BoxxWarning: warning from boxx
    os.environ["DISPLAY"] is not found
    plt.show() are redirect to plt.savefig(tmp)
    function: show, loga, crun, heatmap, plot will be affected
  def __setDisplayEnv():
saving data to data/shapenet/init/transforms.json
[19:32:39] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Found 64 GT images, loading directly from /remote-home/zzq/data/ShapeNet/gt_shapenet/pillow/530cc7dd793df95f8f5ae2c97614087a
Loaded 64 GT images successfully!


viewpoint:   0%|          | 0/64 [00:00<?, ?it/s][A[Adealing with 34
[19:32:48] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:70: FutureWarning: Importing `spectral_angle_mapper` from `torchmetrics.functional` was deprecated and will be removed in 2.0. Import `spectral_angle_mapper` from `torchmetrics.image` instead.
  _future_warning(


viewpoint:  55%|█████▍    | 35/64 [13:18<11:01, 22.82s/it][A[ASelf.trainer.train duration: 669.4386 seconds
显存占用: 780.64 MB, 已预留显存: 1434.00 MB
dealing with 35
[19:46:06] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  56%|█████▋    | 36/64 [25:28<23:35, 50.55s/it][A[ASelf.trainer.train duration: 600.6001 seconds
显存占用: 1118.53 MB, 已预留显存: 1612.00 MB
dealing with 36
[19:58:16] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  58%|█████▊    | 37/64 [36:44<37:39, 83.70s/it][A[ASelf.trainer.train duration: 540.6072 seconds
显存占用: 1460.09 MB, 已预留显存: 1850.00 MB
dealing with 37
[20:09:32] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json


viewpoint:  59%|█████▉    | 38/64 [48:31<55:19, 127.67s/it][A[ASelf.trainer.train duration: 577.9721 seconds
显存占用: 1801.75 MB, 已预留显存: 2250.00 MB
dealing with 38
[20:21:20] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json
viewpoint:  59%|█████▉    | 38/64 [50:06<34:17, 79.12s/it] 

                                                                      [AProcessing Categories:   0%|          | 0/55 [50:52<?, ?category/s]
Traceback (most recent call last):
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 240, in <module>
    distribution_dataset_construction(model_path, num_azimuth, num_elevation, radius, start_viewpoint_index, viewpoint_index_interval)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/fep_nbv/scripts/generate_distribution_dataset.py", line 164, in distribution_dataset_construction
    NeRF_pipeline.add_image(images=obs,poses=input_pose,model_option=None)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nvf/active_mapping/active_mapping.py", line 233, in add_image
    self.trainer.train()
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nvf/nerfstudio_interface/nbv_trainer.py", line 213, in train
    loss, loss_dict, metrics_dict = self.train_iteration(step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/utils/profiler.py", line 127, in inner
    out = func(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/engine/trainer.py", line 740, in train_iteration
    _, loss_dict, metrics_dict = self.pipeline.get_train_loss_dict(step=step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/pipelines/dynamic_batch.py", line 91, in get_train_loss_dict
    model_outputs, loss_dict, metrics_dict = super().get_train_loss_dict(step)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/utils/profiler.py", line 127, in inner
    out = func(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/pipelines/base_pipeline.py", line 284, in get_train_loss_dict
    model_outputs = self._model(ray_bundle)  # train distributed data parallel model if world_size > 1
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/models/base_model.py", line 142, in forward
    return self.get_outputs(ray_bundle)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/models/instant_ngp.py", line 302, in get_outputs
    ray_samples, ray_indices = self.sampler(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/model_components/ray_samplers.py", line 482, in forward
    ray_indices, starts, ends = self.occupancy_grid.sampling(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/nerfacc/estimators/occ_grid.py", line 192, in sampling
    sigmas = sigma_fn(t_starts, t_ends, ray_indices)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/model_components/ray_samplers.py", line 428, in sigma_fn
    return density_fn(positions).squeeze(-1)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/fields/base_field.py", line 67, in density_fn
    density, _ = self.get_density(ray_samples)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/fields/nerfacto_field.py", line 252, in get_density
    h = self.mlp_base(positions_flat).view(*ray_samples.frustums.shape, -1)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/attached/data/remote-home2/zzq/04-fep-nbv/nerfstudio/field_components/mlp.py", line 177, in forward
    return self.tcnn_encoding(in_tensor)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tinycudann/modules.py", line 190, in forward
    output = _module_function.apply(
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/torch/autograd/function.py", line 506, in apply
    return super().apply(*args, **kwargs)  # type: ignore[misc]
  File "/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tinycudann/modules.py", line 102, in forward
    native_ctx, output = native_tcnn_module.fwd(input, params)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 288.00 MiB (GPU 0; 23.68 GiB total capacity; 5.32 GiB already allocated; 241.75 MiB free; 5.67 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
Iteration 42 completed

Iteration 43/30
Processing Categories:   0%|          | 0/55 [00:00<?, ?category/s]
Processing Models in pillow:   0%|          | 0/96 [00:00<?, ?model/s][A/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/tyro/_fields.py:1066: UserWarning: Mutable type <class 'config.EnvConfig'> is used as a default value for `env`. This is dangerous! Consider using `dataclasses.field(default_factory=...)` or marking <class 'config.EnvConfig'> as frozen.
  warnings.warn(
pillow:/attached/data/remote-home2/zzq/data/shapenet/ShapeNetCore.v2/03938244/530cc7dd793df95f8f5ae2c97614087a


CUDA
Generating data for init
/remote-home/zzq/.conda/envs/nvf/lib/python3.10/site-packages/boxx/ylcompat.py:69: BoxxWarning: warning from boxx
    os.environ["DISPLAY"] is not found
    plt.show() are redirect to plt.savefig(tmp)
    function: show, loga, crun, heatmap, plot will be affected
  def __setDisplayEnv():
saving data to data/shapenet/init/transforms.json
[20:25:38] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Found 64 GT images, loading directly from /remote-home/zzq/data/ShapeNet/gt_shapenet/pillow/530cc7dd793df95f8f5ae2c97614087a
Loaded 64 GT images successfully!


viewpoint:   0%|          | 0/64 [00:00<?, ?it/s][A[Adealing with 38
[20:25:46] Saving checkpoints to: cfg/config/dataset/instant-ngp/latest_checkpoint/nerfstudio_models      trainer.py:142
╭─────────────────────────────────────────── Viewer ───────────────────────────────────────────╮
│        ╷                                                                                     │
│   HTTP │ https://viewer.nerf.studio/versions/23-05-15-1/?websocket_url=ws://localhost:7007   │
│        ╵                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────╯
[NOTE] Not running eval iterations since only viewer is enabled.
Use --vis {wandb, tensorboard, viewer+wandb, viewer+tensorboard} to run with eval.
No Nerfstudio checkpoint to load, so training from scratch.
Disabled tensorboard/wandb event writers
entropy use uniform sampler: False
Generating data for init
saving data to data/shapenet/init/transforms.json
